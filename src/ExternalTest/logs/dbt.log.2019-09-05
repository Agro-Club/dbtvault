2019-09-04 19:07:08,325 (MainThread): Tracking: tracking
2019-09-04 19:07:08,326 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4cc18a400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4cc18a9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4cc18a128>]}
2019-09-04 19:07:08,877 (MainThread): Set downloads directory='/tmp/dbt-downloads-_14w7419'
2019-09-04 19:07:08,885 (MainThread): Installing /home/alex/PycharmProjects/SnowflakeDemo/src/SnowflakeDV
2019-09-04 19:07:08,885 (MainThread):   Creating symlink to local dependency.
2019-09-04 19:07:08,886 (MainThread):   Installed from <local @ /home/alex/PycharmProjects/SnowflakeDemo/src/SnowflakeDV>

2019-09-04 19:07:08,886 (MainThread): Sending event: {'category': 'dbt', 'action': 'package', 'label': '96927ed5-3ec4-4e8f-b403-de301d2a5b8b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4cc438c50>]}
2019-09-04 19:07:09,357 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4cc1ecfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4cc18a898>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4cc18aa58>]}
2019-09-04 19:07:09,858 (MainThread): Flushing usage events
2019-09-04 19:07:13,133 (MainThread): Tracking: tracking
2019-09-04 19:07:13,133 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b926a0ac8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b926a0f98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b92639588>]}
2019-09-04 19:07:13,665 (MainThread): Parsing macros/core.sql
2019-09-04 19:07:13,669 (MainThread): Parsing macros/adapters/common.sql
2019-09-04 19:07:13,689 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-09-04 19:07:13,691 (MainThread): Parsing macros/schema_tests/unique.sql
2019-09-04 19:07:13,692 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-09-04 19:07:13,692 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-09-04 19:07:13,693 (MainThread): Parsing macros/materializations/helpers.sql
2019-09-04 19:07:13,697 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-09-04 19:07:13,700 (MainThread): Parsing macros/materializations/view/view.sql
2019-09-04 19:07:13,703 (MainThread): Parsing macros/materializations/table/table.sql
2019-09-04 19:07:13,706 (MainThread): Parsing macros/materializations/common/merge.sql
2019-09-04 19:07:13,710 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2019-09-04 19:07:13,720 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2019-09-04 19:07:13,727 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2019-09-04 19:07:13,728 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-09-04 19:07:13,736 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-09-04 19:07:13,741 (MainThread): Parsing macros/etc/is_incremental.sql
2019-09-04 19:07:13,742 (MainThread): Parsing macros/etc/get_relation_comment.sql
2019-09-04 19:07:13,743 (MainThread): Parsing macros/etc/datetime.sql
2019-09-04 19:07:13,748 (MainThread): Parsing macros/etc/get_custom_alias.sql
2019-09-04 19:07:13,749 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-09-04 19:07:13,750 (MainThread): Parsing macros/etc/query.sql
2019-09-04 19:07:13,751 (MainThread): Parsing macros/adapters.sql
2019-09-04 19:07:13,755 (MainThread): Parsing macros/catalog.sql
2019-09-04 19:07:13,757 (MainThread): Parsing macros/materializations/incremental.sql
2019-09-04 19:07:13,761 (MainThread): Parsing macros/materializations/merge.sql
2019-09-04 19:07:13,762 (MainThread): Parsing macros/materializations/view.sql
2019-09-04 19:07:13,762 (MainThread): Parsing macros/materializations/table.sql
2019-09-04 19:07:13,764 (MainThread): Parsing macros/sat_template.sql
2019-09-04 19:07:13,765 (MainThread): Parsing macros/hub_template.sql
2019-09-04 19:07:13,766 (MainThread): Parsing macros/link_template.sql
2019-09-04 19:07:13,767 (MainThread): Parsing macros/utility/md5_binary.sql
2019-09-04 19:07:13,768 (MainThread): Parsing macros/utility/cast.sql
2019-09-04 19:07:13,769 (MainThread): Parsing macros/utility/union.sql
2019-09-04 19:07:13,770 (MainThread): Parsing macros/utility/prefix.sql
2019-09-04 19:07:13,779 (MainThread): Parsing model.dbtTest.hub_customer
2019-09-04 19:07:13,779 (MainThread): Acquiring new snowflake connection "hub_customer".
2019-09-04 19:07:13,779 (MainThread): Opening a new connection, currently in state init
2019-09-04 19:07:13,985 (MainThread): /home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/snowflake/connector/ocsp_asn1crypto.py:83: ResourceWarning: unclosed file <_io.BufferedReader name='/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/botocore/vendored/requests/cacert.pem'>

2019-09-04 19:07:13,994 (MainThread): /home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/snowflake/connector/ocsp_asn1crypto.py:83: ResourceWarning: unclosed file <_io.BufferedReader name='/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/certifi/cacert.pem'>

2019-09-04 19:07:14,344 (MainThread): Parsing model.dbtTest.stg_orders_hashed
2019-09-04 19:07:14,345 (MainThread): Acquiring new snowflake connection "stg_orders_hashed".
2019-09-04 19:07:14,345 (MainThread): Re-using an available connection from the pool (formerly hub_customer).
2019-09-04 19:07:14,356 (MainThread): Parsing model.snow_vault.test_sat_hub_customer
2019-09-04 19:07:14,357 (MainThread): Acquiring new snowflake connection "test_sat_hub_customer".
2019-09-04 19:07:14,357 (MainThread): Re-using an available connection from the pool (formerly stg_orders_hashed).
2019-09-04 19:07:14,360 (MainThread): Parsing model.snow_vault.test_source
2019-09-04 19:07:14,360 (MainThread): Acquiring new snowflake connection "test_source".
2019-09-04 19:07:14,360 (MainThread): Re-using an available connection from the pool (formerly test_sat_hub_customer).
2019-09-04 19:07:14,364 (MainThread): Parsing model.snow_vault.test_link_customer_nation
2019-09-04 19:07:14,365 (MainThread): Acquiring new snowflake connection "test_link_customer_nation".
2019-09-04 19:07:14,365 (MainThread): Re-using an available connection from the pool (formerly test_source).
2019-09-04 19:07:14,368 (MainThread): Parsing model.snow_vault.test_stg
2019-09-04 19:07:14,368 (MainThread): Acquiring new snowflake connection "test_stg".
2019-09-04 19:07:14,368 (MainThread): Re-using an available connection from the pool (formerly test_link_customer_nation).
2019-09-04 19:07:14,371 (MainThread): Parsing model.snow_vault.test_hub_customer
2019-09-04 19:07:14,371 (MainThread): Acquiring new snowflake connection "test_hub_customer".
2019-09-04 19:07:14,371 (MainThread): Re-using an available connection from the pool (formerly test_stg).
2019-09-04 19:07:14,388 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 123 macros, 0 operations, 0 seed files, 0 sources
2019-09-04 19:07:14,388 (MainThread): 
2019-09-04 19:07:14,388 (MainThread): Acquiring new snowflake connection "master".
2019-09-04 19:07:14,388 (MainThread): Re-using an available connection from the pool (formerly test_hub_customer).
2019-09-04 19:07:14,395 (MainThread): Parsing macros/core.sql
2019-09-04 19:07:14,398 (MainThread): Parsing macros/adapters/common.sql
2019-09-04 19:07:14,415 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-09-04 19:07:14,416 (MainThread): Parsing macros/schema_tests/unique.sql
2019-09-04 19:07:14,417 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-09-04 19:07:14,417 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-09-04 19:07:14,418 (MainThread): Parsing macros/materializations/helpers.sql
2019-09-04 19:07:14,422 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-09-04 19:07:14,425 (MainThread): Parsing macros/materializations/view/view.sql
2019-09-04 19:07:14,428 (MainThread): Parsing macros/materializations/table/table.sql
2019-09-04 19:07:14,431 (MainThread): Parsing macros/materializations/common/merge.sql
2019-09-04 19:07:14,434 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2019-09-04 19:07:14,444 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2019-09-04 19:07:14,450 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2019-09-04 19:07:14,452 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-09-04 19:07:14,460 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-09-04 19:07:14,464 (MainThread): Parsing macros/etc/is_incremental.sql
2019-09-04 19:07:14,465 (MainThread): Parsing macros/etc/get_relation_comment.sql
2019-09-04 19:07:14,466 (MainThread): Parsing macros/etc/datetime.sql
2019-09-04 19:07:14,491 (MainThread): Parsing macros/etc/get_custom_alias.sql
2019-09-04 19:07:14,491 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-09-04 19:07:14,493 (MainThread): Parsing macros/etc/query.sql
2019-09-04 19:07:14,494 (MainThread): Parsing macros/adapters.sql
2019-09-04 19:07:14,498 (MainThread): Parsing macros/catalog.sql
2019-09-04 19:07:14,499 (MainThread): Parsing macros/materializations/incremental.sql
2019-09-04 19:07:14,503 (MainThread): Parsing macros/materializations/merge.sql
2019-09-04 19:07:14,504 (MainThread): Parsing macros/materializations/view.sql
2019-09-04 19:07:14,504 (MainThread): Parsing macros/materializations/table.sql
2019-09-04 19:07:14,554 (MainThread): Using snowflake connection "master".
2019-09-04 19:07:14,554 (MainThread): On master: select distinct schema_name
    from DV_PROTOTYPE_DB.information_schema.schemata
    where catalog_name ilike 'DV_PROTOTYPE_DB'
2019-09-04 19:07:15,138 (MainThread): SQL status: SUCCESS 8 in 0.58 seconds
2019-09-04 19:07:15,154 (MainThread): Creating schema "DV_PROTOTYPE_DB"."SRC_test_vlt".
2019-09-04 19:07:15,159 (MainThread): Using snowflake connection "master".
2019-09-04 19:07:15,159 (MainThread): On master: BEGIN
2019-09-04 19:07:15,274 (MainThread): SQL status: SUCCESS 1 in 0.11 seconds
2019-09-04 19:07:15,275 (MainThread): Using snowflake connection "master".
2019-09-04 19:07:15,275 (MainThread): On master: create schema if not exists DV_PROTOTYPE_DB.SRC_test_vlt
2019-09-04 19:07:15,415 (MainThread): SQL status: SUCCESS 1 in 0.14 seconds
2019-09-04 19:07:15,417 (MainThread): On master: COMMIT
2019-09-04 19:07:15,417 (MainThread): Using snowflake connection "master".
2019-09-04 19:07:15,417 (MainThread): On master: COMMIT
2019-09-04 19:07:15,574 (MainThread): SQL status: SUCCESS 1 in 0.16 seconds
2019-09-04 19:07:15,602 (MainThread): Using snowflake connection "master".
2019-09-04 19:07:15,602 (MainThread): On master: BEGIN
2019-09-04 19:07:15,730 (MainThread): SQL status: SUCCESS 1 in 0.13 seconds
2019-09-04 19:07:15,730 (MainThread): Using snowflake connection "master".
2019-09-04 19:07:15,730 (MainThread): On master: select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'externaltable'
           else table_type
      end as table_type
    from DV_PROTOTYPE_DB.information_schema.tables
    where table_schema ilike 'src_test_vlt'
      and table_catalog ilike 'dv_prototype_db'
2019-09-04 19:07:16,583 (MainThread): SQL status: SUCCESS 3 in 0.85 seconds
2019-09-04 19:07:16,595 (MainThread): Using snowflake connection "master".
2019-09-04 19:07:16,595 (MainThread): On master: select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'externaltable'
           else table_type
      end as table_type
    from DV_PROTOTYPE_DB.information_schema.tables
    where table_schema ilike 'src_vlt'
      and table_catalog ilike 'dv_prototype_db'
2019-09-04 19:07:17,254 (MainThread): SQL status: SUCCESS 29 in 0.66 seconds
2019-09-04 19:07:17,304 (MainThread): Using snowflake connection "master".
2019-09-04 19:07:17,304 (MainThread): On master: select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'externaltable'
           else table_type
      end as table_type
    from DV_PROTOTYPE_DB.information_schema.tables
    where table_schema ilike 'src_stg'
      and table_catalog ilike 'dv_prototype_db'
2019-09-04 19:07:17,929 (MainThread): SQL status: SUCCESS 6 in 0.62 seconds
2019-09-04 19:07:17,935 (MainThread): On master: ROLLBACK
2019-09-04 19:07:18,068 (MainThread): Using snowflake connection "master".
2019-09-04 19:07:18,069 (MainThread): On master: BEGIN
2019-09-04 19:07:18,191 (MainThread): SQL status: SUCCESS 1 in 0.12 seconds
2019-09-04 19:07:18,193 (MainThread): On master: COMMIT
2019-09-04 19:07:18,194 (MainThread): Using snowflake connection "master".
2019-09-04 19:07:18,194 (MainThread): On master: COMMIT
2019-09-04 19:07:18,332 (MainThread): SQL status: SUCCESS 1 in 0.14 seconds
2019-09-04 19:07:18,332 (MainThread): 19:07:18 | Concurrency: 1 threads (target='dev')
2019-09-04 19:07:18,332 (MainThread): 19:07:18 | 
2019-09-04 19:07:18,334 (Thread-1): 19:07:18 | 1 of 3 START table model SRC_STG.stg_orders_hashed................... [RUN]
2019-09-04 19:07:18,334 (Thread-1): Acquiring new snowflake connection "stg_orders_hashed".
2019-09-04 19:07:18,334 (Thread-1): Opening a new connection, currently in state init
2019-09-04 19:07:18,881 (Thread-1): Compiling model.dbtTest.stg_orders_hashed
2019-09-04 19:07:18,910 (Thread-1): Writing injected SQL for node "model.dbtTest.stg_orders_hashed"
2019-09-04 19:07:18,933 (Thread-1): Writing runtime SQL for node "model.dbtTest.stg_orders_hashed"
2019-09-04 19:07:18,936 (Thread-1): Using snowflake connection "stg_orders_hashed".
2019-09-04 19:07:18,936 (Thread-1): On stg_orders_hashed: BEGIN
2019-09-04 19:07:19,052 (Thread-1): SQL status: SUCCESS 1 in 0.12 seconds
2019-09-04 19:07:19,052 (Thread-1): Using snowflake connection "stg_orders_hashed".
2019-09-04 19:07:19,052 (Thread-1): On stg_orders_hashed: create or replace transient table DV_PROTOTYPE_DB.SRC_STG.stg_orders_hashed
  as (
    

select
CAST(MD5_BINARY(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR)))) AS BINARY(16)) AS ORDER_PK,
CAST(MD5_BINARY(UPPER(TRIM(CAST(PARTKEY AS VARCHAR)))) AS BINARY(16)) AS PART_PK,
CAST(MD5_BINARY(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR)))) AS BINARY(16)) AS SUPPLIER_PK,
CAST(MD5_BINARY(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR)))) AS BINARY(16)) AS LINEITEM_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS INVENTORY_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS INVENTORY_ALLOCATION_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(COMMITDATE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(DISCOUNT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(EXTENDEDPRICE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(LINESTATUS AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(LINE_COMMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(QUANTITY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(RECEIPTDATE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(RETURNFLAG AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SHIPDATE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SHIPINSTRUCT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SHIPMODE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(TAX AS VARCHAR))), '^^') )) AS BINARY(16)) AS LINEITEM_HASHDIFF,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS LINEITEM_ORDER_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CLERK AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDERDATE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDERPRIORITY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDERSTATUS AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDER_COMMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SHIPPRIORITY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(TOTALPRICE AS VARCHAR))), '^^') )) AS BINARY(16)) AS ORDER_HASHDIFF,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS ORDER_CUSTOMER_PK,
CAST(MD5_BINARY(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR)))) AS BINARY(16)) AS CUSTOMER_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_NATIONKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS LINK_CUSTOMER_NATION_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMER_ACCBAL AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_COMMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_MKTSEGMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_NAME AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_PHONE AS VARCHAR))), '^^') )) AS BINARY(16)) AS CUSTOMER_HASHDIFF,
CAST(MD5_BINARY(UPPER(TRIM(CAST(CUSTOMER_NATIONKEY AS VARCHAR)))) AS BINARY(16)) AS CUSTOMER_NATION_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMER_NATION_COMMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_NATION_NAME AS VARCHAR))), '^^') )) AS BINARY(16)) AS CUSTOMER_NATION_HASHDIFF,
CAST(MD5_BINARY(UPPER(TRIM(CAST(CUSTOMER_REGIONKEY AS VARCHAR)))) AS BINARY(16)) AS CUSTOMER_REGION_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMER_NATIONKEY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_REGIONKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS CUSTOMER_NATION_REGION_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMER_REGION_COMMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_REGION_NAME AS VARCHAR))), '^^') )) AS BINARY(16)) AS CUSTOMER_REGION_HASHDIFF,
 *, TO_DATE('1992-01-08') AS LOADDATE, TO_DATE('1992-01-08') AS EFFECTIVE_FROM, 'TPCH' AS SOURCE FROM DV_PROTOTYPE_DB.SRC_STG.V_SRC_STG_ORDERS
  );
2019-09-04 19:07:20,382 (Thread-1): SQL status: SUCCESS 1 in 1.33 seconds
2019-09-04 19:07:20,383 (Thread-1): On stg_orders_hashed: COMMIT
2019-09-04 19:07:20,383 (Thread-1): Using snowflake connection "stg_orders_hashed".
2019-09-04 19:07:20,383 (Thread-1): On stg_orders_hashed: COMMIT
2019-09-04 19:07:20,535 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2019-09-04 19:07:20,542 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22881948-51f9-43d7-9ec5-2ca2a9cefc59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bb2c60438>]}
2019-09-04 19:07:21,026 (Thread-1): 19:07:21 | 1 of 3 OK created table model SRC_STG.stg_orders_hashed.............. [SUCCESS 1 in 2.21s]
2019-09-04 19:07:21,026 (Thread-1): 19:07:21 | 2 of 3 START incremental model SRC_test_vlt.test_hub_customer........ [RUN]
2019-09-04 19:07:21,029 (Thread-1): Acquiring new snowflake connection "test_hub_customer".
2019-09-04 19:07:21,030 (Thread-1): Re-using an available connection from the pool (formerly stg_orders_hashed).
2019-09-04 19:07:21,031 (Thread-1): Compiling model.snow_vault.test_hub_customer
2019-09-04 19:07:21,041 (Thread-1): Writing injected SQL for node "model.snow_vault.test_hub_customer"
2019-09-04 19:07:21,069 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-04 19:07:21,069 (Thread-1): On test_hub_customer: BEGIN
2019-09-04 19:07:21,173 (Thread-1): SQL status: SUCCESS 1 in 0.10 seconds
2019-09-04 19:07:21,174 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-04 19:07:21,174 (Thread-1): On test_hub_customer: create or replace temporary table DV_PROTOTYPE_DB.SRC_test_vlt.test_hub_customer__dbt_tmp
  as (
    

SELECT
                CAST(CUSTOMER_PK AS BINARY(16)) AS CUSTOMER_PK,
                CAST(CUSTOMERKEY AS NUMBER(38,0)) AS CUSTOMERKEY,
                CAST(SOURCE AS VARCHAR(4)) AS SOURCE,
                CAST(LOADDATE AS DATE) AS LOADDATE

 FROM (
  SELECT DISTINCT CUSTOMER_PK, CUSTOMERKEY, SOURCE, LOADDATE
  FROM
    (SELECT DISTINCT a.CUSTOMER_PK, a.CUSTOMERKEY, a.SOURCE, a.LOADDATE
    FROM DV_PROTOTYPE_DB.SRC_TEST_STG.STG_CUSTOMER AS a
    LEFT JOIN DV_PROTOTYPE_DB.SRC_test_vlt.test_hub_customer AS c
    ON a.CUSTOMER_PK = c.CUSTOMER_PK
    AND c.CUSTOMER_PK IS NULL)
 AS b)
AS stg
WHERE stg.CUSTOMER_PK NOT IN (SELECT CUSTOMER_PK FROM DV_PROTOTYPE_DB.SRC_test_vlt.test_hub_customer)
  );
2019-09-04 19:07:21,681 (Thread-1): SQL status: SUCCESS 1 in 0.51 seconds
2019-09-04 19:07:21,685 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-04 19:07:21,685 (Thread-1): On test_hub_customer: select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from
      DV_PROTOTYPE_DB.information_schema.columns

      where table_name ilike 'test_hub_customer__dbt_tmp'
        
        and table_schema ilike 'SRC_test_vlt'
        
        
        and table_catalog ilike 'DV_PROTOTYPE_DB'
        
      order by ordinal_position
2019-09-04 19:07:22,372 (Thread-1): SQL status: SUCCESS 4 in 0.69 seconds
2019-09-04 19:07:22,384 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-04 19:07:22,384 (Thread-1): On test_hub_customer: select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from
      DV_PROTOTYPE_DB.information_schema.columns

      where table_name ilike 'test_hub_customer'
        
        and table_schema ilike 'SRC_test_vlt'
        
        
        and table_catalog ilike 'DV_PROTOTYPE_DB'
        
      order by ordinal_position
2019-09-04 19:07:23,707 (Thread-1): SQL status: SUCCESS 4 in 1.32 seconds
2019-09-04 19:07:23,709 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-04 19:07:23,709 (Thread-1): On test_hub_customer: select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from
      DV_PROTOTYPE_DB.information_schema.columns

      where table_name ilike 'test_hub_customer'
        
        and table_schema ilike 'SRC_test_vlt'
        
        
        and table_catalog ilike 'DV_PROTOTYPE_DB'
        
      order by ordinal_position
2019-09-04 19:07:25,275 (Thread-1): SQL status: SUCCESS 4 in 1.57 seconds
2019-09-04 19:07:25,285 (Thread-1): Writing runtime SQL for node "model.snow_vault.test_hub_customer"
2019-09-04 19:07:25,285 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-04 19:07:25,285 (Thread-1): On test_hub_customer: insert into DV_PROTOTYPE_DB.SRC_test_vlt.test_hub_customer (CUSTOMER_PK, CUSTOMERKEY, SOURCE, LOADDATE)
        (
            select CUSTOMER_PK, CUSTOMERKEY, SOURCE, LOADDATE
            from DV_PROTOTYPE_DB.SRC_test_vlt.test_hub_customer__dbt_tmp
        );
2019-09-04 19:07:25,530 (Thread-1): SQL status: SUCCESS 0 in 0.25 seconds
2019-09-04 19:07:25,531 (Thread-1): On test_hub_customer: COMMIT
2019-09-04 19:07:25,531 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-04 19:07:25,531 (Thread-1): On test_hub_customer: COMMIT
2019-09-04 19:07:25,656 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2019-09-04 19:07:25,659 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22881948-51f9-43d7-9ec5-2ca2a9cefc59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bb2b30ba8>]}
2019-09-04 19:07:26,514 (Thread-1): 19:07:26 | 2 of 3 OK created incremental model SRC_test_vlt.test_hub_customer... [SUCCESS 0 in 4.63s]
2019-09-04 19:07:26,515 (Thread-1): 19:07:26 | 3 of 3 START incremental model SRC_VLT.hub_customer.................. [RUN]
2019-09-04 19:07:26,515 (Thread-1): Acquiring new snowflake connection "hub_customer".
2019-09-04 19:07:26,515 (Thread-1): Re-using an available connection from the pool (formerly test_hub_customer).
2019-09-04 19:07:26,516 (Thread-1): Compiling model.dbtTest.hub_customer
2019-09-04 19:07:26,525 (Thread-1): Writing injected SQL for node "model.dbtTest.hub_customer"
2019-09-04 19:07:26,530 (Thread-1): Using snowflake connection "hub_customer".
2019-09-04 19:07:26,530 (Thread-1): On hub_customer: BEGIN
2019-09-04 19:07:26,640 (Thread-1): SQL status: SUCCESS 1 in 0.11 seconds
2019-09-04 19:07:26,641 (Thread-1): Using snowflake connection "hub_customer".
2019-09-04 19:07:26,641 (Thread-1): On hub_customer: create or replace temporary table DV_PROTOTYPE_DB.SRC_VLT.hub_customer__dbt_tmp
  as (
    SELECT 
                CAST(CUSTOMER_PK AS BINARY(16)) AS CUSTOMER_PK,
                CAST(CUSTOMERKEY AS NUMBER(38,0)) AS CUSTOMERKEY,
                CAST(SOURCE AS VARCHAR(4)) AS SOURCE,
                CAST(LOADDATE AS DATE) AS LOADDATE
 FROM (
  SELECT DISTINCT CUSTOMER_PK, CUSTOMERKEY, SOURCE, LOADDATE
  FROM
    (SELECT a.CUSTOMER_PK, a.CUSTOMERKEY, a.SOURCE, a.LOADDATE
    FROM DV_PROTOTYPE_DB.SRC_STG.stg_orders_hashed AS a
    LEFT JOIN DV_PROTOTYPE_DB.SRC_VLT.hub_customer AS c
    ON a.CUSTOMER_PK = c.CUSTOMER_PK
    AND c.CUSTOMER_PK IS NULL
    )
 AS b)
AS stg
WHERE stg.CUSTOMER_PK NOT IN (SELECT CUSTOMER_PK FROM DV_PROTOTYPE_DB.SRC_VLT.hub_customer)
  );
2019-09-04 19:07:27,353 (Thread-1): SQL status: SUCCESS 1 in 0.71 seconds
2019-09-04 19:07:27,357 (Thread-1): Using snowflake connection "hub_customer".
2019-09-04 19:07:27,357 (Thread-1): On hub_customer: select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from
      DV_PROTOTYPE_DB.information_schema.columns

      where table_name ilike 'hub_customer__dbt_tmp'
        
        and table_schema ilike 'SRC_VLT'
        
        
        and table_catalog ilike 'DV_PROTOTYPE_DB'
        
      order by ordinal_position
2019-09-04 19:07:28,019 (Thread-1): SQL status: SUCCESS 4 in 0.66 seconds
2019-09-04 19:07:28,023 (Thread-1): Using snowflake connection "hub_customer".
2019-09-04 19:07:28,023 (Thread-1): On hub_customer: select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from
      DV_PROTOTYPE_DB.information_schema.columns

      where table_name ilike 'hub_customer'
        
        and table_schema ilike 'SRC_VLT'
        
        
        and table_catalog ilike 'DV_PROTOTYPE_DB'
        
      order by ordinal_position
2019-09-04 19:07:28,824 (Thread-1): SQL status: SUCCESS 4 in 0.80 seconds
2019-09-04 19:07:28,828 (Thread-1): Using snowflake connection "hub_customer".
2019-09-04 19:07:28,828 (Thread-1): On hub_customer: select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from
      DV_PROTOTYPE_DB.information_schema.columns

      where table_name ilike 'hub_customer'
        
        and table_schema ilike 'SRC_VLT'
        
        
        and table_catalog ilike 'DV_PROTOTYPE_DB'
        
      order by ordinal_position
2019-09-04 19:07:29,810 (Thread-1): SQL status: SUCCESS 4 in 0.98 seconds
2019-09-04 19:07:29,814 (Thread-1): Writing runtime SQL for node "model.dbtTest.hub_customer"
2019-09-04 19:07:29,815 (Thread-1): Using snowflake connection "hub_customer".
2019-09-04 19:07:29,815 (Thread-1): On hub_customer: insert into DV_PROTOTYPE_DB.SRC_VLT.hub_customer (CUSTOMER_PK, CUSTOMERKEY, SOURCE, LOADDATE)
        (
            select CUSTOMER_PK, CUSTOMERKEY, SOURCE, LOADDATE
            from DV_PROTOTYPE_DB.SRC_VLT.hub_customer__dbt_tmp
        );
2019-09-04 19:07:30,047 (Thread-1): SQL status: SUCCESS 0 in 0.23 seconds
2019-09-04 19:07:30,048 (Thread-1): On hub_customer: COMMIT
2019-09-04 19:07:30,049 (Thread-1): Using snowflake connection "hub_customer".
2019-09-04 19:07:30,049 (Thread-1): On hub_customer: COMMIT
2019-09-04 19:07:30,183 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2019-09-04 19:07:30,189 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22881948-51f9-43d7-9ec5-2ca2a9cefc59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bb2ab98d0>]}
2019-09-04 19:07:30,680 (Thread-1): 19:07:30 | 3 of 3 OK created incremental model SRC_VLT.hub_customer............. [SUCCESS 0 in 3.67s]
2019-09-04 19:07:30,767 (MainThread): Using snowflake connection "master".
2019-09-04 19:07:30,767 (MainThread): On master: BEGIN
2019-09-04 19:07:30,939 (MainThread): SQL status: SUCCESS 1 in 0.17 seconds
2019-09-04 19:07:30,939 (MainThread): On master: COMMIT
2019-09-04 19:07:30,939 (MainThread): Using snowflake connection "master".
2019-09-04 19:07:30,939 (MainThread): On master: COMMIT
2019-09-04 19:07:31,075 (MainThread): SQL status: SUCCESS 1 in 0.14 seconds
2019-09-04 19:07:31,075 (MainThread): 19:07:31 | 
2019-09-04 19:07:31,076 (MainThread): 19:07:31 | Finished running 1 table models, 2 incremental models in 16.69s.
2019-09-04 19:07:31,076 (MainThread): Connection 'master' was left open.
2019-09-04 19:07:31,076 (MainThread): On master: Close
2019-09-04 19:07:31,196 (MainThread): Connection 'hub_customer' was left open.
2019-09-04 19:07:31,196 (MainThread): On hub_customer: Close
2019-09-04 19:07:31,392 (MainThread): 
2019-09-04 19:07:31,392 (MainThread): Completed successfully
2019-09-04 19:07:31,392 (MainThread): 
Done. PASS=3 ERROR=0 SKIP=0 TOTAL=3
2019-09-04 19:07:31,392 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bb2a3eeb8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bb2b39e48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bb2b39828>]}
2019-09-04 19:07:31,886 (MainThread): Flushing usage events
2019-09-04 20:01:57,044 (MainThread): Tracking: tracking
2019-09-04 20:01:57,044 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35f7b46b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35f7b46fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35f7adf5c0>]}
2019-09-04 20:01:57,594 (MainThread): Parsing macros/core.sql
2019-09-04 20:01:57,598 (MainThread): Parsing macros/adapters/common.sql
2019-09-04 20:01:57,619 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-09-04 20:01:57,620 (MainThread): Parsing macros/schema_tests/unique.sql
2019-09-04 20:01:57,620 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-09-04 20:01:57,621 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-09-04 20:01:57,622 (MainThread): Parsing macros/materializations/helpers.sql
2019-09-04 20:01:57,626 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-09-04 20:01:57,629 (MainThread): Parsing macros/materializations/view/view.sql
2019-09-04 20:01:57,632 (MainThread): Parsing macros/materializations/table/table.sql
2019-09-04 20:01:57,635 (MainThread): Parsing macros/materializations/common/merge.sql
2019-09-04 20:01:57,638 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2019-09-04 20:01:57,648 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2019-09-04 20:01:57,655 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2019-09-04 20:01:57,656 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-09-04 20:01:57,664 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-09-04 20:01:57,668 (MainThread): Parsing macros/etc/is_incremental.sql
2019-09-04 20:01:57,669 (MainThread): Parsing macros/etc/get_relation_comment.sql
2019-09-04 20:01:57,670 (MainThread): Parsing macros/etc/datetime.sql
2019-09-04 20:01:57,675 (MainThread): Parsing macros/etc/get_custom_alias.sql
2019-09-04 20:01:57,675 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-09-04 20:01:57,677 (MainThread): Parsing macros/etc/query.sql
2019-09-04 20:01:57,678 (MainThread): Parsing macros/adapters.sql
2019-09-04 20:01:57,682 (MainThread): Parsing macros/catalog.sql
2019-09-04 20:01:57,683 (MainThread): Parsing macros/materializations/incremental.sql
2019-09-04 20:01:57,687 (MainThread): Parsing macros/materializations/merge.sql
2019-09-04 20:01:57,688 (MainThread): Parsing macros/materializations/view.sql
2019-09-04 20:01:57,688 (MainThread): Parsing macros/materializations/table.sql
2019-09-04 20:01:57,691 (MainThread): Parsing macros/sat_template.sql
2019-09-04 20:01:57,692 (MainThread): Parsing macros/hub_template.sql
2019-09-04 20:01:57,694 (MainThread): Parsing macros/link_template.sql
2019-09-04 20:01:57,695 (MainThread): Parsing macros/utility/md5_binary.sql
2019-09-04 20:01:57,696 (MainThread): Parsing macros/utility/cast.sql
2019-09-04 20:01:57,697 (MainThread): Parsing macros/utility/union.sql
2019-09-04 20:01:57,698 (MainThread): Parsing macros/utility/prefix.sql
2019-09-04 20:01:57,706 (MainThread): Parsing model.dbtTest.hub_customer
2019-09-04 20:01:57,707 (MainThread): Acquiring new snowflake connection "hub_customer".
2019-09-04 20:01:57,707 (MainThread): Opening a new connection, currently in state init
2019-09-04 20:01:57,892 (MainThread): /home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/snowflake/connector/ocsp_asn1crypto.py:83: ResourceWarning: unclosed file <_io.BufferedReader name='/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/botocore/vendored/requests/cacert.pem'>

2019-09-04 20:01:57,900 (MainThread): /home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/snowflake/connector/ocsp_asn1crypto.py:83: ResourceWarning: unclosed file <_io.BufferedReader name='/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/certifi/cacert.pem'>

2019-09-04 20:01:58,294 (MainThread): Parsing model.dbtTest.stg_orders_hashed
2019-09-04 20:01:58,294 (MainThread): Acquiring new snowflake connection "stg_orders_hashed".
2019-09-04 20:01:58,294 (MainThread): Re-using an available connection from the pool (formerly hub_customer).
2019-09-04 20:01:58,305 (MainThread): Parsing model.snow_vault.test_sat_hub_customer
2019-09-04 20:01:58,306 (MainThread): Acquiring new snowflake connection "test_sat_hub_customer".
2019-09-04 20:01:58,306 (MainThread): Re-using an available connection from the pool (formerly stg_orders_hashed).
2019-09-04 20:01:58,309 (MainThread): Parsing model.snow_vault.test_source
2019-09-04 20:01:58,309 (MainThread): Acquiring new snowflake connection "test_source".
2019-09-04 20:01:58,309 (MainThread): Re-using an available connection from the pool (formerly test_sat_hub_customer).
2019-09-04 20:01:58,313 (MainThread): Parsing model.snow_vault.test_link_customer_nation
2019-09-04 20:01:58,314 (MainThread): Acquiring new snowflake connection "test_link_customer_nation".
2019-09-04 20:01:58,314 (MainThread): Re-using an available connection from the pool (formerly test_source).
2019-09-04 20:01:58,316 (MainThread): Parsing model.snow_vault.test_stg
2019-09-04 20:01:58,317 (MainThread): Acquiring new snowflake connection "test_stg".
2019-09-04 20:01:58,317 (MainThread): Re-using an available connection from the pool (formerly test_link_customer_nation).
2019-09-04 20:01:58,320 (MainThread): Parsing model.snow_vault.test_hub_customer
2019-09-04 20:01:58,320 (MainThread): Acquiring new snowflake connection "test_hub_customer".
2019-09-04 20:01:58,320 (MainThread): Re-using an available connection from the pool (formerly test_stg).
2019-09-04 20:01:58,337 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 123 macros, 0 operations, 0 seed files, 0 sources
2019-09-04 20:01:58,337 (MainThread): 
2019-09-04 20:01:58,338 (MainThread): Acquiring new snowflake connection "master".
2019-09-04 20:01:58,338 (MainThread): Re-using an available connection from the pool (formerly test_hub_customer).
2019-09-04 20:01:58,344 (MainThread): Parsing macros/core.sql
2019-09-04 20:01:58,347 (MainThread): Parsing macros/adapters/common.sql
2019-09-04 20:01:58,365 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-09-04 20:01:58,366 (MainThread): Parsing macros/schema_tests/unique.sql
2019-09-04 20:01:58,366 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-09-04 20:01:58,367 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-09-04 20:01:58,368 (MainThread): Parsing macros/materializations/helpers.sql
2019-09-04 20:01:58,372 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-09-04 20:01:58,375 (MainThread): Parsing macros/materializations/view/view.sql
2019-09-04 20:01:58,377 (MainThread): Parsing macros/materializations/table/table.sql
2019-09-04 20:01:58,380 (MainThread): Parsing macros/materializations/common/merge.sql
2019-09-04 20:01:58,384 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2019-09-04 20:01:58,395 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2019-09-04 20:01:58,401 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2019-09-04 20:01:58,402 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-09-04 20:01:58,410 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-09-04 20:01:58,414 (MainThread): Parsing macros/etc/is_incremental.sql
2019-09-04 20:01:58,415 (MainThread): Parsing macros/etc/get_relation_comment.sql
2019-09-04 20:01:58,416 (MainThread): Parsing macros/etc/datetime.sql
2019-09-04 20:01:58,440 (MainThread): Parsing macros/etc/get_custom_alias.sql
2019-09-04 20:01:58,441 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-09-04 20:01:58,442 (MainThread): Parsing macros/etc/query.sql
2019-09-04 20:01:58,443 (MainThread): Parsing macros/adapters.sql
2019-09-04 20:01:58,447 (MainThread): Parsing macros/catalog.sql
2019-09-04 20:01:58,448 (MainThread): Parsing macros/materializations/incremental.sql
2019-09-04 20:01:58,452 (MainThread): Parsing macros/materializations/merge.sql
2019-09-04 20:01:58,453 (MainThread): Parsing macros/materializations/view.sql
2019-09-04 20:01:58,453 (MainThread): Parsing macros/materializations/table.sql
2019-09-04 20:01:58,506 (MainThread): Using snowflake connection "master".
2019-09-04 20:01:58,506 (MainThread): On master: select distinct schema_name
    from DV_PROTOTYPE_DB.information_schema.schemata
    where catalog_name ilike 'DV_PROTOTYPE_DB'
2019-09-04 20:01:59,105 (MainThread): SQL status: SUCCESS 8 in 0.60 seconds
2019-09-04 20:01:59,109 (MainThread): Creating schema "DV_PROTOTYPE_DB"."SRC_test_vlt".
2019-09-04 20:01:59,110 (MainThread): Using snowflake connection "master".
2019-09-04 20:01:59,110 (MainThread): On master: BEGIN
2019-09-04 20:01:59,221 (MainThread): SQL status: SUCCESS 1 in 0.11 seconds
2019-09-04 20:01:59,221 (MainThread): Using snowflake connection "master".
2019-09-04 20:01:59,222 (MainThread): On master: create schema if not exists DV_PROTOTYPE_DB.SRC_test_vlt
2019-09-04 20:01:59,325 (MainThread): SQL status: SUCCESS 1 in 0.10 seconds
2019-09-04 20:01:59,326 (MainThread): On master: COMMIT
2019-09-04 20:01:59,326 (MainThread): Using snowflake connection "master".
2019-09-04 20:01:59,326 (MainThread): On master: COMMIT
2019-09-04 20:01:59,464 (MainThread): SQL status: SUCCESS 1 in 0.14 seconds
2019-09-04 20:01:59,474 (MainThread): Using snowflake connection "master".
2019-09-04 20:01:59,474 (MainThread): On master: BEGIN
2019-09-04 20:01:59,581 (MainThread): SQL status: SUCCESS 1 in 0.11 seconds
2019-09-04 20:01:59,581 (MainThread): Using snowflake connection "master".
2019-09-04 20:01:59,581 (MainThread): On master: select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'externaltable'
           else table_type
      end as table_type
    from DV_PROTOTYPE_DB.information_schema.tables
    where table_schema ilike 'src_test_vlt'
      and table_catalog ilike 'dv_prototype_db'
2019-09-04 20:02:00,242 (MainThread): SQL status: SUCCESS 3 in 0.66 seconds
2019-09-04 20:02:00,259 (MainThread): Using snowflake connection "master".
2019-09-04 20:02:00,259 (MainThread): On master: select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'externaltable'
           else table_type
      end as table_type
    from DV_PROTOTYPE_DB.information_schema.tables
    where table_schema ilike 'src_vlt'
      and table_catalog ilike 'dv_prototype_db'
2019-09-04 20:02:01,022 (MainThread): SQL status: SUCCESS 29 in 0.76 seconds
2019-09-04 20:02:01,074 (MainThread): Using snowflake connection "master".
2019-09-04 20:02:01,074 (MainThread): On master: select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'externaltable'
           else table_type
      end as table_type
    from DV_PROTOTYPE_DB.information_schema.tables
    where table_schema ilike 'src_stg'
      and table_catalog ilike 'dv_prototype_db'
2019-09-04 20:02:01,675 (MainThread): SQL status: SUCCESS 6 in 0.60 seconds
2019-09-04 20:02:01,687 (MainThread): On master: ROLLBACK
2019-09-04 20:02:01,891 (MainThread): Using snowflake connection "master".
2019-09-04 20:02:01,891 (MainThread): On master: BEGIN
2019-09-04 20:02:01,997 (MainThread): SQL status: SUCCESS 1 in 0.11 seconds
2019-09-04 20:02:01,998 (MainThread): On master: COMMIT
2019-09-04 20:02:01,999 (MainThread): Using snowflake connection "master".
2019-09-04 20:02:01,999 (MainThread): On master: COMMIT
2019-09-04 20:02:02,150 (MainThread): SQL status: SUCCESS 1 in 0.15 seconds
2019-09-04 20:02:02,151 (MainThread): 20:02:02 | Concurrency: 1 threads (target='dev')
2019-09-04 20:02:02,152 (MainThread): 20:02:02 | 
2019-09-04 20:02:02,155 (Thread-1): 20:02:02 | 1 of 3 START table model SRC_STG.stg_orders_hashed................... [RUN]
2019-09-04 20:02:02,156 (Thread-1): Acquiring new snowflake connection "stg_orders_hashed".
2019-09-04 20:02:02,156 (Thread-1): Opening a new connection, currently in state init
2019-09-04 20:02:02,513 (Thread-1): Compiling model.dbtTest.stg_orders_hashed
2019-09-04 20:02:02,550 (Thread-1): Writing injected SQL for node "model.dbtTest.stg_orders_hashed"
2019-09-04 20:02:02,570 (Thread-1): Writing runtime SQL for node "model.dbtTest.stg_orders_hashed"
2019-09-04 20:02:02,572 (Thread-1): Using snowflake connection "stg_orders_hashed".
2019-09-04 20:02:02,572 (Thread-1): On stg_orders_hashed: BEGIN
2019-09-04 20:02:02,685 (Thread-1): SQL status: SUCCESS 1 in 0.11 seconds
2019-09-04 20:02:02,686 (Thread-1): Using snowflake connection "stg_orders_hashed".
2019-09-04 20:02:02,687 (Thread-1): On stg_orders_hashed: create or replace transient table DV_PROTOTYPE_DB.SRC_STG.stg_orders_hashed
  as (
    

select
CAST(MD5_BINARY(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR)))) AS BINARY(16)) AS ORDER_PK,
CAST(MD5_BINARY(UPPER(TRIM(CAST(PARTKEY AS VARCHAR)))) AS BINARY(16)) AS PART_PK,
CAST(MD5_BINARY(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR)))) AS BINARY(16)) AS SUPPLIER_PK,
CAST(MD5_BINARY(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR)))) AS BINARY(16)) AS LINEITEM_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS INVENTORY_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS INVENTORY_ALLOCATION_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(COMMITDATE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(DISCOUNT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(EXTENDEDPRICE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(LINESTATUS AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(LINE_COMMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(QUANTITY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(RECEIPTDATE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(RETURNFLAG AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SHIPDATE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SHIPINSTRUCT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SHIPMODE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(TAX AS VARCHAR))), '^^') )) AS BINARY(16)) AS LINEITEM_HASHDIFF,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS LINEITEM_ORDER_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CLERK AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDERDATE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDERPRIORITY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDERSTATUS AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDER_COMMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SHIPPRIORITY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(TOTALPRICE AS VARCHAR))), '^^') )) AS BINARY(16)) AS ORDER_HASHDIFF,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS ORDER_CUSTOMER_PK,
CAST(MD5_BINARY(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR)))) AS BINARY(16)) AS CUSTOMER_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_NATIONKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS LINK_CUSTOMER_NATION_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMER_ACCBAL AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_COMMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_MKTSEGMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_NAME AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_PHONE AS VARCHAR))), '^^') )) AS BINARY(16)) AS CUSTOMER_HASHDIFF,
CAST(MD5_BINARY(UPPER(TRIM(CAST(CUSTOMER_NATIONKEY AS VARCHAR)))) AS BINARY(16)) AS CUSTOMER_NATION_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMER_NATION_COMMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_NATION_NAME AS VARCHAR))), '^^') )) AS BINARY(16)) AS CUSTOMER_NATION_HASHDIFF,
CAST(MD5_BINARY(UPPER(TRIM(CAST(CUSTOMER_REGIONKEY AS VARCHAR)))) AS BINARY(16)) AS CUSTOMER_REGION_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMER_NATIONKEY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_REGIONKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS CUSTOMER_NATION_REGION_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMER_REGION_COMMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_REGION_NAME AS VARCHAR))), '^^') )) AS BINARY(16)) AS CUSTOMER_REGION_HASHDIFF,
 *, TO_DATE('1992-01-08') AS LOADDATE, TO_DATE('1992-01-08') AS EFFECTIVE_FROM, 'TPCH' AS SOURCE FROM DV_PROTOTYPE_DB.SRC_STG.V_SRC_STG_ORDERS
  );
2019-09-04 20:02:03,903 (Thread-1): SQL status: SUCCESS 1 in 1.22 seconds
2019-09-04 20:02:03,905 (Thread-1): On stg_orders_hashed: COMMIT
2019-09-04 20:02:03,905 (Thread-1): Using snowflake connection "stg_orders_hashed".
2019-09-04 20:02:03,905 (Thread-1): On stg_orders_hashed: COMMIT
2019-09-04 20:02:04,015 (Thread-1): SQL status: SUCCESS 1 in 0.11 seconds
2019-09-04 20:02:04,018 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fc38482-3444-44cf-a50a-5c127ed71828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3617fd1cf8>]}
2019-09-04 20:02:04,525 (Thread-1): 20:02:04 | 1 of 3 OK created table model SRC_STG.stg_orders_hashed.............. [SUCCESS 1 in 1.86s]
2019-09-04 20:02:04,525 (Thread-1): 20:02:04 | 2 of 3 START incremental model SRC_test_vlt.test_hub_customer........ [RUN]
2019-09-04 20:02:04,529 (Thread-1): Acquiring new snowflake connection "test_hub_customer".
2019-09-04 20:02:04,530 (Thread-1): Re-using an available connection from the pool (formerly stg_orders_hashed).
2019-09-04 20:02:04,531 (Thread-1): Compiling model.snow_vault.test_hub_customer
2019-09-04 20:02:04,547 (Thread-1): Writing injected SQL for node "model.snow_vault.test_hub_customer"
2019-09-04 20:02:04,575 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-04 20:02:04,576 (Thread-1): On test_hub_customer: BEGIN
2019-09-04 20:02:04,719 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2019-09-04 20:02:04,720 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-04 20:02:04,720 (Thread-1): On test_hub_customer: create or replace temporary table DV_PROTOTYPE_DB.SRC_test_vlt.test_hub_customer__dbt_tmp
  as (
    

SELECT
                CAST(CUSTOMER_PK AS BINARY(16)) AS CUSTOMER_PK,
                CAST(CUSTOMERKEY AS NUMBER(38,0)) AS CUSTOMERKEY,
                CAST(SOURCE AS VARCHAR(4)) AS SOURCE,
                CAST(LOADDATE AS DATE) AS LOADDATE

 FROM (
  SELECT DISTINCT CUSTOMER_PK, CUSTOMERKEY, SOURCE, LOADDATE
  FROM
    (SELECT DISTINCT a.CUSTOMER_PK, a.CUSTOMERKEY, a.SOURCE, a.LOADDATE
    FROM DV_PROTOTYPE_DB.SRC_TEST_STG.STG_CUSTOMER AS a
    LEFT JOIN DV_PROTOTYPE_DB.SRC_test_vlt.test_hub_customer AS c
    ON a.CUSTOMER_PK = c.CUSTOMER_PK
    AND c.CUSTOMER_PK IS NULL)
 AS b)
AS stg
WHERE stg.CUSTOMER_PK NOT IN (SELECT CUSTOMER_PK FROM DV_PROTOTYPE_DB.SRC_test_vlt.test_hub_customer)
  );
2019-09-04 20:02:05,410 (Thread-1): SQL status: SUCCESS 1 in 0.69 seconds
2019-09-04 20:02:05,425 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-04 20:02:05,425 (Thread-1): On test_hub_customer: select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from
      DV_PROTOTYPE_DB.information_schema.columns

      where table_name ilike 'test_hub_customer__dbt_tmp'
        
        and table_schema ilike 'SRC_test_vlt'
        
        
        and table_catalog ilike 'DV_PROTOTYPE_DB'
        
      order by ordinal_position
2019-09-04 20:02:06,124 (Thread-1): SQL status: SUCCESS 4 in 0.70 seconds
2019-09-04 20:02:06,137 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-04 20:02:06,137 (Thread-1): On test_hub_customer: select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from
      DV_PROTOTYPE_DB.information_schema.columns

      where table_name ilike 'test_hub_customer'
        
        and table_schema ilike 'SRC_test_vlt'
        
        
        and table_catalog ilike 'DV_PROTOTYPE_DB'
        
      order by ordinal_position
2019-09-04 20:02:06,938 (Thread-1): SQL status: SUCCESS 4 in 0.80 seconds
2019-09-04 20:02:06,954 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-04 20:02:06,955 (Thread-1): On test_hub_customer: select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from
      DV_PROTOTYPE_DB.information_schema.columns

      where table_name ilike 'test_hub_customer'
        
        and table_schema ilike 'SRC_test_vlt'
        
        
        and table_catalog ilike 'DV_PROTOTYPE_DB'
        
      order by ordinal_position
2019-09-04 20:02:07,660 (Thread-1): SQL status: SUCCESS 4 in 0.70 seconds
2019-09-04 20:02:07,699 (Thread-1): Writing runtime SQL for node "model.snow_vault.test_hub_customer"
2019-09-04 20:02:07,700 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-04 20:02:07,700 (Thread-1): On test_hub_customer: insert into DV_PROTOTYPE_DB.SRC_test_vlt.test_hub_customer (CUSTOMER_PK, CUSTOMERKEY, LOADDATE, SOURCE)
        (
            select CUSTOMER_PK, CUSTOMERKEY, LOADDATE, SOURCE
            from DV_PROTOTYPE_DB.SRC_test_vlt.test_hub_customer__dbt_tmp
        );
2019-09-04 20:02:08,247 (Thread-1): SQL status: SUCCESS 2 in 0.55 seconds
2019-09-04 20:02:08,251 (Thread-1): On test_hub_customer: COMMIT
2019-09-04 20:02:08,252 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-04 20:02:08,252 (Thread-1): On test_hub_customer: COMMIT
2019-09-04 20:02:08,447 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2019-09-04 20:02:08,461 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fc38482-3444-44cf-a50a-5c127ed71828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3618021ba8>]}
2019-09-04 20:02:08,965 (Thread-1): 20:02:08 | 2 of 3 OK created incremental model SRC_test_vlt.test_hub_customer... [SUCCESS 2 in 3.93s]
2019-09-04 20:02:08,966 (Thread-1): 20:02:08 | 3 of 3 START incremental model SRC_VLT.hub_customer.................. [RUN]
2019-09-04 20:02:08,970 (Thread-1): Acquiring new snowflake connection "hub_customer".
2019-09-04 20:02:08,970 (Thread-1): Re-using an available connection from the pool (formerly test_hub_customer).
2019-09-04 20:02:08,971 (Thread-1): Compiling model.dbtTest.hub_customer
2019-09-04 20:02:08,996 (Thread-1): Writing injected SQL for node "model.dbtTest.hub_customer"
2019-09-04 20:02:09,003 (Thread-1): Using snowflake connection "hub_customer".
2019-09-04 20:02:09,003 (Thread-1): On hub_customer: BEGIN
2019-09-04 20:02:09,118 (Thread-1): SQL status: SUCCESS 1 in 0.12 seconds
2019-09-04 20:02:09,119 (Thread-1): Using snowflake connection "hub_customer".
2019-09-04 20:02:09,119 (Thread-1): On hub_customer: create or replace temporary table DV_PROTOTYPE_DB.SRC_VLT.hub_customer__dbt_tmp
  as (
    SELECT 
                CAST(CUSTOMER_PK AS BINARY(16)) AS CUSTOMER_PK,
                CAST(CUSTOMERKEY AS NUMBER(38,0)) AS CUSTOMERKEY,
                CAST(SOURCE AS VARCHAR(4)) AS SOURCE,
                CAST(LOADDATE AS DATE) AS LOADDATE
 FROM (
  SELECT DISTINCT CUSTOMER_PK, CUSTOMERKEY, SOURCE, LOADDATE
  FROM
    (SELECT a.CUSTOMER_PK, a.CUSTOMERKEY, a.SOURCE, a.LOADDATE,
           lag(src_ldts[loop.index0], 1) over(partition by K order by src_ldts[loop.index0]) as FIRST_SEEN
    FROM DV_PROTOTYPE_DB.SRC_STG.stg_orders_hashed AS a
    LEFT JOIN DV_PROTOTYPE_DB.SRC_VLT.hub_customer AS c
    ON a.CUSTOMER_PK = c.CUSTOMER_PK
    AND c.CUSTOMER_PK IS NULL
    )
 AS b)
AS stg
WHERE stg.CUSTOMER_PK NOT IN (SELECT CUSTOMER_PK FROM DV_PROTOTYPE_DB.SRC_VLT.hub_customer)
  );
2019-09-04 20:02:09,360 (Thread-1): Snowflake error: 000904 (42000): 018eaad6-0085-6345-0000-28a50002afc2: SQL compilation error: error line 12 at position 15
invalid identifier 'SRC_LDTS'
2019-09-04 20:02:09,361 (Thread-1): On hub_customer: ROLLBACK
2019-09-04 20:02:09,507 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fc38482-3444-44cf-a50a-5c127ed71828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36180dd358>]}
2019-09-04 20:02:10,041 (Thread-1): 20:02:10 | 3 of 3 ERROR creating incremental model SRC_VLT.hub_customer......... [ERROR in 0.53s]
2019-09-04 20:02:10,099 (MainThread): Using snowflake connection "master".
2019-09-04 20:02:10,099 (MainThread): On master: BEGIN
2019-09-04 20:02:10,212 (MainThread): SQL status: SUCCESS 1 in 0.11 seconds
2019-09-04 20:02:10,213 (MainThread): On master: COMMIT
2019-09-04 20:02:10,213 (MainThread): Using snowflake connection "master".
2019-09-04 20:02:10,214 (MainThread): On master: COMMIT
2019-09-04 20:02:10,366 (MainThread): SQL status: SUCCESS 1 in 0.15 seconds
2019-09-04 20:02:10,367 (MainThread): 20:02:10 | 
2019-09-04 20:02:10,367 (MainThread): 20:02:10 | Finished running 1 table models, 2 incremental models in 12.03s.
2019-09-04 20:02:10,368 (MainThread): Connection 'master' was left open.
2019-09-04 20:02:10,368 (MainThread): On master: Close
2019-09-04 20:02:10,530 (MainThread): Connection 'hub_customer' was left open.
2019-09-04 20:02:10,531 (MainThread): On hub_customer: Close
2019-09-04 20:02:10,699 (MainThread): 
2019-09-04 20:02:10,700 (MainThread): Completed with 1 errors:
2019-09-04 20:02:10,700 (MainThread): 
2019-09-04 20:02:10,700 (MainThread): Database Error in model hub_customer (models/hub_sat_link_load/hub_customer.sql)
2019-09-04 20:02:10,700 (MainThread):   000904 (42000): 018eaad6-0085-6345-0000-28a50002afc2: SQL compilation error: error line 12 at position 15
2019-09-04 20:02:10,700 (MainThread):   invalid identifier 'SRC_LDTS'
2019-09-04 20:02:10,700 (MainThread):   compiled SQL at target/compiled/dbtTest/hub_sat_link_load/hub_customer.sql
2019-09-04 20:02:10,701 (MainThread): 
Done. PASS=2 ERROR=1 SKIP=0 TOTAL=3
2019-09-04 20:02:10,701 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3617ff6588>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3617fd5710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36180cf6d8>]}
2019-09-04 20:02:11,195 (MainThread): Flushing usage events
2019-09-04 20:03:00,833 (MainThread): Tracking: tracking
2019-09-04 20:03:00,834 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fcad66b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fcad66fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fcad005c0>]}
2019-09-04 20:03:01,394 (MainThread): Parsing macros/core.sql
2019-09-04 20:03:01,398 (MainThread): Parsing macros/adapters/common.sql
2019-09-04 20:03:01,419 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-09-04 20:03:01,420 (MainThread): Parsing macros/schema_tests/unique.sql
2019-09-04 20:03:01,421 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-09-04 20:03:01,422 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-09-04 20:03:01,423 (MainThread): Parsing macros/materializations/helpers.sql
2019-09-04 20:03:01,426 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-09-04 20:03:01,429 (MainThread): Parsing macros/materializations/view/view.sql
2019-09-04 20:03:01,432 (MainThread): Parsing macros/materializations/table/table.sql
2019-09-04 20:03:01,435 (MainThread): Parsing macros/materializations/common/merge.sql
2019-09-04 20:03:01,439 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2019-09-04 20:03:01,449 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2019-09-04 20:03:01,456 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2019-09-04 20:03:01,457 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-09-04 20:03:01,465 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-09-04 20:03:01,469 (MainThread): Parsing macros/etc/is_incremental.sql
2019-09-04 20:03:01,470 (MainThread): Parsing macros/etc/get_relation_comment.sql
2019-09-04 20:03:01,472 (MainThread): Parsing macros/etc/datetime.sql
2019-09-04 20:03:01,476 (MainThread): Parsing macros/etc/get_custom_alias.sql
2019-09-04 20:03:01,477 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-09-04 20:03:01,478 (MainThread): Parsing macros/etc/query.sql
2019-09-04 20:03:01,479 (MainThread): Parsing macros/adapters.sql
2019-09-04 20:03:01,483 (MainThread): Parsing macros/catalog.sql
2019-09-04 20:03:01,484 (MainThread): Parsing macros/materializations/incremental.sql
2019-09-04 20:03:01,488 (MainThread): Parsing macros/materializations/merge.sql
2019-09-04 20:03:01,489 (MainThread): Parsing macros/materializations/view.sql
2019-09-04 20:03:01,490 (MainThread): Parsing macros/materializations/table.sql
2019-09-04 20:03:01,492 (MainThread): Parsing macros/sat_template.sql
2019-09-04 20:03:01,493 (MainThread): Parsing macros/hub_template.sql
2019-09-04 20:03:01,494 (MainThread): Parsing macros/link_template.sql
2019-09-04 20:03:01,494 (MainThread): Parsing macros/utility/md5_binary.sql
2019-09-04 20:03:01,495 (MainThread): Parsing macros/utility/cast.sql
2019-09-04 20:03:01,496 (MainThread): Parsing macros/utility/union.sql
2019-09-04 20:03:01,498 (MainThread): Parsing macros/utility/prefix.sql
2019-09-04 20:03:01,511 (MainThread): Parsing model.dbtTest.hub_customer
2019-09-04 20:03:01,511 (MainThread): Acquiring new snowflake connection "hub_customer".
2019-09-04 20:03:01,511 (MainThread): Opening a new connection, currently in state init
2019-09-04 20:03:01,795 (MainThread): /home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/snowflake/connector/ocsp_asn1crypto.py:83: ResourceWarning: unclosed file <_io.BufferedReader name='/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/botocore/vendored/requests/cacert.pem'>

2019-09-04 20:03:01,805 (MainThread): /home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/snowflake/connector/ocsp_asn1crypto.py:83: ResourceWarning: unclosed file <_io.BufferedReader name='/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/certifi/cacert.pem'>

2019-09-04 20:03:02,168 (MainThread): Parsing model.dbtTest.stg_orders_hashed
2019-09-04 20:03:02,169 (MainThread): Acquiring new snowflake connection "stg_orders_hashed".
2019-09-04 20:03:02,169 (MainThread): Re-using an available connection from the pool (formerly hub_customer).
2019-09-04 20:03:02,179 (MainThread): Parsing model.snow_vault.test_sat_hub_customer
2019-09-04 20:03:02,180 (MainThread): Acquiring new snowflake connection "test_sat_hub_customer".
2019-09-04 20:03:02,180 (MainThread): Re-using an available connection from the pool (formerly stg_orders_hashed).
2019-09-04 20:03:02,182 (MainThread): Parsing model.snow_vault.test_source
2019-09-04 20:03:02,183 (MainThread): Acquiring new snowflake connection "test_source".
2019-09-04 20:03:02,183 (MainThread): Re-using an available connection from the pool (formerly test_sat_hub_customer).
2019-09-04 20:03:02,187 (MainThread): Parsing model.snow_vault.test_link_customer_nation
2019-09-04 20:03:02,187 (MainThread): Acquiring new snowflake connection "test_link_customer_nation".
2019-09-04 20:03:02,187 (MainThread): Re-using an available connection from the pool (formerly test_source).
2019-09-04 20:03:02,190 (MainThread): Parsing model.snow_vault.test_stg
2019-09-04 20:03:02,191 (MainThread): Acquiring new snowflake connection "test_stg".
2019-09-04 20:03:02,191 (MainThread): Re-using an available connection from the pool (formerly test_link_customer_nation).
2019-09-04 20:03:02,193 (MainThread): Parsing model.snow_vault.test_hub_customer
2019-09-04 20:03:02,194 (MainThread): Acquiring new snowflake connection "test_hub_customer".
2019-09-04 20:03:02,194 (MainThread): Re-using an available connection from the pool (formerly test_stg).
2019-09-04 20:03:02,210 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 123 macros, 0 operations, 0 seed files, 0 sources
2019-09-04 20:03:02,211 (MainThread): 
2019-09-04 20:03:02,211 (MainThread): Acquiring new snowflake connection "master".
2019-09-04 20:03:02,211 (MainThread): Re-using an available connection from the pool (formerly test_hub_customer).
2019-09-04 20:03:02,217 (MainThread): Parsing macros/core.sql
2019-09-04 20:03:02,220 (MainThread): Parsing macros/adapters/common.sql
2019-09-04 20:03:02,237 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-09-04 20:03:02,238 (MainThread): Parsing macros/schema_tests/unique.sql
2019-09-04 20:03:02,238 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-09-04 20:03:02,239 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-09-04 20:03:02,240 (MainThread): Parsing macros/materializations/helpers.sql
2019-09-04 20:03:02,244 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-09-04 20:03:02,246 (MainThread): Parsing macros/materializations/view/view.sql
2019-09-04 20:03:02,249 (MainThread): Parsing macros/materializations/table/table.sql
2019-09-04 20:03:02,252 (MainThread): Parsing macros/materializations/common/merge.sql
2019-09-04 20:03:02,256 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2019-09-04 20:03:02,265 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2019-09-04 20:03:02,272 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2019-09-04 20:03:02,273 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-09-04 20:03:02,281 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-09-04 20:03:02,285 (MainThread): Parsing macros/etc/is_incremental.sql
2019-09-04 20:03:02,286 (MainThread): Parsing macros/etc/get_relation_comment.sql
2019-09-04 20:03:02,287 (MainThread): Parsing macros/etc/datetime.sql
2019-09-04 20:03:02,311 (MainThread): Parsing macros/etc/get_custom_alias.sql
2019-09-04 20:03:02,312 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-09-04 20:03:02,313 (MainThread): Parsing macros/etc/query.sql
2019-09-04 20:03:02,314 (MainThread): Parsing macros/adapters.sql
2019-09-04 20:03:02,318 (MainThread): Parsing macros/catalog.sql
2019-09-04 20:03:02,319 (MainThread): Parsing macros/materializations/incremental.sql
2019-09-04 20:03:02,323 (MainThread): Parsing macros/materializations/merge.sql
2019-09-04 20:03:02,324 (MainThread): Parsing macros/materializations/view.sql
2019-09-04 20:03:02,324 (MainThread): Parsing macros/materializations/table.sql
2019-09-04 20:03:02,374 (MainThread): Using snowflake connection "master".
2019-09-04 20:03:02,374 (MainThread): On master: select distinct schema_name
    from DV_PROTOTYPE_DB.information_schema.schemata
    where catalog_name ilike 'DV_PROTOTYPE_DB'
2019-09-04 20:03:02,947 (MainThread): SQL status: SUCCESS 8 in 0.57 seconds
2019-09-04 20:03:02,966 (MainThread): Creating schema "DV_PROTOTYPE_DB"."SRC_test_vlt".
2019-09-04 20:03:02,973 (MainThread): Using snowflake connection "master".
2019-09-04 20:03:02,974 (MainThread): On master: BEGIN
2019-09-04 20:03:03,069 (MainThread): SQL status: SUCCESS 1 in 0.09 seconds
2019-09-04 20:03:03,069 (MainThread): Using snowflake connection "master".
2019-09-04 20:03:03,069 (MainThread): On master: create schema if not exists DV_PROTOTYPE_DB.SRC_test_vlt
2019-09-04 20:03:03,283 (MainThread): SQL status: SUCCESS 1 in 0.21 seconds
2019-09-04 20:03:03,286 (MainThread): On master: COMMIT
2019-09-04 20:03:03,286 (MainThread): Using snowflake connection "master".
2019-09-04 20:03:03,286 (MainThread): On master: COMMIT
2019-09-04 20:03:03,421 (MainThread): SQL status: SUCCESS 1 in 0.13 seconds
2019-09-04 20:03:03,432 (MainThread): Using snowflake connection "master".
2019-09-04 20:03:03,432 (MainThread): On master: BEGIN
2019-09-04 20:03:03,545 (MainThread): SQL status: SUCCESS 1 in 0.11 seconds
2019-09-04 20:03:03,546 (MainThread): Using snowflake connection "master".
2019-09-04 20:03:03,547 (MainThread): On master: select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'externaltable'
           else table_type
      end as table_type
    from DV_PROTOTYPE_DB.information_schema.tables
    where table_schema ilike 'src_vlt'
      and table_catalog ilike 'dv_prototype_db'
2019-09-04 20:03:04,367 (MainThread): SQL status: SUCCESS 29 in 0.82 seconds
2019-09-04 20:03:04,417 (MainThread): Using snowflake connection "master".
2019-09-04 20:03:04,417 (MainThread): On master: select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'externaltable'
           else table_type
      end as table_type
    from DV_PROTOTYPE_DB.information_schema.tables
    where table_schema ilike 'src_stg'
      and table_catalog ilike 'dv_prototype_db'
2019-09-04 20:03:05,092 (MainThread): SQL status: SUCCESS 6 in 0.68 seconds
2019-09-04 20:03:05,099 (MainThread): Using snowflake connection "master".
2019-09-04 20:03:05,099 (MainThread): On master: select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'externaltable'
           else table_type
      end as table_type
    from DV_PROTOTYPE_DB.information_schema.tables
    where table_schema ilike 'src_test_vlt'
      and table_catalog ilike 'dv_prototype_db'
2019-09-04 20:03:05,748 (MainThread): SQL status: SUCCESS 3 in 0.65 seconds
2019-09-04 20:03:05,762 (MainThread): On master: ROLLBACK
2019-09-04 20:03:05,910 (MainThread): Using snowflake connection "master".
2019-09-04 20:03:05,911 (MainThread): On master: BEGIN
2019-09-04 20:03:06,017 (MainThread): SQL status: SUCCESS 1 in 0.11 seconds
2019-09-04 20:03:06,017 (MainThread): On master: COMMIT
2019-09-04 20:03:06,017 (MainThread): Using snowflake connection "master".
2019-09-04 20:03:06,017 (MainThread): On master: COMMIT
2019-09-04 20:03:06,172 (MainThread): SQL status: SUCCESS 1 in 0.15 seconds
2019-09-04 20:03:06,174 (MainThread): 20:03:06 | Concurrency: 1 threads (target='dev')
2019-09-04 20:03:06,174 (MainThread): 20:03:06 | 
2019-09-04 20:03:06,177 (Thread-1): 20:03:06 | 1 of 3 START table model SRC_STG.stg_orders_hashed................... [RUN]
2019-09-04 20:03:06,178 (Thread-1): Acquiring new snowflake connection "stg_orders_hashed".
2019-09-04 20:03:06,179 (Thread-1): Opening a new connection, currently in state init
2019-09-04 20:03:06,680 (Thread-1): Compiling model.dbtTest.stg_orders_hashed
2019-09-04 20:03:06,721 (Thread-1): Writing injected SQL for node "model.dbtTest.stg_orders_hashed"
2019-09-04 20:03:06,742 (Thread-1): Writing runtime SQL for node "model.dbtTest.stg_orders_hashed"
2019-09-04 20:03:06,744 (Thread-1): Using snowflake connection "stg_orders_hashed".
2019-09-04 20:03:06,744 (Thread-1): On stg_orders_hashed: BEGIN
2019-09-04 20:03:06,854 (Thread-1): SQL status: SUCCESS 1 in 0.11 seconds
2019-09-04 20:03:06,855 (Thread-1): Using snowflake connection "stg_orders_hashed".
2019-09-04 20:03:06,856 (Thread-1): On stg_orders_hashed: create or replace transient table DV_PROTOTYPE_DB.SRC_STG.stg_orders_hashed
  as (
    

select
CAST(MD5_BINARY(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR)))) AS BINARY(16)) AS ORDER_PK,
CAST(MD5_BINARY(UPPER(TRIM(CAST(PARTKEY AS VARCHAR)))) AS BINARY(16)) AS PART_PK,
CAST(MD5_BINARY(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR)))) AS BINARY(16)) AS SUPPLIER_PK,
CAST(MD5_BINARY(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR)))) AS BINARY(16)) AS LINEITEM_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS INVENTORY_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS INVENTORY_ALLOCATION_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(COMMITDATE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(DISCOUNT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(EXTENDEDPRICE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(LINESTATUS AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(LINE_COMMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(QUANTITY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(RECEIPTDATE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(RETURNFLAG AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SHIPDATE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SHIPINSTRUCT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SHIPMODE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(TAX AS VARCHAR))), '^^') )) AS BINARY(16)) AS LINEITEM_HASHDIFF,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS LINEITEM_ORDER_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CLERK AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDERDATE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDERPRIORITY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDERSTATUS AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDER_COMMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SHIPPRIORITY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(TOTALPRICE AS VARCHAR))), '^^') )) AS BINARY(16)) AS ORDER_HASHDIFF,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS ORDER_CUSTOMER_PK,
CAST(MD5_BINARY(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR)))) AS BINARY(16)) AS CUSTOMER_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_NATIONKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS LINK_CUSTOMER_NATION_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMER_ACCBAL AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_COMMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_MKTSEGMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_NAME AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_PHONE AS VARCHAR))), '^^') )) AS BINARY(16)) AS CUSTOMER_HASHDIFF,
CAST(MD5_BINARY(UPPER(TRIM(CAST(CUSTOMER_NATIONKEY AS VARCHAR)))) AS BINARY(16)) AS CUSTOMER_NATION_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMER_NATION_COMMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_NATION_NAME AS VARCHAR))), '^^') )) AS BINARY(16)) AS CUSTOMER_NATION_HASHDIFF,
CAST(MD5_BINARY(UPPER(TRIM(CAST(CUSTOMER_REGIONKEY AS VARCHAR)))) AS BINARY(16)) AS CUSTOMER_REGION_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMER_NATIONKEY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_REGIONKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS CUSTOMER_NATION_REGION_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMER_REGION_COMMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_REGION_NAME AS VARCHAR))), '^^') )) AS BINARY(16)) AS CUSTOMER_REGION_HASHDIFF,
 *, TO_DATE('1992-01-08') AS LOADDATE, TO_DATE('1992-01-08') AS EFFECTIVE_FROM, 'TPCH' AS SOURCE FROM DV_PROTOTYPE_DB.SRC_STG.V_SRC_STG_ORDERS
  );
2019-09-04 20:03:07,653 (Thread-1): SQL status: SUCCESS 1 in 0.80 seconds
2019-09-04 20:03:07,654 (Thread-1): On stg_orders_hashed: COMMIT
2019-09-04 20:03:07,654 (Thread-1): Using snowflake connection "stg_orders_hashed".
2019-09-04 20:03:07,654 (Thread-1): On stg_orders_hashed: COMMIT
2019-09-04 20:03:07,748 (Thread-1): SQL status: SUCCESS 1 in 0.09 seconds
2019-09-04 20:03:07,760 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6c82869-dcaa-4596-8607-9e3110787c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8feb31f3c8>]}
2019-09-04 20:03:08,267 (Thread-1): 20:03:08 | 1 of 3 OK created table model SRC_STG.stg_orders_hashed.............. [SUCCESS 1 in 1.58s]
2019-09-04 20:03:08,267 (Thread-1): 20:03:08 | 2 of 3 START incremental model SRC_test_vlt.test_hub_customer........ [RUN]
2019-09-04 20:03:08,268 (Thread-1): Acquiring new snowflake connection "test_hub_customer".
2019-09-04 20:03:08,268 (Thread-1): Re-using an available connection from the pool (formerly stg_orders_hashed).
2019-09-04 20:03:08,269 (Thread-1): Compiling model.snow_vault.test_hub_customer
2019-09-04 20:03:08,272 (Thread-1): Writing injected SQL for node "model.snow_vault.test_hub_customer"
2019-09-04 20:03:08,290 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-04 20:03:08,290 (Thread-1): On test_hub_customer: BEGIN
2019-09-04 20:03:08,395 (Thread-1): SQL status: SUCCESS 1 in 0.11 seconds
2019-09-04 20:03:08,396 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-04 20:03:08,396 (Thread-1): On test_hub_customer: create or replace temporary table DV_PROTOTYPE_DB.SRC_test_vlt.test_hub_customer__dbt_tmp
  as (
    

SELECT
                CAST(CUSTOMER_PK AS BINARY(16)) AS CUSTOMER_PK,
                CAST(CUSTOMERKEY AS NUMBER(38,0)) AS CUSTOMERKEY,
                CAST(SOURCE AS VARCHAR(4)) AS SOURCE,
                CAST(LOADDATE AS DATE) AS LOADDATE

 FROM (
  SELECT DISTINCT CUSTOMER_PK, CUSTOMERKEY, SOURCE, LOADDATE
  FROM
    (SELECT DISTINCT a.CUSTOMER_PK, a.CUSTOMERKEY, a.SOURCE, a.LOADDATE
    FROM DV_PROTOTYPE_DB.SRC_TEST_STG.STG_CUSTOMER AS a
    LEFT JOIN DV_PROTOTYPE_DB.SRC_test_vlt.test_hub_customer AS c
    ON a.CUSTOMER_PK = c.CUSTOMER_PK
    AND c.CUSTOMER_PK IS NULL)
 AS b)
AS stg
WHERE stg.CUSTOMER_PK NOT IN (SELECT CUSTOMER_PK FROM DV_PROTOTYPE_DB.SRC_test_vlt.test_hub_customer)
  );
2019-09-04 20:03:09,141 (Thread-1): SQL status: SUCCESS 1 in 0.74 seconds
2019-09-04 20:03:09,153 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-04 20:03:09,154 (Thread-1): On test_hub_customer: select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from
      DV_PROTOTYPE_DB.information_schema.columns

      where table_name ilike 'test_hub_customer__dbt_tmp'
        
        and table_schema ilike 'SRC_test_vlt'
        
        
        and table_catalog ilike 'DV_PROTOTYPE_DB'
        
      order by ordinal_position
2019-09-04 20:03:09,959 (Thread-1): SQL status: SUCCESS 4 in 0.81 seconds
2019-09-04 20:03:09,965 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-04 20:03:09,965 (Thread-1): On test_hub_customer: select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from
      DV_PROTOTYPE_DB.information_schema.columns

      where table_name ilike 'test_hub_customer'
        
        and table_schema ilike 'SRC_test_vlt'
        
        
        and table_catalog ilike 'DV_PROTOTYPE_DB'
        
      order by ordinal_position
2019-09-04 20:03:10,644 (Thread-1): SQL status: SUCCESS 4 in 0.68 seconds
2019-09-04 20:03:10,657 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-04 20:03:10,657 (Thread-1): On test_hub_customer: select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from
      DV_PROTOTYPE_DB.information_schema.columns

      where table_name ilike 'test_hub_customer'
        
        and table_schema ilike 'SRC_test_vlt'
        
        
        and table_catalog ilike 'DV_PROTOTYPE_DB'
        
      order by ordinal_position
2019-09-04 20:03:11,326 (Thread-1): SQL status: SUCCESS 4 in 0.67 seconds
2019-09-04 20:03:11,345 (Thread-1): Writing runtime SQL for node "model.snow_vault.test_hub_customer"
2019-09-04 20:03:11,345 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-04 20:03:11,346 (Thread-1): On test_hub_customer: insert into DV_PROTOTYPE_DB.SRC_test_vlt.test_hub_customer (CUSTOMER_PK, CUSTOMERKEY, LOADDATE, SOURCE)
        (
            select CUSTOMER_PK, CUSTOMERKEY, LOADDATE, SOURCE
            from DV_PROTOTYPE_DB.SRC_test_vlt.test_hub_customer__dbt_tmp
        );
2019-09-04 20:03:12,050 (Thread-1): SQL status: SUCCESS 6 in 0.70 seconds
2019-09-04 20:03:12,054 (Thread-1): On test_hub_customer: COMMIT
2019-09-04 20:03:12,054 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-04 20:03:12,054 (Thread-1): On test_hub_customer: COMMIT
2019-09-04 20:03:12,266 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2019-09-04 20:03:12,280 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6c82869-dcaa-4596-8607-9e3110787c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8feb333dd8>]}
2019-09-04 20:03:12,765 (Thread-1): 20:03:12 | 2 of 3 OK created incremental model SRC_test_vlt.test_hub_customer... [SUCCESS 6 in 4.01s]
2019-09-04 20:03:12,765 (Thread-1): 20:03:12 | 3 of 3 START incremental model SRC_VLT.hub_customer.................. [RUN]
2019-09-04 20:03:12,766 (Thread-1): Acquiring new snowflake connection "hub_customer".
2019-09-04 20:03:12,766 (Thread-1): Re-using an available connection from the pool (formerly test_hub_customer).
2019-09-04 20:03:12,767 (Thread-1): Compiling model.dbtTest.hub_customer
2019-09-04 20:03:12,803 (Thread-1): Writing injected SQL for node "model.dbtTest.hub_customer"
2019-09-04 20:03:12,811 (Thread-1): Using snowflake connection "hub_customer".
2019-09-04 20:03:12,811 (Thread-1): On hub_customer: BEGIN
2019-09-04 20:03:12,979 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2019-09-04 20:03:12,980 (Thread-1): Using snowflake connection "hub_customer".
2019-09-04 20:03:12,980 (Thread-1): On hub_customer: create or replace temporary table DV_PROTOTYPE_DB.SRC_VLT.hub_customer__dbt_tmp
  as (
    SELECT 
                CAST(CUSTOMER_PK AS BINARY(16)) AS CUSTOMER_PK,
                CAST(CUSTOMERKEY AS NUMBER(38,0)) AS CUSTOMERKEY,
                CAST(SOURCE AS VARCHAR(4)) AS SOURCE,
                CAST(LOADDATE AS DATE) AS LOADDATE
 FROM (
  SELECT DISTINCT CUSTOMER_PK, CUSTOMERKEY, SOURCE, LOADDATE
  FROM
    (SELECT a.CUSTOMER_PK, a.CUSTOMERKEY, a.SOURCE, a.LOADDATE,
           lag(src_ldts[loop.index0], 1) over(partition by CUSTOMER_PK order by src_ldts[loop.index0]) as FIRST_SEEN
    FROM DV_PROTOTYPE_DB.SRC_STG.stg_orders_hashed AS a
    LEFT JOIN DV_PROTOTYPE_DB.SRC_VLT.hub_customer AS c
    ON a.CUSTOMER_PK = c.CUSTOMER_PK
    AND c.CUSTOMER_PK IS NULL
    )
 AS b)
AS stg
WHERE stg.CUSTOMER_PK NOT IN (SELECT CUSTOMER_PK FROM DV_PROTOTYPE_DB.SRC_VLT.hub_customer)
  );
2019-09-04 20:03:13,838 (Thread-1): Snowflake error: 000904 (42000): 018eaad7-00ea-74a9-0000-28a50002dfba: SQL compilation error: error line 12 at position 15
invalid identifier 'SRC_LDTS'
2019-09-04 20:03:13,839 (Thread-1): On hub_customer: ROLLBACK
2019-09-04 20:03:14,437 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6c82869-dcaa-4596-8607-9e3110787c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8feb18f400>]}
2019-09-04 20:03:14,950 (Thread-1): 20:03:14 | 3 of 3 ERROR creating incremental model SRC_VLT.hub_customer......... [ERROR in 1.67s]
2019-09-04 20:03:15,016 (MainThread): Using snowflake connection "master".
2019-09-04 20:03:15,016 (MainThread): On master: BEGIN
2019-09-04 20:03:15,201 (MainThread): SQL status: SUCCESS 1 in 0.18 seconds
2019-09-04 20:03:15,202 (MainThread): On master: COMMIT
2019-09-04 20:03:15,202 (MainThread): Using snowflake connection "master".
2019-09-04 20:03:15,203 (MainThread): On master: COMMIT
2019-09-04 20:03:15,420 (MainThread): SQL status: SUCCESS 1 in 0.22 seconds
2019-09-04 20:03:15,422 (MainThread): 20:03:15 | 
2019-09-04 20:03:15,422 (MainThread): 20:03:15 | Finished running 1 table models, 2 incremental models in 13.21s.
2019-09-04 20:03:15,422 (MainThread): Connection 'master' was left open.
2019-09-04 20:03:15,423 (MainThread): On master: Close
2019-09-04 20:03:15,664 (MainThread): Connection 'hub_customer' was left open.
2019-09-04 20:03:15,665 (MainThread): On hub_customer: Close
2019-09-04 20:03:15,835 (MainThread): 
2019-09-04 20:03:15,835 (MainThread): Completed with 1 errors:
2019-09-04 20:03:15,836 (MainThread): 
2019-09-04 20:03:15,836 (MainThread): Database Error in model hub_customer (models/hub_sat_link_load/hub_customer.sql)
2019-09-04 20:03:15,836 (MainThread):   000904 (42000): 018eaad7-00ea-74a9-0000-28a50002dfba: SQL compilation error: error line 12 at position 15
2019-09-04 20:03:15,836 (MainThread):   invalid identifier 'SRC_LDTS'
2019-09-04 20:03:15,837 (MainThread):   compiled SQL at target/compiled/dbtTest/hub_sat_link_load/hub_customer.sql
2019-09-04 20:03:15,837 (MainThread): 
Done. PASS=2 ERROR=1 SKIP=0 TOTAL=3
2019-09-04 20:03:15,837 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8feb31fe80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8feb31fa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fcad005f8>]}
2019-09-04 20:03:16,386 (MainThread): Flushing usage events
2019-09-04 20:03:35,309 (MainThread): Tracking: tracking
2019-09-04 20:03:35,310 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1212e39b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1212e39fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1212dd35c0>]}
2019-09-04 20:03:35,895 (MainThread): Parsing macros/core.sql
2019-09-04 20:03:35,899 (MainThread): Parsing macros/adapters/common.sql
2019-09-04 20:03:35,920 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-09-04 20:03:35,921 (MainThread): Parsing macros/schema_tests/unique.sql
2019-09-04 20:03:35,922 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-09-04 20:03:35,923 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-09-04 20:03:35,924 (MainThread): Parsing macros/materializations/helpers.sql
2019-09-04 20:03:35,927 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-09-04 20:03:35,930 (MainThread): Parsing macros/materializations/view/view.sql
2019-09-04 20:03:35,933 (MainThread): Parsing macros/materializations/table/table.sql
2019-09-04 20:03:35,936 (MainThread): Parsing macros/materializations/common/merge.sql
2019-09-04 20:03:35,939 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2019-09-04 20:03:35,949 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2019-09-04 20:03:35,955 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2019-09-04 20:03:35,956 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-09-04 20:03:35,964 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-09-04 20:03:35,968 (MainThread): Parsing macros/etc/is_incremental.sql
2019-09-04 20:03:35,969 (MainThread): Parsing macros/etc/get_relation_comment.sql
2019-09-04 20:03:35,970 (MainThread): Parsing macros/etc/datetime.sql
2019-09-04 20:03:35,975 (MainThread): Parsing macros/etc/get_custom_alias.sql
2019-09-04 20:03:35,976 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-09-04 20:03:35,977 (MainThread): Parsing macros/etc/query.sql
2019-09-04 20:03:35,978 (MainThread): Parsing macros/adapters.sql
2019-09-04 20:03:35,982 (MainThread): Parsing macros/catalog.sql
2019-09-04 20:03:35,983 (MainThread): Parsing macros/materializations/incremental.sql
2019-09-04 20:03:35,987 (MainThread): Parsing macros/materializations/merge.sql
2019-09-04 20:03:35,988 (MainThread): Parsing macros/materializations/view.sql
2019-09-04 20:03:35,988 (MainThread): Parsing macros/materializations/table.sql
2019-09-04 20:03:35,990 (MainThread): Parsing macros/sat_template.sql
2019-09-04 20:03:35,991 (MainThread): Parsing macros/hub_template.sql
2019-09-04 20:03:35,992 (MainThread): Parsing macros/link_template.sql
2019-09-04 20:03:35,993 (MainThread): Parsing macros/utility/md5_binary.sql
2019-09-04 20:03:35,994 (MainThread): Parsing macros/utility/cast.sql
2019-09-04 20:03:35,995 (MainThread): Parsing macros/utility/union.sql
2019-09-04 20:03:35,996 (MainThread): Parsing macros/utility/prefix.sql
2019-09-04 20:03:36,004 (MainThread): Parsing model.dbtTest.hub_customer
2019-09-04 20:03:36,004 (MainThread): Acquiring new snowflake connection "hub_customer".
2019-09-04 20:03:36,005 (MainThread): Opening a new connection, currently in state init
2019-09-04 20:03:36,206 (MainThread): /home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/snowflake/connector/ocsp_asn1crypto.py:83: ResourceWarning: unclosed file <_io.BufferedReader name='/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/botocore/vendored/requests/cacert.pem'>

2019-09-04 20:03:36,214 (MainThread): /home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/snowflake/connector/ocsp_asn1crypto.py:83: ResourceWarning: unclosed file <_io.BufferedReader name='/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/certifi/cacert.pem'>

2019-09-04 20:03:36,868 (MainThread): Parsing model.dbtTest.stg_orders_hashed
2019-09-04 20:03:36,869 (MainThread): Acquiring new snowflake connection "stg_orders_hashed".
2019-09-04 20:03:36,869 (MainThread): Re-using an available connection from the pool (formerly hub_customer).
2019-09-04 20:03:36,880 (MainThread): Parsing model.snow_vault.test_sat_hub_customer
2019-09-04 20:03:36,880 (MainThread): Acquiring new snowflake connection "test_sat_hub_customer".
2019-09-04 20:03:36,880 (MainThread): Re-using an available connection from the pool (formerly stg_orders_hashed).
2019-09-04 20:03:36,883 (MainThread): Parsing model.snow_vault.test_source
2019-09-04 20:03:36,883 (MainThread): Acquiring new snowflake connection "test_source".
2019-09-04 20:03:36,883 (MainThread): Re-using an available connection from the pool (formerly test_sat_hub_customer).
2019-09-04 20:03:36,887 (MainThread): Parsing model.snow_vault.test_link_customer_nation
2019-09-04 20:03:36,888 (MainThread): Acquiring new snowflake connection "test_link_customer_nation".
2019-09-04 20:03:36,888 (MainThread): Re-using an available connection from the pool (formerly test_source).
2019-09-04 20:03:36,891 (MainThread): Parsing model.snow_vault.test_stg
2019-09-04 20:03:36,891 (MainThread): Acquiring new snowflake connection "test_stg".
2019-09-04 20:03:36,891 (MainThread): Re-using an available connection from the pool (formerly test_link_customer_nation).
2019-09-04 20:03:36,894 (MainThread): Parsing model.snow_vault.test_hub_customer
2019-09-04 20:03:36,895 (MainThread): Acquiring new snowflake connection "test_hub_customer".
2019-09-04 20:03:36,895 (MainThread): Re-using an available connection from the pool (formerly test_stg).
2019-09-04 20:03:36,911 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 123 macros, 0 operations, 0 seed files, 0 sources
2019-09-04 20:03:36,912 (MainThread): 
2019-09-04 20:03:36,912 (MainThread): Acquiring new snowflake connection "master".
2019-09-04 20:03:36,912 (MainThread): Re-using an available connection from the pool (formerly test_hub_customer).
2019-09-04 20:03:36,919 (MainThread): Parsing macros/core.sql
2019-09-04 20:03:36,921 (MainThread): Parsing macros/adapters/common.sql
2019-09-04 20:03:36,938 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-09-04 20:03:36,939 (MainThread): Parsing macros/schema_tests/unique.sql
2019-09-04 20:03:36,940 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-09-04 20:03:36,941 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-09-04 20:03:36,942 (MainThread): Parsing macros/materializations/helpers.sql
2019-09-04 20:03:36,945 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-09-04 20:03:36,948 (MainThread): Parsing macros/materializations/view/view.sql
2019-09-04 20:03:36,951 (MainThread): Parsing macros/materializations/table/table.sql
2019-09-04 20:03:36,954 (MainThread): Parsing macros/materializations/common/merge.sql
2019-09-04 20:03:36,957 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2019-09-04 20:03:36,967 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2019-09-04 20:03:36,973 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2019-09-04 20:03:36,975 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-09-04 20:03:36,983 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-09-04 20:03:36,987 (MainThread): Parsing macros/etc/is_incremental.sql
2019-09-04 20:03:36,988 (MainThread): Parsing macros/etc/get_relation_comment.sql
2019-09-04 20:03:36,989 (MainThread): Parsing macros/etc/datetime.sql
2019-09-04 20:03:37,012 (MainThread): Parsing macros/etc/get_custom_alias.sql
2019-09-04 20:03:37,013 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-09-04 20:03:37,014 (MainThread): Parsing macros/etc/query.sql
2019-09-04 20:03:37,015 (MainThread): Parsing macros/adapters.sql
2019-09-04 20:03:37,019 (MainThread): Parsing macros/catalog.sql
2019-09-04 20:03:37,021 (MainThread): Parsing macros/materializations/incremental.sql
2019-09-04 20:03:37,024 (MainThread): Parsing macros/materializations/merge.sql
2019-09-04 20:03:37,025 (MainThread): Parsing macros/materializations/view.sql
2019-09-04 20:03:37,026 (MainThread): Parsing macros/materializations/table.sql
2019-09-04 20:03:37,076 (MainThread): Using snowflake connection "master".
2019-09-04 20:03:37,076 (MainThread): On master: select distinct schema_name
    from DV_PROTOTYPE_DB.information_schema.schemata
    where catalog_name ilike 'DV_PROTOTYPE_DB'
2019-09-04 20:03:37,899 (MainThread): SQL status: SUCCESS 8 in 0.82 seconds
2019-09-04 20:03:37,920 (MainThread): Creating schema "DV_PROTOTYPE_DB"."SRC_test_vlt".
2019-09-04 20:03:37,927 (MainThread): Using snowflake connection "master".
2019-09-04 20:03:37,927 (MainThread): On master: BEGIN
2019-09-04 20:03:38,314 (MainThread): SQL status: SUCCESS 1 in 0.39 seconds
2019-09-04 20:03:38,315 (MainThread): Using snowflake connection "master".
2019-09-04 20:03:38,316 (MainThread): On master: create schema if not exists DV_PROTOTYPE_DB.SRC_test_vlt
2019-09-04 20:03:38,426 (MainThread): SQL status: SUCCESS 1 in 0.11 seconds
2019-09-04 20:03:38,427 (MainThread): On master: COMMIT
2019-09-04 20:03:38,427 (MainThread): Using snowflake connection "master".
2019-09-04 20:03:38,427 (MainThread): On master: COMMIT
2019-09-04 20:03:38,565 (MainThread): SQL status: SUCCESS 1 in 0.14 seconds
2019-09-04 20:03:38,609 (MainThread): Using snowflake connection "master".
2019-09-04 20:03:38,609 (MainThread): On master: BEGIN
2019-09-04 20:03:38,747 (MainThread): SQL status: SUCCESS 1 in 0.14 seconds
2019-09-04 20:03:38,748 (MainThread): Using snowflake connection "master".
2019-09-04 20:03:38,748 (MainThread): On master: select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'externaltable'
           else table_type
      end as table_type
    from DV_PROTOTYPE_DB.information_schema.tables
    where table_schema ilike 'src_vlt'
      and table_catalog ilike 'dv_prototype_db'
2019-09-04 20:03:39,585 (MainThread): SQL status: SUCCESS 29 in 0.84 seconds
2019-09-04 20:03:39,616 (MainThread): Using snowflake connection "master".
2019-09-04 20:03:39,616 (MainThread): On master: select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'externaltable'
           else table_type
      end as table_type
    from DV_PROTOTYPE_DB.information_schema.tables
    where table_schema ilike 'src_test_vlt'
      and table_catalog ilike 'dv_prototype_db'
2019-09-04 20:03:40,385 (MainThread): SQL status: SUCCESS 3 in 0.77 seconds
2019-09-04 20:03:40,402 (MainThread): Using snowflake connection "master".
2019-09-04 20:03:40,402 (MainThread): On master: select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'externaltable'
           else table_type
      end as table_type
    from DV_PROTOTYPE_DB.information_schema.tables
    where table_schema ilike 'src_stg'
      and table_catalog ilike 'dv_prototype_db'
2019-09-04 20:03:41,378 (MainThread): SQL status: SUCCESS 6 in 0.98 seconds
2019-09-04 20:03:41,400 (MainThread): On master: ROLLBACK
2019-09-04 20:03:41,562 (MainThread): Using snowflake connection "master".
2019-09-04 20:03:41,563 (MainThread): On master: BEGIN
2019-09-04 20:03:41,696 (MainThread): SQL status: SUCCESS 1 in 0.13 seconds
2019-09-04 20:03:41,697 (MainThread): On master: COMMIT
2019-09-04 20:03:41,697 (MainThread): Using snowflake connection "master".
2019-09-04 20:03:41,697 (MainThread): On master: COMMIT
2019-09-04 20:03:41,853 (MainThread): SQL status: SUCCESS 1 in 0.16 seconds
2019-09-04 20:03:41,855 (MainThread): 20:03:41 | Concurrency: 1 threads (target='dev')
2019-09-04 20:03:41,855 (MainThread): 20:03:41 | 
2019-09-04 20:03:41,859 (Thread-1): 20:03:41 | 1 of 3 START table model SRC_STG.stg_orders_hashed................... [RUN]
2019-09-04 20:03:41,860 (Thread-1): Acquiring new snowflake connection "stg_orders_hashed".
2019-09-04 20:03:41,860 (Thread-1): Opening a new connection, currently in state init
2019-09-04 20:03:42,373 (Thread-1): Compiling model.dbtTest.stg_orders_hashed
2019-09-04 20:03:42,413 (Thread-1): Writing injected SQL for node "model.dbtTest.stg_orders_hashed"
2019-09-04 20:03:42,435 (Thread-1): Writing runtime SQL for node "model.dbtTest.stg_orders_hashed"
2019-09-04 20:03:42,437 (Thread-1): Using snowflake connection "stg_orders_hashed".
2019-09-04 20:03:42,438 (Thread-1): On stg_orders_hashed: BEGIN
2019-09-04 20:03:42,541 (Thread-1): SQL status: SUCCESS 1 in 0.10 seconds
2019-09-04 20:03:42,542 (Thread-1): Using snowflake connection "stg_orders_hashed".
2019-09-04 20:03:42,542 (Thread-1): On stg_orders_hashed: create or replace transient table DV_PROTOTYPE_DB.SRC_STG.stg_orders_hashed
  as (
    

select
CAST(MD5_BINARY(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR)))) AS BINARY(16)) AS ORDER_PK,
CAST(MD5_BINARY(UPPER(TRIM(CAST(PARTKEY AS VARCHAR)))) AS BINARY(16)) AS PART_PK,
CAST(MD5_BINARY(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR)))) AS BINARY(16)) AS SUPPLIER_PK,
CAST(MD5_BINARY(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR)))) AS BINARY(16)) AS LINEITEM_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS INVENTORY_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS INVENTORY_ALLOCATION_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(COMMITDATE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(DISCOUNT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(EXTENDEDPRICE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(LINESTATUS AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(LINE_COMMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(QUANTITY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(RECEIPTDATE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(RETURNFLAG AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SHIPDATE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SHIPINSTRUCT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SHIPMODE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(TAX AS VARCHAR))), '^^') )) AS BINARY(16)) AS LINEITEM_HASHDIFF,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS LINEITEM_ORDER_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CLERK AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDERDATE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDERPRIORITY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDERSTATUS AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDER_COMMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SHIPPRIORITY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(TOTALPRICE AS VARCHAR))), '^^') )) AS BINARY(16)) AS ORDER_HASHDIFF,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS ORDER_CUSTOMER_PK,
CAST(MD5_BINARY(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR)))) AS BINARY(16)) AS CUSTOMER_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_NATIONKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS LINK_CUSTOMER_NATION_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMER_ACCBAL AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_COMMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_MKTSEGMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_NAME AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_PHONE AS VARCHAR))), '^^') )) AS BINARY(16)) AS CUSTOMER_HASHDIFF,
CAST(MD5_BINARY(UPPER(TRIM(CAST(CUSTOMER_NATIONKEY AS VARCHAR)))) AS BINARY(16)) AS CUSTOMER_NATION_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMER_NATION_COMMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_NATION_NAME AS VARCHAR))), '^^') )) AS BINARY(16)) AS CUSTOMER_NATION_HASHDIFF,
CAST(MD5_BINARY(UPPER(TRIM(CAST(CUSTOMER_REGIONKEY AS VARCHAR)))) AS BINARY(16)) AS CUSTOMER_REGION_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMER_NATIONKEY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_REGIONKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS CUSTOMER_NATION_REGION_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMER_REGION_COMMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_REGION_NAME AS VARCHAR))), '^^') )) AS BINARY(16)) AS CUSTOMER_REGION_HASHDIFF,
 *, TO_DATE('1992-01-08') AS LOADDATE, TO_DATE('1992-01-08') AS EFFECTIVE_FROM, 'TPCH' AS SOURCE FROM DV_PROTOTYPE_DB.SRC_STG.V_SRC_STG_ORDERS
  );
2019-09-04 20:03:43,494 (Thread-1): SQL status: SUCCESS 1 in 0.95 seconds
2019-09-04 20:03:43,498 (Thread-1): On stg_orders_hashed: COMMIT
2019-09-04 20:03:43,498 (Thread-1): Using snowflake connection "stg_orders_hashed".
2019-09-04 20:03:43,498 (Thread-1): On stg_orders_hashed: COMMIT
2019-09-04 20:03:43,585 (Thread-1): SQL status: SUCCESS 1 in 0.09 seconds
2019-09-04 20:03:43,587 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55dd8498-8486-4db2-8f2f-c416446ac65d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f123340e470>]}
2019-09-04 20:03:44,077 (Thread-1): 20:03:44 | 1 of 3 OK created table model SRC_STG.stg_orders_hashed.............. [SUCCESS 1 in 1.73s]
2019-09-04 20:03:44,078 (Thread-1): 20:03:44 | 2 of 3 START incremental model SRC_test_vlt.test_hub_customer........ [RUN]
2019-09-04 20:03:44,078 (Thread-1): Acquiring new snowflake connection "test_hub_customer".
2019-09-04 20:03:44,078 (Thread-1): Re-using an available connection from the pool (formerly stg_orders_hashed).
2019-09-04 20:03:44,080 (Thread-1): Compiling model.snow_vault.test_hub_customer
2019-09-04 20:03:44,100 (Thread-1): Writing injected SQL for node "model.snow_vault.test_hub_customer"
2019-09-04 20:03:44,137 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-04 20:03:44,137 (Thread-1): On test_hub_customer: BEGIN
2019-09-04 20:03:44,256 (Thread-1): SQL status: SUCCESS 1 in 0.12 seconds
2019-09-04 20:03:44,256 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-04 20:03:44,256 (Thread-1): On test_hub_customer: create or replace temporary table DV_PROTOTYPE_DB.SRC_test_vlt.test_hub_customer__dbt_tmp
  as (
    

SELECT
                CAST(CUSTOMER_PK AS BINARY(16)) AS CUSTOMER_PK,
                CAST(CUSTOMERKEY AS NUMBER(38,0)) AS CUSTOMERKEY,
                CAST(SOURCE AS VARCHAR(4)) AS SOURCE,
                CAST(LOADDATE AS DATE) AS LOADDATE

 FROM (
  SELECT DISTINCT CUSTOMER_PK, CUSTOMERKEY, SOURCE, LOADDATE
  FROM
    (SELECT DISTINCT a.CUSTOMER_PK, a.CUSTOMERKEY, a.SOURCE, a.LOADDATE
    FROM DV_PROTOTYPE_DB.SRC_TEST_STG.STG_CUSTOMER AS a
    LEFT JOIN DV_PROTOTYPE_DB.SRC_test_vlt.test_hub_customer AS c
    ON a.CUSTOMER_PK = c.CUSTOMER_PK
    AND c.CUSTOMER_PK IS NULL)
 AS b)
AS stg
WHERE stg.CUSTOMER_PK NOT IN (SELECT CUSTOMER_PK FROM DV_PROTOTYPE_DB.SRC_test_vlt.test_hub_customer)
  );
2019-09-04 20:03:44,972 (Thread-1): SQL status: SUCCESS 1 in 0.72 seconds
2019-09-04 20:03:44,976 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-04 20:03:44,976 (Thread-1): On test_hub_customer: select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from
      DV_PROTOTYPE_DB.information_schema.columns

      where table_name ilike 'test_hub_customer__dbt_tmp'
        
        and table_schema ilike 'SRC_test_vlt'
        
        
        and table_catalog ilike 'DV_PROTOTYPE_DB'
        
      order by ordinal_position
2019-09-04 20:03:46,509 (Thread-1): SQL status: SUCCESS 4 in 1.53 seconds
2019-09-04 20:03:46,524 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-04 20:03:46,524 (Thread-1): On test_hub_customer: select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from
      DV_PROTOTYPE_DB.information_schema.columns

      where table_name ilike 'test_hub_customer'
        
        and table_schema ilike 'SRC_test_vlt'
        
        
        and table_catalog ilike 'DV_PROTOTYPE_DB'
        
      order by ordinal_position
2019-09-04 20:03:47,410 (Thread-1): SQL status: SUCCESS 4 in 0.89 seconds
2019-09-04 20:03:47,415 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-04 20:03:47,415 (Thread-1): On test_hub_customer: select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from
      DV_PROTOTYPE_DB.information_schema.columns

      where table_name ilike 'test_hub_customer'
        
        and table_schema ilike 'SRC_test_vlt'
        
        
        and table_catalog ilike 'DV_PROTOTYPE_DB'
        
      order by ordinal_position
2019-09-04 20:03:48,215 (Thread-1): SQL status: SUCCESS 4 in 0.80 seconds
2019-09-04 20:03:48,243 (Thread-1): Writing runtime SQL for node "model.snow_vault.test_hub_customer"
2019-09-04 20:03:48,244 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-04 20:03:48,244 (Thread-1): On test_hub_customer: insert into DV_PROTOTYPE_DB.SRC_test_vlt.test_hub_customer (CUSTOMER_PK, CUSTOMERKEY, LOADDATE, SOURCE)
        (
            select CUSTOMER_PK, CUSTOMERKEY, LOADDATE, SOURCE
            from DV_PROTOTYPE_DB.SRC_test_vlt.test_hub_customer__dbt_tmp
        );
2019-09-04 20:03:48,466 (Thread-1): SQL status: SUCCESS 0 in 0.22 seconds
2019-09-04 20:03:48,470 (Thread-1): On test_hub_customer: COMMIT
2019-09-04 20:03:48,471 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-04 20:03:48,471 (Thread-1): On test_hub_customer: COMMIT
2019-09-04 20:03:48,604 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2019-09-04 20:03:48,617 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55dd8498-8486-4db2-8f2f-c416446ac65d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f123323b780>]}
2019-09-04 20:03:49,112 (Thread-1): 20:03:49 | 2 of 3 OK created incremental model SRC_test_vlt.test_hub_customer... [SUCCESS 0 in 4.53s]
2019-09-04 20:03:49,113 (Thread-1): 20:03:49 | 3 of 3 START incremental model SRC_VLT.hub_customer.................. [RUN]
2019-09-04 20:03:49,119 (Thread-1): Acquiring new snowflake connection "hub_customer".
2019-09-04 20:03:49,119 (Thread-1): Re-using an available connection from the pool (formerly test_hub_customer).
2019-09-04 20:03:49,120 (Thread-1): Compiling model.dbtTest.hub_customer
2019-09-04 20:03:49,149 (Thread-1): Writing injected SQL for node "model.dbtTest.hub_customer"
2019-09-04 20:03:49,158 (Thread-1): Using snowflake connection "hub_customer".
2019-09-04 20:03:49,158 (Thread-1): On hub_customer: BEGIN
2019-09-04 20:03:49,268 (Thread-1): SQL status: SUCCESS 1 in 0.11 seconds
2019-09-04 20:03:49,269 (Thread-1): Using snowflake connection "hub_customer".
2019-09-04 20:03:49,270 (Thread-1): On hub_customer: create or replace temporary table DV_PROTOTYPE_DB.SRC_VLT.hub_customer__dbt_tmp
  as (
    SELECT 
                CAST(CUSTOMER_PK AS BINARY(16)) AS CUSTOMER_PK,
                CAST(CUSTOMERKEY AS NUMBER(38,0)) AS CUSTOMERKEY,
                CAST(SOURCE AS VARCHAR(4)) AS SOURCE,
                CAST(LOADDATE AS DATE) AS LOADDATE
 FROM (
  SELECT DISTINCT CUSTOMER_PK, CUSTOMERKEY, SOURCE, LOADDATE
  FROM
    (SELECT a.CUSTOMER_PK, a.CUSTOMERKEY, a.SOURCE, a.LOADDATE,
           lag(src_ldts[loop.index0], 1) over(partition by CUSTOMER_PK order by LOADDATE) as FIRST_SEEN
    FROM DV_PROTOTYPE_DB.SRC_STG.stg_orders_hashed AS a
    LEFT JOIN DV_PROTOTYPE_DB.SRC_VLT.hub_customer AS c
    ON a.CUSTOMER_PK = c.CUSTOMER_PK
    AND c.CUSTOMER_PK IS NULL
    )
 AS b)
AS stg
WHERE stg.CUSTOMER_PK NOT IN (SELECT CUSTOMER_PK FROM DV_PROTOTYPE_DB.SRC_VLT.hub_customer)
  );
2019-09-04 20:03:49,557 (Thread-1): Snowflake error: 000904 (42000): 018eaad7-0040-6a47-0000-28a50003001e: SQL compilation error: error line 12 at position 15
invalid identifier 'SRC_LDTS'
2019-09-04 20:03:49,557 (Thread-1): On hub_customer: ROLLBACK
2019-09-04 20:03:49,689 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55dd8498-8486-4db2-8f2f-c416446ac65d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f123340e940>]}
2019-09-04 20:03:50,176 (Thread-1): 20:03:50 | 3 of 3 ERROR creating incremental model SRC_VLT.hub_customer......... [ERROR in 0.57s]
2019-09-04 20:03:50,181 (MainThread): Using snowflake connection "master".
2019-09-04 20:03:50,182 (MainThread): On master: BEGIN
2019-09-04 20:03:50,305 (MainThread): SQL status: SUCCESS 1 in 0.12 seconds
2019-09-04 20:03:50,306 (MainThread): On master: COMMIT
2019-09-04 20:03:50,306 (MainThread): Using snowflake connection "master".
2019-09-04 20:03:50,307 (MainThread): On master: COMMIT
2019-09-04 20:03:50,476 (MainThread): SQL status: SUCCESS 1 in 0.17 seconds
2019-09-04 20:03:50,477 (MainThread): 20:03:50 | 
2019-09-04 20:03:50,478 (MainThread): 20:03:50 | Finished running 1 table models, 2 incremental models in 13.57s.
2019-09-04 20:03:50,478 (MainThread): Connection 'master' was left open.
2019-09-04 20:03:50,479 (MainThread): On master: Close
2019-09-04 20:03:50,631 (MainThread): Connection 'hub_customer' was left open.
2019-09-04 20:03:50,632 (MainThread): On hub_customer: Close
2019-09-04 20:03:50,782 (MainThread): 
2019-09-04 20:03:50,783 (MainThread): Completed with 1 errors:
2019-09-04 20:03:50,783 (MainThread): 
2019-09-04 20:03:50,783 (MainThread): Database Error in model hub_customer (models/hub_sat_link_load/hub_customer.sql)
2019-09-04 20:03:50,783 (MainThread):   000904 (42000): 018eaad7-0040-6a47-0000-28a50003001e: SQL compilation error: error line 12 at position 15
2019-09-04 20:03:50,784 (MainThread):   invalid identifier 'SRC_LDTS'
2019-09-04 20:03:50,784 (MainThread):   compiled SQL at target/compiled/dbtTest/hub_sat_link_load/hub_customer.sql
2019-09-04 20:03:50,784 (MainThread): 
Done. PASS=2 ERROR=1 SKIP=0 TOTAL=3
2019-09-04 20:03:50,784 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12332ea5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f123326ff60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f123321f438>]}
2019-09-04 20:03:51,273 (MainThread): Flushing usage events
2019-09-04 20:03:58,045 (MainThread): Tracking: tracking
2019-09-04 20:03:58,046 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1d2dd1b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1d2dd1fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1d2d6b5c0>]}
2019-09-04 20:03:58,607 (MainThread): Parsing macros/core.sql
2019-09-04 20:03:58,612 (MainThread): Parsing macros/adapters/common.sql
2019-09-04 20:03:58,634 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-09-04 20:03:58,634 (MainThread): Parsing macros/schema_tests/unique.sql
2019-09-04 20:03:58,635 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-09-04 20:03:58,636 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-09-04 20:03:58,637 (MainThread): Parsing macros/materializations/helpers.sql
2019-09-04 20:03:58,641 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-09-04 20:03:58,643 (MainThread): Parsing macros/materializations/view/view.sql
2019-09-04 20:03:58,646 (MainThread): Parsing macros/materializations/table/table.sql
2019-09-04 20:03:58,649 (MainThread): Parsing macros/materializations/common/merge.sql
2019-09-04 20:03:58,653 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2019-09-04 20:03:58,663 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2019-09-04 20:03:58,669 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2019-09-04 20:03:58,670 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-09-04 20:03:58,678 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-09-04 20:03:58,682 (MainThread): Parsing macros/etc/is_incremental.sql
2019-09-04 20:03:58,683 (MainThread): Parsing macros/etc/get_relation_comment.sql
2019-09-04 20:03:58,684 (MainThread): Parsing macros/etc/datetime.sql
2019-09-04 20:03:58,689 (MainThread): Parsing macros/etc/get_custom_alias.sql
2019-09-04 20:03:58,689 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-09-04 20:03:58,691 (MainThread): Parsing macros/etc/query.sql
2019-09-04 20:03:58,692 (MainThread): Parsing macros/adapters.sql
2019-09-04 20:03:58,696 (MainThread): Parsing macros/catalog.sql
2019-09-04 20:03:58,697 (MainThread): Parsing macros/materializations/incremental.sql
2019-09-04 20:03:58,701 (MainThread): Parsing macros/materializations/merge.sql
2019-09-04 20:03:58,702 (MainThread): Parsing macros/materializations/view.sql
2019-09-04 20:03:58,702 (MainThread): Parsing macros/materializations/table.sql
2019-09-04 20:03:58,704 (MainThread): Parsing macros/sat_template.sql
2019-09-04 20:03:58,705 (MainThread): Parsing macros/hub_template.sql
2019-09-04 20:03:58,706 (MainThread): Parsing macros/link_template.sql
2019-09-04 20:03:58,707 (MainThread): Parsing macros/utility/md5_binary.sql
2019-09-04 20:03:58,708 (MainThread): Parsing macros/utility/cast.sql
2019-09-04 20:03:58,709 (MainThread): Parsing macros/utility/union.sql
2019-09-04 20:03:58,710 (MainThread): Parsing macros/utility/prefix.sql
2019-09-04 20:03:58,718 (MainThread): Parsing model.dbtTest.hub_customer
2019-09-04 20:03:58,718 (MainThread): Acquiring new snowflake connection "hub_customer".
2019-09-04 20:03:58,718 (MainThread): Opening a new connection, currently in state init
2019-09-04 20:03:58,926 (MainThread): /home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/snowflake/connector/ocsp_asn1crypto.py:83: ResourceWarning: unclosed file <_io.BufferedReader name='/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/botocore/vendored/requests/cacert.pem'>

2019-09-04 20:03:58,934 (MainThread): /home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/snowflake/connector/ocsp_asn1crypto.py:83: ResourceWarning: unclosed file <_io.BufferedReader name='/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/certifi/cacert.pem'>

2019-09-04 20:03:59,329 (MainThread): Parsing model.dbtTest.stg_orders_hashed
2019-09-04 20:03:59,329 (MainThread): Acquiring new snowflake connection "stg_orders_hashed".
2019-09-04 20:03:59,329 (MainThread): Re-using an available connection from the pool (formerly hub_customer).
2019-09-04 20:03:59,341 (MainThread): Parsing model.snow_vault.test_sat_hub_customer
2019-09-04 20:03:59,341 (MainThread): Acquiring new snowflake connection "test_sat_hub_customer".
2019-09-04 20:03:59,341 (MainThread): Re-using an available connection from the pool (formerly stg_orders_hashed).
2019-09-04 20:03:59,344 (MainThread): Parsing model.snow_vault.test_source
2019-09-04 20:03:59,344 (MainThread): Acquiring new snowflake connection "test_source".
2019-09-04 20:03:59,345 (MainThread): Re-using an available connection from the pool (formerly test_sat_hub_customer).
2019-09-04 20:03:59,348 (MainThread): Parsing model.snow_vault.test_link_customer_nation
2019-09-04 20:03:59,349 (MainThread): Acquiring new snowflake connection "test_link_customer_nation".
2019-09-04 20:03:59,349 (MainThread): Re-using an available connection from the pool (formerly test_source).
2019-09-04 20:03:59,352 (MainThread): Parsing model.snow_vault.test_stg
2019-09-04 20:03:59,352 (MainThread): Acquiring new snowflake connection "test_stg".
2019-09-04 20:03:59,352 (MainThread): Re-using an available connection from the pool (formerly test_link_customer_nation).
2019-09-04 20:03:59,355 (MainThread): Parsing model.snow_vault.test_hub_customer
2019-09-04 20:03:59,355 (MainThread): Acquiring new snowflake connection "test_hub_customer".
2019-09-04 20:03:59,355 (MainThread): Re-using an available connection from the pool (formerly test_stg).
2019-09-04 20:03:59,371 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 123 macros, 0 operations, 0 seed files, 0 sources
2019-09-04 20:03:59,372 (MainThread): 
2019-09-04 20:03:59,372 (MainThread): Acquiring new snowflake connection "master".
2019-09-04 20:03:59,372 (MainThread): Re-using an available connection from the pool (formerly test_hub_customer).
2019-09-04 20:03:59,378 (MainThread): Parsing macros/core.sql
2019-09-04 20:03:59,381 (MainThread): Parsing macros/adapters/common.sql
2019-09-04 20:03:59,398 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-09-04 20:03:59,399 (MainThread): Parsing macros/schema_tests/unique.sql
2019-09-04 20:03:59,400 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-09-04 20:03:59,400 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-09-04 20:03:59,401 (MainThread): Parsing macros/materializations/helpers.sql
2019-09-04 20:03:59,405 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-09-04 20:03:59,408 (MainThread): Parsing macros/materializations/view/view.sql
2019-09-04 20:03:59,411 (MainThread): Parsing macros/materializations/table/table.sql
2019-09-04 20:03:59,414 (MainThread): Parsing macros/materializations/common/merge.sql
2019-09-04 20:03:59,417 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2019-09-04 20:03:59,427 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2019-09-04 20:03:59,433 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2019-09-04 20:03:59,435 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-09-04 20:03:59,443 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-09-04 20:03:59,447 (MainThread): Parsing macros/etc/is_incremental.sql
2019-09-04 20:03:59,448 (MainThread): Parsing macros/etc/get_relation_comment.sql
2019-09-04 20:03:59,449 (MainThread): Parsing macros/etc/datetime.sql
2019-09-04 20:03:59,472 (MainThread): Parsing macros/etc/get_custom_alias.sql
2019-09-04 20:03:59,473 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-09-04 20:03:59,474 (MainThread): Parsing macros/etc/query.sql
2019-09-04 20:03:59,475 (MainThread): Parsing macros/adapters.sql
2019-09-04 20:03:59,480 (MainThread): Parsing macros/catalog.sql
2019-09-04 20:03:59,481 (MainThread): Parsing macros/materializations/incremental.sql
2019-09-04 20:03:59,484 (MainThread): Parsing macros/materializations/merge.sql
2019-09-04 20:03:59,485 (MainThread): Parsing macros/materializations/view.sql
2019-09-04 20:03:59,486 (MainThread): Parsing macros/materializations/table.sql
2019-09-04 20:03:59,535 (MainThread): Using snowflake connection "master".
2019-09-04 20:03:59,536 (MainThread): On master: select distinct schema_name
    from DV_PROTOTYPE_DB.information_schema.schemata
    where catalog_name ilike 'DV_PROTOTYPE_DB'
2019-09-04 20:04:00,278 (MainThread): SQL status: SUCCESS 8 in 0.74 seconds
2019-09-04 20:04:00,299 (MainThread): Creating schema "DV_PROTOTYPE_DB"."SRC_test_vlt".
2019-09-04 20:04:00,306 (MainThread): Using snowflake connection "master".
2019-09-04 20:04:00,306 (MainThread): On master: BEGIN
2019-09-04 20:04:00,446 (MainThread): SQL status: SUCCESS 1 in 0.14 seconds
2019-09-04 20:04:00,447 (MainThread): Using snowflake connection "master".
2019-09-04 20:04:00,447 (MainThread): On master: create schema if not exists DV_PROTOTYPE_DB.SRC_test_vlt
2019-09-04 20:04:00,554 (MainThread): SQL status: SUCCESS 1 in 0.11 seconds
2019-09-04 20:04:00,555 (MainThread): On master: COMMIT
2019-09-04 20:04:00,555 (MainThread): Using snowflake connection "master".
2019-09-04 20:04:00,555 (MainThread): On master: COMMIT
2019-09-04 20:04:00,712 (MainThread): SQL status: SUCCESS 1 in 0.16 seconds
2019-09-04 20:04:00,757 (MainThread): Using snowflake connection "master".
2019-09-04 20:04:00,757 (MainThread): On master: BEGIN
2019-09-04 20:04:00,866 (MainThread): SQL status: SUCCESS 1 in 0.11 seconds
2019-09-04 20:04:00,867 (MainThread): Using snowflake connection "master".
2019-09-04 20:04:00,867 (MainThread): On master: select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'externaltable'
           else table_type
      end as table_type
    from DV_PROTOTYPE_DB.information_schema.tables
    where table_schema ilike 'src_vlt'
      and table_catalog ilike 'dv_prototype_db'
2019-09-04 20:04:01,632 (MainThread): SQL status: SUCCESS 29 in 0.77 seconds
2019-09-04 20:04:01,648 (MainThread): Using snowflake connection "master".
2019-09-04 20:04:01,648 (MainThread): On master: select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'externaltable'
           else table_type
      end as table_type
    from DV_PROTOTYPE_DB.information_schema.tables
    where table_schema ilike 'src_stg'
      and table_catalog ilike 'dv_prototype_db'
2019-09-04 20:04:02,967 (MainThread): SQL status: SUCCESS 6 in 1.32 seconds
2019-09-04 20:04:02,996 (MainThread): Using snowflake connection "master".
2019-09-04 20:04:02,996 (MainThread): On master: select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'externaltable'
           else table_type
      end as table_type
    from DV_PROTOTYPE_DB.information_schema.tables
    where table_schema ilike 'src_test_vlt'
      and table_catalog ilike 'dv_prototype_db'
2019-09-04 20:04:03,628 (MainThread): SQL status: SUCCESS 3 in 0.63 seconds
2019-09-04 20:04:03,642 (MainThread): On master: ROLLBACK
2019-09-04 20:04:03,780 (MainThread): Using snowflake connection "master".
2019-09-04 20:04:03,780 (MainThread): On master: BEGIN
2019-09-04 20:04:03,887 (MainThread): SQL status: SUCCESS 1 in 0.11 seconds
2019-09-04 20:04:03,888 (MainThread): On master: COMMIT
2019-09-04 20:04:03,888 (MainThread): Using snowflake connection "master".
2019-09-04 20:04:03,888 (MainThread): On master: COMMIT
2019-09-04 20:04:04,070 (MainThread): SQL status: SUCCESS 1 in 0.18 seconds
2019-09-04 20:04:04,071 (MainThread): 20:04:04 | Concurrency: 1 threads (target='dev')
2019-09-04 20:04:04,072 (MainThread): 20:04:04 | 
2019-09-04 20:04:04,075 (Thread-1): 20:04:04 | 1 of 3 START table model SRC_STG.stg_orders_hashed................... [RUN]
2019-09-04 20:04:04,076 (Thread-1): Acquiring new snowflake connection "stg_orders_hashed".
2019-09-04 20:04:04,076 (Thread-1): Opening a new connection, currently in state init
2019-09-04 20:04:04,695 (Thread-1): Compiling model.dbtTest.stg_orders_hashed
2019-09-04 20:04:04,734 (Thread-1): Writing injected SQL for node "model.dbtTest.stg_orders_hashed"
2019-09-04 20:04:04,755 (Thread-1): Writing runtime SQL for node "model.dbtTest.stg_orders_hashed"
2019-09-04 20:04:04,758 (Thread-1): Using snowflake connection "stg_orders_hashed".
2019-09-04 20:04:04,758 (Thread-1): On stg_orders_hashed: BEGIN
2019-09-04 20:04:04,917 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2019-09-04 20:04:04,918 (Thread-1): Using snowflake connection "stg_orders_hashed".
2019-09-04 20:04:04,918 (Thread-1): On stg_orders_hashed: create or replace transient table DV_PROTOTYPE_DB.SRC_STG.stg_orders_hashed
  as (
    

select
CAST(MD5_BINARY(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR)))) AS BINARY(16)) AS ORDER_PK,
CAST(MD5_BINARY(UPPER(TRIM(CAST(PARTKEY AS VARCHAR)))) AS BINARY(16)) AS PART_PK,
CAST(MD5_BINARY(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR)))) AS BINARY(16)) AS SUPPLIER_PK,
CAST(MD5_BINARY(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR)))) AS BINARY(16)) AS LINEITEM_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS INVENTORY_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS INVENTORY_ALLOCATION_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(COMMITDATE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(DISCOUNT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(EXTENDEDPRICE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(LINESTATUS AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(LINE_COMMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(QUANTITY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(RECEIPTDATE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(RETURNFLAG AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SHIPDATE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SHIPINSTRUCT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SHIPMODE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(TAX AS VARCHAR))), '^^') )) AS BINARY(16)) AS LINEITEM_HASHDIFF,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS LINEITEM_ORDER_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CLERK AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDERDATE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDERPRIORITY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDERSTATUS AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDER_COMMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SHIPPRIORITY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(TOTALPRICE AS VARCHAR))), '^^') )) AS BINARY(16)) AS ORDER_HASHDIFF,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS ORDER_CUSTOMER_PK,
CAST(MD5_BINARY(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR)))) AS BINARY(16)) AS CUSTOMER_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_NATIONKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS LINK_CUSTOMER_NATION_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMER_ACCBAL AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_COMMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_MKTSEGMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_NAME AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_PHONE AS VARCHAR))), '^^') )) AS BINARY(16)) AS CUSTOMER_HASHDIFF,
CAST(MD5_BINARY(UPPER(TRIM(CAST(CUSTOMER_NATIONKEY AS VARCHAR)))) AS BINARY(16)) AS CUSTOMER_NATION_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMER_NATION_COMMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_NATION_NAME AS VARCHAR))), '^^') )) AS BINARY(16)) AS CUSTOMER_NATION_HASHDIFF,
CAST(MD5_BINARY(UPPER(TRIM(CAST(CUSTOMER_REGIONKEY AS VARCHAR)))) AS BINARY(16)) AS CUSTOMER_REGION_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMER_NATIONKEY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_REGIONKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS CUSTOMER_NATION_REGION_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMER_REGION_COMMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_REGION_NAME AS VARCHAR))), '^^') )) AS BINARY(16)) AS CUSTOMER_REGION_HASHDIFF,
 *, TO_DATE('1992-01-08') AS LOADDATE, TO_DATE('1992-01-08') AS EFFECTIVE_FROM, 'TPCH' AS SOURCE FROM DV_PROTOTYPE_DB.SRC_STG.V_SRC_STG_ORDERS
  );
2019-09-04 20:04:05,779 (Thread-1): SQL status: SUCCESS 1 in 0.86 seconds
2019-09-04 20:04:05,782 (Thread-1): On stg_orders_hashed: COMMIT
2019-09-04 20:04:05,783 (Thread-1): Using snowflake connection "stg_orders_hashed".
2019-09-04 20:04:05,783 (Thread-1): On stg_orders_hashed: COMMIT
2019-09-04 20:04:05,875 (Thread-1): SQL status: SUCCESS 1 in 0.09 seconds
2019-09-04 20:04:05,887 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e965f50-df1d-4c27-a768-beb922d708b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1f3234668>]}
2019-09-04 20:04:06,458 (Thread-1): 20:04:06 | 1 of 3 OK created table model SRC_STG.stg_orders_hashed.............. [SUCCESS 1 in 1.81s]
2019-09-04 20:04:06,459 (Thread-1): 20:04:06 | 2 of 3 START incremental model SRC_test_vlt.test_hub_customer........ [RUN]
2019-09-04 20:04:06,459 (Thread-1): Acquiring new snowflake connection "test_hub_customer".
2019-09-04 20:04:06,460 (Thread-1): Re-using an available connection from the pool (formerly stg_orders_hashed).
2019-09-04 20:04:06,461 (Thread-1): Compiling model.snow_vault.test_hub_customer
2019-09-04 20:04:06,479 (Thread-1): Writing injected SQL for node "model.snow_vault.test_hub_customer"
2019-09-04 20:04:06,516 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-04 20:04:06,516 (Thread-1): On test_hub_customer: BEGIN
2019-09-04 20:04:06,631 (Thread-1): SQL status: SUCCESS 1 in 0.11 seconds
2019-09-04 20:04:06,631 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-04 20:04:06,632 (Thread-1): On test_hub_customer: create or replace temporary table DV_PROTOTYPE_DB.SRC_test_vlt.test_hub_customer__dbt_tmp
  as (
    

SELECT
                CAST(CUSTOMER_PK AS BINARY(16)) AS CUSTOMER_PK,
                CAST(CUSTOMERKEY AS NUMBER(38,0)) AS CUSTOMERKEY,
                CAST(SOURCE AS VARCHAR(4)) AS SOURCE,
                CAST(LOADDATE AS DATE) AS LOADDATE

 FROM (
  SELECT DISTINCT CUSTOMER_PK, CUSTOMERKEY, SOURCE, LOADDATE
  FROM
    (SELECT DISTINCT a.CUSTOMER_PK, a.CUSTOMERKEY, a.SOURCE, a.LOADDATE
    FROM DV_PROTOTYPE_DB.SRC_TEST_STG.STG_CUSTOMER AS a
    LEFT JOIN DV_PROTOTYPE_DB.SRC_test_vlt.test_hub_customer AS c
    ON a.CUSTOMER_PK = c.CUSTOMER_PK
    AND c.CUSTOMER_PK IS NULL)
 AS b)
AS stg
WHERE stg.CUSTOMER_PK NOT IN (SELECT CUSTOMER_PK FROM DV_PROTOTYPE_DB.SRC_test_vlt.test_hub_customer)
  );
2019-09-04 20:04:07,213 (Thread-1): SQL status: SUCCESS 1 in 0.58 seconds
2019-09-04 20:04:07,218 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-04 20:04:07,218 (Thread-1): On test_hub_customer: select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from
      DV_PROTOTYPE_DB.information_schema.columns

      where table_name ilike 'test_hub_customer__dbt_tmp'
        
        and table_schema ilike 'SRC_test_vlt'
        
        
        and table_catalog ilike 'DV_PROTOTYPE_DB'
        
      order by ordinal_position
2019-09-04 20:04:08,045 (Thread-1): SQL status: SUCCESS 4 in 0.83 seconds
2019-09-04 20:04:08,050 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-04 20:04:08,050 (Thread-1): On test_hub_customer: select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from
      DV_PROTOTYPE_DB.information_schema.columns

      where table_name ilike 'test_hub_customer'
        
        and table_schema ilike 'SRC_test_vlt'
        
        
        and table_catalog ilike 'DV_PROTOTYPE_DB'
        
      order by ordinal_position
2019-09-04 20:04:08,758 (Thread-1): SQL status: SUCCESS 4 in 0.71 seconds
2019-09-04 20:04:08,762 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-04 20:04:08,762 (Thread-1): On test_hub_customer: select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from
      DV_PROTOTYPE_DB.information_schema.columns

      where table_name ilike 'test_hub_customer'
        
        and table_schema ilike 'SRC_test_vlt'
        
        
        and table_catalog ilike 'DV_PROTOTYPE_DB'
        
      order by ordinal_position
2019-09-04 20:04:09,482 (Thread-1): SQL status: SUCCESS 4 in 0.72 seconds
2019-09-04 20:04:09,494 (Thread-1): Writing runtime SQL for node "model.snow_vault.test_hub_customer"
2019-09-04 20:04:09,494 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-04 20:04:09,494 (Thread-1): On test_hub_customer: insert into DV_PROTOTYPE_DB.SRC_test_vlt.test_hub_customer (CUSTOMER_PK, CUSTOMERKEY, LOADDATE, SOURCE)
        (
            select CUSTOMER_PK, CUSTOMERKEY, LOADDATE, SOURCE
            from DV_PROTOTYPE_DB.SRC_test_vlt.test_hub_customer__dbt_tmp
        );
2019-09-04 20:04:09,732 (Thread-1): SQL status: SUCCESS 0 in 0.24 seconds
2019-09-04 20:04:09,735 (Thread-1): On test_hub_customer: COMMIT
2019-09-04 20:04:09,736 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-04 20:04:09,736 (Thread-1): On test_hub_customer: COMMIT
2019-09-04 20:04:09,950 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2019-09-04 20:04:09,956 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e965f50-df1d-4c27-a768-beb922d708b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1f3234668>]}
2019-09-04 20:04:10,459 (Thread-1): 20:04:10 | 2 of 3 OK created incremental model SRC_test_vlt.test_hub_customer... [SUCCESS 0 in 3.50s]
2019-09-04 20:04:10,460 (Thread-1): 20:04:10 | 3 of 3 START incremental model SRC_VLT.hub_customer.................. [RUN]
2019-09-04 20:04:10,460 (Thread-1): Acquiring new snowflake connection "hub_customer".
2019-09-04 20:04:10,460 (Thread-1): Re-using an available connection from the pool (formerly test_hub_customer).
2019-09-04 20:04:10,461 (Thread-1): Compiling model.dbtTest.hub_customer
2019-09-04 20:04:10,466 (Thread-1): Writing injected SQL for node "model.dbtTest.hub_customer"
2019-09-04 20:04:10,470 (Thread-1): Using snowflake connection "hub_customer".
2019-09-04 20:04:10,470 (Thread-1): On hub_customer: BEGIN
2019-09-04 20:04:10,586 (Thread-1): SQL status: SUCCESS 1 in 0.12 seconds
2019-09-04 20:04:10,587 (Thread-1): Using snowflake connection "hub_customer".
2019-09-04 20:04:10,588 (Thread-1): On hub_customer: create or replace temporary table DV_PROTOTYPE_DB.SRC_VLT.hub_customer__dbt_tmp
  as (
    SELECT 
                CAST(CUSTOMER_PK AS BINARY(16)) AS CUSTOMER_PK,
                CAST(CUSTOMERKEY AS NUMBER(38,0)) AS CUSTOMERKEY,
                CAST(SOURCE AS VARCHAR(4)) AS SOURCE,
                CAST(LOADDATE AS DATE) AS LOADDATE
 FROM (
  SELECT DISTINCT CUSTOMER_PK, CUSTOMERKEY, SOURCE, LOADDATE
  FROM
    (SELECT a.CUSTOMER_PK, a.CUSTOMERKEY, a.SOURCE, a.LOADDATE,
           lag(LOADDATE, 1) over(partition by CUSTOMER_PK order by LOADDATE) as FIRST_SEEN
    FROM DV_PROTOTYPE_DB.SRC_STG.stg_orders_hashed AS a
    LEFT JOIN DV_PROTOTYPE_DB.SRC_VLT.hub_customer AS c
    ON a.CUSTOMER_PK = c.CUSTOMER_PK
    AND c.CUSTOMER_PK IS NULL
    )
 AS b)
AS stg
WHERE stg.CUSTOMER_PK NOT IN (SELECT CUSTOMER_PK FROM DV_PROTOTYPE_DB.SRC_VLT.hub_customer)
  );
2019-09-04 20:04:10,809 (Thread-1): Snowflake error: 002028 (42601): 018eaad8-00ac-df86-0000-28a50002dfee: SQL compilation error:
ambiguous column name 'LOADDATE'
2019-09-04 20:04:10,809 (Thread-1): On hub_customer: ROLLBACK
2019-09-04 20:04:10,959 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e965f50-df1d-4c27-a768-beb922d708b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1f316dd68>]}
2019-09-04 20:04:11,458 (Thread-1): 20:04:11 | 3 of 3 ERROR creating incremental model SRC_VLT.hub_customer......... [ERROR in 0.50s]
2019-09-04 20:04:11,513 (MainThread): Using snowflake connection "master".
2019-09-04 20:04:11,513 (MainThread): On master: BEGIN
2019-09-04 20:04:11,622 (MainThread): SQL status: SUCCESS 1 in 0.11 seconds
2019-09-04 20:04:11,623 (MainThread): On master: COMMIT
2019-09-04 20:04:11,623 (MainThread): Using snowflake connection "master".
2019-09-04 20:04:11,623 (MainThread): On master: COMMIT
2019-09-04 20:04:11,760 (MainThread): SQL status: SUCCESS 1 in 0.14 seconds
2019-09-04 20:04:11,761 (MainThread): 20:04:11 | 
2019-09-04 20:04:11,761 (MainThread): 20:04:11 | Finished running 1 table models, 2 incremental models in 12.39s.
2019-09-04 20:04:11,761 (MainThread): Connection 'master' was left open.
2019-09-04 20:04:11,762 (MainThread): On master: Close
2019-09-04 20:04:11,908 (MainThread): Connection 'hub_customer' was left open.
2019-09-04 20:04:11,908 (MainThread): On hub_customer: Close
2019-09-04 20:04:12,094 (MainThread): 
2019-09-04 20:04:12,094 (MainThread): Completed with 1 errors:
2019-09-04 20:04:12,094 (MainThread): 
2019-09-04 20:04:12,095 (MainThread): Database Error in model hub_customer (models/hub_sat_link_load/hub_customer.sql)
2019-09-04 20:04:12,095 (MainThread):   002028 (42601): 018eaad8-00ac-df86-0000-28a50002dfee: SQL compilation error:
2019-09-04 20:04:12,095 (MainThread):   ambiguous column name 'LOADDATE'
2019-09-04 20:04:12,095 (MainThread):   compiled SQL at target/compiled/dbtTest/hub_sat_link_load/hub_customer.sql
2019-09-04 20:04:12,095 (MainThread): 
Done. PASS=2 ERROR=1 SKIP=0 TOTAL=3
2019-09-04 20:04:12,095 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1d2dd1470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1d2d91748>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1f32b28d0>]}
2019-09-04 20:04:12,585 (MainThread): Flushing usage events
2019-09-04 20:04:30,026 (MainThread): Tracking: tracking
2019-09-04 20:04:30,027 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b90d21a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b90d21f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b90cb7550>]}
2019-09-04 20:04:30,578 (MainThread): Parsing macros/core.sql
2019-09-04 20:04:30,582 (MainThread): Parsing macros/adapters/common.sql
2019-09-04 20:04:30,604 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-09-04 20:04:30,604 (MainThread): Parsing macros/schema_tests/unique.sql
2019-09-04 20:04:30,605 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-09-04 20:04:30,606 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-09-04 20:04:30,607 (MainThread): Parsing macros/materializations/helpers.sql
2019-09-04 20:04:30,611 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-09-04 20:04:30,613 (MainThread): Parsing macros/materializations/view/view.sql
2019-09-04 20:04:30,616 (MainThread): Parsing macros/materializations/table/table.sql
2019-09-04 20:04:30,619 (MainThread): Parsing macros/materializations/common/merge.sql
2019-09-04 20:04:30,623 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2019-09-04 20:04:30,632 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2019-09-04 20:04:30,638 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2019-09-04 20:04:30,640 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-09-04 20:04:30,647 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-09-04 20:04:30,651 (MainThread): Parsing macros/etc/is_incremental.sql
2019-09-04 20:04:30,652 (MainThread): Parsing macros/etc/get_relation_comment.sql
2019-09-04 20:04:30,654 (MainThread): Parsing macros/etc/datetime.sql
2019-09-04 20:04:30,658 (MainThread): Parsing macros/etc/get_custom_alias.sql
2019-09-04 20:04:30,659 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-09-04 20:04:30,660 (MainThread): Parsing macros/etc/query.sql
2019-09-04 20:04:30,661 (MainThread): Parsing macros/adapters.sql
2019-09-04 20:04:30,665 (MainThread): Parsing macros/catalog.sql
2019-09-04 20:04:30,666 (MainThread): Parsing macros/materializations/incremental.sql
2019-09-04 20:04:30,670 (MainThread): Parsing macros/materializations/merge.sql
2019-09-04 20:04:30,671 (MainThread): Parsing macros/materializations/view.sql
2019-09-04 20:04:30,671 (MainThread): Parsing macros/materializations/table.sql
2019-09-04 20:04:30,673 (MainThread): Parsing macros/sat_template.sql
2019-09-04 20:04:30,674 (MainThread): Parsing macros/hub_template.sql
2019-09-04 20:04:30,675 (MainThread): Parsing macros/link_template.sql
2019-09-04 20:04:30,676 (MainThread): Parsing macros/utility/md5_binary.sql
2019-09-04 20:04:30,677 (MainThread): Parsing macros/utility/cast.sql
2019-09-04 20:04:30,678 (MainThread): Parsing macros/utility/union.sql
2019-09-04 20:04:30,679 (MainThread): Parsing macros/utility/prefix.sql
2019-09-04 20:04:30,687 (MainThread): Parsing model.dbtTest.hub_customer
2019-09-04 20:04:30,687 (MainThread): Acquiring new snowflake connection "hub_customer".
2019-09-04 20:04:30,687 (MainThread): Opening a new connection, currently in state init
2019-09-04 20:04:30,885 (MainThread): /home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/snowflake/connector/ocsp_asn1crypto.py:83: ResourceWarning: unclosed file <_io.BufferedReader name='/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/botocore/vendored/requests/cacert.pem'>

2019-09-04 20:04:30,894 (MainThread): /home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/snowflake/connector/ocsp_asn1crypto.py:83: ResourceWarning: unclosed file <_io.BufferedReader name='/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/certifi/cacert.pem'>

2019-09-04 20:04:31,254 (MainThread): Parsing model.dbtTest.stg_orders_hashed
2019-09-04 20:04:31,254 (MainThread): Acquiring new snowflake connection "stg_orders_hashed".
2019-09-04 20:04:31,254 (MainThread): Re-using an available connection from the pool (formerly hub_customer).
2019-09-04 20:04:31,266 (MainThread): Parsing model.snow_vault.test_sat_hub_customer
2019-09-04 20:04:31,266 (MainThread): Acquiring new snowflake connection "test_sat_hub_customer".
2019-09-04 20:04:31,266 (MainThread): Re-using an available connection from the pool (formerly stg_orders_hashed).
2019-09-04 20:04:31,269 (MainThread): Parsing model.snow_vault.test_source
2019-09-04 20:04:31,270 (MainThread): Acquiring new snowflake connection "test_source".
2019-09-04 20:04:31,270 (MainThread): Re-using an available connection from the pool (formerly test_sat_hub_customer).
2019-09-04 20:04:31,273 (MainThread): Parsing model.snow_vault.test_link_customer_nation
2019-09-04 20:04:31,274 (MainThread): Acquiring new snowflake connection "test_link_customer_nation".
2019-09-04 20:04:31,274 (MainThread): Re-using an available connection from the pool (formerly test_source).
2019-09-04 20:04:31,277 (MainThread): Parsing model.snow_vault.test_stg
2019-09-04 20:04:31,277 (MainThread): Acquiring new snowflake connection "test_stg".
2019-09-04 20:04:31,277 (MainThread): Re-using an available connection from the pool (formerly test_link_customer_nation).
2019-09-04 20:04:31,280 (MainThread): Parsing model.snow_vault.test_hub_customer
2019-09-04 20:04:31,280 (MainThread): Acquiring new snowflake connection "test_hub_customer".
2019-09-04 20:04:31,280 (MainThread): Re-using an available connection from the pool (formerly test_stg).
2019-09-04 20:04:31,296 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 123 macros, 0 operations, 0 seed files, 0 sources
2019-09-04 20:04:31,297 (MainThread): 
2019-09-04 20:04:31,297 (MainThread): Acquiring new snowflake connection "master".
2019-09-04 20:04:31,297 (MainThread): Re-using an available connection from the pool (formerly test_hub_customer).
2019-09-04 20:04:31,304 (MainThread): Parsing macros/core.sql
2019-09-04 20:04:31,306 (MainThread): Parsing macros/adapters/common.sql
2019-09-04 20:04:31,323 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-09-04 20:04:31,324 (MainThread): Parsing macros/schema_tests/unique.sql
2019-09-04 20:04:31,325 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-09-04 20:04:31,325 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-09-04 20:04:31,326 (MainThread): Parsing macros/materializations/helpers.sql
2019-09-04 20:04:31,330 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-09-04 20:04:31,333 (MainThread): Parsing macros/materializations/view/view.sql
2019-09-04 20:04:31,336 (MainThread): Parsing macros/materializations/table/table.sql
2019-09-04 20:04:31,340 (MainThread): Parsing macros/materializations/common/merge.sql
2019-09-04 20:04:31,347 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2019-09-04 20:04:31,359 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2019-09-04 20:04:31,365 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2019-09-04 20:04:31,366 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-09-04 20:04:31,374 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-09-04 20:04:31,378 (MainThread): Parsing macros/etc/is_incremental.sql
2019-09-04 20:04:31,379 (MainThread): Parsing macros/etc/get_relation_comment.sql
2019-09-04 20:04:31,380 (MainThread): Parsing macros/etc/datetime.sql
2019-09-04 20:04:31,403 (MainThread): Parsing macros/etc/get_custom_alias.sql
2019-09-04 20:04:31,404 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-09-04 20:04:31,405 (MainThread): Parsing macros/etc/query.sql
2019-09-04 20:04:31,406 (MainThread): Parsing macros/adapters.sql
2019-09-04 20:04:31,411 (MainThread): Parsing macros/catalog.sql
2019-09-04 20:04:31,412 (MainThread): Parsing macros/materializations/incremental.sql
2019-09-04 20:04:31,416 (MainThread): Parsing macros/materializations/merge.sql
2019-09-04 20:04:31,416 (MainThread): Parsing macros/materializations/view.sql
2019-09-04 20:04:31,417 (MainThread): Parsing macros/materializations/table.sql
2019-09-04 20:04:31,466 (MainThread): Using snowflake connection "master".
2019-09-04 20:04:31,466 (MainThread): On master: select distinct schema_name
    from DV_PROTOTYPE_DB.information_schema.schemata
    where catalog_name ilike 'DV_PROTOTYPE_DB'
2019-09-04 20:04:31,953 (MainThread): SQL status: SUCCESS 8 in 0.49 seconds
2019-09-04 20:04:31,959 (MainThread): Creating schema "DV_PROTOTYPE_DB"."SRC_test_vlt".
2019-09-04 20:04:31,960 (MainThread): Using snowflake connection "master".
2019-09-04 20:04:31,960 (MainThread): On master: BEGIN
2019-09-04 20:04:32,068 (MainThread): SQL status: SUCCESS 1 in 0.11 seconds
2019-09-04 20:04:32,069 (MainThread): Using snowflake connection "master".
2019-09-04 20:04:32,069 (MainThread): On master: create schema if not exists DV_PROTOTYPE_DB.SRC_test_vlt
2019-09-04 20:04:32,168 (MainThread): SQL status: SUCCESS 1 in 0.10 seconds
2019-09-04 20:04:32,171 (MainThread): On master: COMMIT
2019-09-04 20:04:32,172 (MainThread): Using snowflake connection "master".
2019-09-04 20:04:32,172 (MainThread): On master: COMMIT
2019-09-04 20:04:32,342 (MainThread): SQL status: SUCCESS 1 in 0.17 seconds
2019-09-04 20:04:32,386 (MainThread): Using snowflake connection "master".
2019-09-04 20:04:32,386 (MainThread): On master: BEGIN
2019-09-04 20:04:32,509 (MainThread): SQL status: SUCCESS 1 in 0.12 seconds
2019-09-04 20:04:32,510 (MainThread): Using snowflake connection "master".
2019-09-04 20:04:32,510 (MainThread): On master: select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'externaltable'
           else table_type
      end as table_type
    from DV_PROTOTYPE_DB.information_schema.tables
    where table_schema ilike 'src_test_vlt'
      and table_catalog ilike 'dv_prototype_db'
2019-09-04 20:04:33,940 (MainThread): SQL status: SUCCESS 3 in 1.43 seconds
2019-09-04 20:04:33,943 (MainThread): Using snowflake connection "master".
2019-09-04 20:04:33,943 (MainThread): On master: select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'externaltable'
           else table_type
      end as table_type
    from DV_PROTOTYPE_DB.information_schema.tables
    where table_schema ilike 'src_vlt'
      and table_catalog ilike 'dv_prototype_db'
2019-09-04 20:04:34,583 (MainThread): SQL status: SUCCESS 29 in 0.64 seconds
2019-09-04 20:04:34,634 (MainThread): Using snowflake connection "master".
2019-09-04 20:04:34,634 (MainThread): On master: select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'externaltable'
           else table_type
      end as table_type
    from DV_PROTOTYPE_DB.information_schema.tables
    where table_schema ilike 'src_stg'
      and table_catalog ilike 'dv_prototype_db'
2019-09-04 20:04:35,225 (MainThread): SQL status: SUCCESS 6 in 0.59 seconds
2019-09-04 20:04:35,229 (MainThread): On master: ROLLBACK
2019-09-04 20:04:35,388 (MainThread): Using snowflake connection "master".
2019-09-04 20:04:35,388 (MainThread): On master: BEGIN
2019-09-04 20:04:35,493 (MainThread): SQL status: SUCCESS 1 in 0.11 seconds
2019-09-04 20:04:35,494 (MainThread): On master: COMMIT
2019-09-04 20:04:35,494 (MainThread): Using snowflake connection "master".
2019-09-04 20:04:35,494 (MainThread): On master: COMMIT
2019-09-04 20:04:35,626 (MainThread): SQL status: SUCCESS 1 in 0.13 seconds
2019-09-04 20:04:35,628 (MainThread): 20:04:35 | Concurrency: 1 threads (target='dev')
2019-09-04 20:04:35,628 (MainThread): 20:04:35 | 
2019-09-04 20:04:35,631 (Thread-1): 20:04:35 | 1 of 3 START table model SRC_STG.stg_orders_hashed................... [RUN]
2019-09-04 20:04:35,632 (Thread-1): Acquiring new snowflake connection "stg_orders_hashed".
2019-09-04 20:04:35,633 (Thread-1): Opening a new connection, currently in state init
2019-09-04 20:04:36,124 (Thread-1): Compiling model.dbtTest.stg_orders_hashed
2019-09-04 20:04:36,166 (Thread-1): Writing injected SQL for node "model.dbtTest.stg_orders_hashed"
2019-09-04 20:04:36,188 (Thread-1): Writing runtime SQL for node "model.dbtTest.stg_orders_hashed"
2019-09-04 20:04:36,191 (Thread-1): Using snowflake connection "stg_orders_hashed".
2019-09-04 20:04:36,191 (Thread-1): On stg_orders_hashed: BEGIN
2019-09-04 20:04:36,304 (Thread-1): SQL status: SUCCESS 1 in 0.11 seconds
2019-09-04 20:04:36,305 (Thread-1): Using snowflake connection "stg_orders_hashed".
2019-09-04 20:04:36,305 (Thread-1): On stg_orders_hashed: create or replace transient table DV_PROTOTYPE_DB.SRC_STG.stg_orders_hashed
  as (
    

select
CAST(MD5_BINARY(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR)))) AS BINARY(16)) AS ORDER_PK,
CAST(MD5_BINARY(UPPER(TRIM(CAST(PARTKEY AS VARCHAR)))) AS BINARY(16)) AS PART_PK,
CAST(MD5_BINARY(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR)))) AS BINARY(16)) AS SUPPLIER_PK,
CAST(MD5_BINARY(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR)))) AS BINARY(16)) AS LINEITEM_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS INVENTORY_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS INVENTORY_ALLOCATION_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(COMMITDATE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(DISCOUNT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(EXTENDEDPRICE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(LINESTATUS AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(LINE_COMMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(QUANTITY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(RECEIPTDATE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(RETURNFLAG AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SHIPDATE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SHIPINSTRUCT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SHIPMODE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(TAX AS VARCHAR))), '^^') )) AS BINARY(16)) AS LINEITEM_HASHDIFF,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS LINEITEM_ORDER_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CLERK AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDERDATE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDERPRIORITY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDERSTATUS AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDER_COMMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SHIPPRIORITY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(TOTALPRICE AS VARCHAR))), '^^') )) AS BINARY(16)) AS ORDER_HASHDIFF,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS ORDER_CUSTOMER_PK,
CAST(MD5_BINARY(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR)))) AS BINARY(16)) AS CUSTOMER_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_NATIONKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS LINK_CUSTOMER_NATION_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMER_ACCBAL AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_COMMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_MKTSEGMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_NAME AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_PHONE AS VARCHAR))), '^^') )) AS BINARY(16)) AS CUSTOMER_HASHDIFF,
CAST(MD5_BINARY(UPPER(TRIM(CAST(CUSTOMER_NATIONKEY AS VARCHAR)))) AS BINARY(16)) AS CUSTOMER_NATION_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMER_NATION_COMMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_NATION_NAME AS VARCHAR))), '^^') )) AS BINARY(16)) AS CUSTOMER_NATION_HASHDIFF,
CAST(MD5_BINARY(UPPER(TRIM(CAST(CUSTOMER_REGIONKEY AS VARCHAR)))) AS BINARY(16)) AS CUSTOMER_REGION_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMER_NATIONKEY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_REGIONKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS CUSTOMER_NATION_REGION_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMER_REGION_COMMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_REGION_NAME AS VARCHAR))), '^^') )) AS BINARY(16)) AS CUSTOMER_REGION_HASHDIFF,
 *, TO_DATE('1992-01-08') AS LOADDATE, TO_DATE('1992-01-08') AS EFFECTIVE_FROM, 'TPCH' AS SOURCE FROM DV_PROTOTYPE_DB.SRC_STG.V_SRC_STG_ORDERS
  );
2019-09-04 20:04:37,252 (Thread-1): SQL status: SUCCESS 1 in 0.95 seconds
2019-09-04 20:04:37,254 (Thread-1): On stg_orders_hashed: COMMIT
2019-09-04 20:04:37,254 (Thread-1): Using snowflake connection "stg_orders_hashed".
2019-09-04 20:04:37,254 (Thread-1): On stg_orders_hashed: COMMIT
2019-09-04 20:04:37,350 (Thread-1): SQL status: SUCCESS 1 in 0.10 seconds
2019-09-04 20:04:37,362 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d10123d-2480-44ba-b694-4e85f57b9063', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bb12fc780>]}
2019-09-04 20:04:37,884 (Thread-1): 20:04:37 | 1 of 3 OK created table model SRC_STG.stg_orders_hashed.............. [SUCCESS 1 in 1.73s]
2019-09-04 20:04:37,885 (Thread-1): 20:04:37 | 2 of 3 START incremental model SRC_test_vlt.test_hub_customer........ [RUN]
2019-09-04 20:04:37,885 (Thread-1): Acquiring new snowflake connection "test_hub_customer".
2019-09-04 20:04:37,885 (Thread-1): Re-using an available connection from the pool (formerly stg_orders_hashed).
2019-09-04 20:04:37,885 (Thread-1): Compiling model.snow_vault.test_hub_customer
2019-09-04 20:04:37,888 (Thread-1): Writing injected SQL for node "model.snow_vault.test_hub_customer"
2019-09-04 20:04:37,900 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-04 20:04:37,900 (Thread-1): On test_hub_customer: BEGIN
2019-09-04 20:04:38,010 (Thread-1): SQL status: SUCCESS 1 in 0.11 seconds
2019-09-04 20:04:38,011 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-04 20:04:38,011 (Thread-1): On test_hub_customer: create or replace temporary table DV_PROTOTYPE_DB.SRC_test_vlt.test_hub_customer__dbt_tmp
  as (
    

SELECT
                CAST(CUSTOMER_PK AS BINARY(16)) AS CUSTOMER_PK,
                CAST(CUSTOMERKEY AS NUMBER(38,0)) AS CUSTOMERKEY,
                CAST(SOURCE AS VARCHAR(4)) AS SOURCE,
                CAST(LOADDATE AS DATE) AS LOADDATE

 FROM (
  SELECT DISTINCT CUSTOMER_PK, CUSTOMERKEY, SOURCE, LOADDATE
  FROM
    (SELECT DISTINCT a.CUSTOMER_PK, a.CUSTOMERKEY, a.SOURCE, a.LOADDATE
    FROM DV_PROTOTYPE_DB.SRC_TEST_STG.STG_CUSTOMER AS a
    LEFT JOIN DV_PROTOTYPE_DB.SRC_test_vlt.test_hub_customer AS c
    ON a.CUSTOMER_PK = c.CUSTOMER_PK
    AND c.CUSTOMER_PK IS NULL)
 AS b)
AS stg
WHERE stg.CUSTOMER_PK NOT IN (SELECT CUSTOMER_PK FROM DV_PROTOTYPE_DB.SRC_test_vlt.test_hub_customer)
  );
2019-09-04 20:04:38,506 (Thread-1): SQL status: SUCCESS 1 in 0.49 seconds
2019-09-04 20:04:38,510 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-04 20:04:38,510 (Thread-1): On test_hub_customer: select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from
      DV_PROTOTYPE_DB.information_schema.columns

      where table_name ilike 'test_hub_customer__dbt_tmp'
        
        and table_schema ilike 'SRC_test_vlt'
        
        
        and table_catalog ilike 'DV_PROTOTYPE_DB'
        
      order by ordinal_position
2019-09-04 20:04:39,178 (Thread-1): SQL status: SUCCESS 4 in 0.67 seconds
2019-09-04 20:04:39,190 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-04 20:04:39,191 (Thread-1): On test_hub_customer: select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from
      DV_PROTOTYPE_DB.information_schema.columns

      where table_name ilike 'test_hub_customer'
        
        and table_schema ilike 'SRC_test_vlt'
        
        
        and table_catalog ilike 'DV_PROTOTYPE_DB'
        
      order by ordinal_position
2019-09-04 20:04:39,986 (Thread-1): SQL status: SUCCESS 4 in 0.80 seconds
2019-09-04 20:04:39,999 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-04 20:04:39,999 (Thread-1): On test_hub_customer: select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from
      DV_PROTOTYPE_DB.information_schema.columns

      where table_name ilike 'test_hub_customer'
        
        and table_schema ilike 'SRC_test_vlt'
        
        
        and table_catalog ilike 'DV_PROTOTYPE_DB'
        
      order by ordinal_position
2019-09-04 20:04:40,725 (Thread-1): SQL status: SUCCESS 4 in 0.73 seconds
2019-09-04 20:04:40,736 (Thread-1): Writing runtime SQL for node "model.snow_vault.test_hub_customer"
2019-09-04 20:04:40,736 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-04 20:04:40,736 (Thread-1): On test_hub_customer: insert into DV_PROTOTYPE_DB.SRC_test_vlt.test_hub_customer (CUSTOMER_PK, CUSTOMERKEY, LOADDATE, SOURCE)
        (
            select CUSTOMER_PK, CUSTOMERKEY, LOADDATE, SOURCE
            from DV_PROTOTYPE_DB.SRC_test_vlt.test_hub_customer__dbt_tmp
        );
2019-09-04 20:04:40,943 (Thread-1): SQL status: SUCCESS 0 in 0.21 seconds
2019-09-04 20:04:40,947 (Thread-1): On test_hub_customer: COMMIT
2019-09-04 20:04:40,947 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-04 20:04:40,947 (Thread-1): On test_hub_customer: COMMIT
2019-09-04 20:04:41,107 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2019-09-04 20:04:41,119 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d10123d-2480-44ba-b694-4e85f57b9063', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bb12fcc88>]}
2019-09-04 20:04:41,620 (Thread-1): 20:04:41 | 2 of 3 OK created incremental model SRC_test_vlt.test_hub_customer... [SUCCESS 0 in 3.23s]
2019-09-04 20:04:41,621 (Thread-1): 20:04:41 | 3 of 3 START incremental model SRC_VLT.hub_customer.................. [RUN]
2019-09-04 20:04:41,621 (Thread-1): Acquiring new snowflake connection "hub_customer".
2019-09-04 20:04:41,622 (Thread-1): Re-using an available connection from the pool (formerly test_hub_customer).
2019-09-04 20:04:41,622 (Thread-1): Compiling model.dbtTest.hub_customer
2019-09-04 20:04:41,627 (Thread-1): Writing injected SQL for node "model.dbtTest.hub_customer"
2019-09-04 20:04:41,631 (Thread-1): Using snowflake connection "hub_customer".
2019-09-04 20:04:41,631 (Thread-1): On hub_customer: BEGIN
2019-09-04 20:04:41,746 (Thread-1): SQL status: SUCCESS 1 in 0.12 seconds
2019-09-04 20:04:41,747 (Thread-1): Using snowflake connection "hub_customer".
2019-09-04 20:04:41,747 (Thread-1): On hub_customer: create or replace temporary table DV_PROTOTYPE_DB.SRC_VLT.hub_customer__dbt_tmp
  as (
    SELECT 
                CAST(CUSTOMER_PK AS BINARY(16)) AS CUSTOMER_PK,
                CAST(CUSTOMERKEY AS NUMBER(38,0)) AS CUSTOMERKEY,
                CAST(SOURCE AS VARCHAR(4)) AS SOURCE,
                CAST(LOADDATE AS DATE) AS LOADDATE
 FROM (
  SELECT DISTINCT CUSTOMER_PK, CUSTOMERKEY, SOURCE, LOADDATE
  FROM
    (SELECT a.CUSTOMER_PK, a.CUSTOMERKEY, a.SOURCE, a.LOADDATE,
           lag(b.LOADDATE, 1) over(partition by CUSTOMER_PK order by b.LOADDATE) as FIRST_SEEN
    FROM DV_PROTOTYPE_DB.SRC_STG.stg_orders_hashed AS a
    LEFT JOIN DV_PROTOTYPE_DB.SRC_VLT.hub_customer AS c
    ON a.CUSTOMER_PK = c.CUSTOMER_PK
    AND c.CUSTOMER_PK IS NULL
    )
 AS b)
AS stg
WHERE stg.CUSTOMER_PK NOT IN (SELECT CUSTOMER_PK FROM DV_PROTOTYPE_DB.SRC_VLT.hub_customer)
  );
2019-09-04 20:04:42,000 (Thread-1): Snowflake error: 000904 (42000): 018eaad8-0031-c7e0-0000-28a50002f03e: SQL compilation error: error line 12 at position 15
invalid identifier 'B.LOADDATE'
2019-09-04 20:04:42,000 (Thread-1): On hub_customer: ROLLBACK
2019-09-04 20:04:42,201 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d10123d-2480-44ba-b694-4e85f57b9063', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bb111e1d0>]}
2019-09-04 20:04:42,720 (Thread-1): 20:04:42 | 3 of 3 ERROR creating incremental model SRC_VLT.hub_customer......... [ERROR in 0.58s]
2019-09-04 20:04:42,755 (MainThread): Using snowflake connection "master".
2019-09-04 20:04:42,755 (MainThread): On master: BEGIN
2019-09-04 20:04:42,863 (MainThread): SQL status: SUCCESS 1 in 0.11 seconds
2019-09-04 20:04:42,864 (MainThread): On master: COMMIT
2019-09-04 20:04:42,864 (MainThread): Using snowflake connection "master".
2019-09-04 20:04:42,864 (MainThread): On master: COMMIT
2019-09-04 20:04:42,995 (MainThread): SQL status: SUCCESS 1 in 0.13 seconds
2019-09-04 20:04:42,996 (MainThread): 20:04:42 | 
2019-09-04 20:04:42,996 (MainThread): 20:04:42 | Finished running 1 table models, 2 incremental models in 11.70s.
2019-09-04 20:04:42,996 (MainThread): Connection 'master' was left open.
2019-09-04 20:04:42,997 (MainThread): On master: Close
2019-09-04 20:04:43,186 (MainThread): Connection 'hub_customer' was left open.
2019-09-04 20:04:43,187 (MainThread): On hub_customer: Close
2019-09-04 20:04:43,344 (MainThread): 
2019-09-04 20:04:43,344 (MainThread): Completed with 1 errors:
2019-09-04 20:04:43,345 (MainThread): 
2019-09-04 20:04:43,345 (MainThread): Database Error in model hub_customer (models/hub_sat_link_load/hub_customer.sql)
2019-09-04 20:04:43,345 (MainThread):   000904 (42000): 018eaad8-0031-c7e0-0000-28a50002f03e: SQL compilation error: error line 12 at position 15
2019-09-04 20:04:43,345 (MainThread):   invalid identifier 'B.LOADDATE'
2019-09-04 20:04:43,345 (MainThread):   compiled SQL at target/compiled/dbtTest/hub_sat_link_load/hub_customer.sql
2019-09-04 20:04:43,346 (MainThread): 
Done. PASS=2 ERROR=1 SKIP=0 TOTAL=3
2019-09-04 20:04:43,346 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bb11a94a8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bb54884e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bb12deb70>]}
2019-09-04 20:04:43,872 (MainThread): Flushing usage events
2019-09-04 20:05:13,518 (MainThread): Tracking: tracking
2019-09-04 20:05:13,518 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb1c0e3b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb1c0e3fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb1c07d5c0>]}
2019-09-04 20:05:14,197 (MainThread): Parsing macros/core.sql
2019-09-04 20:05:14,200 (MainThread): Parsing macros/adapters/common.sql
2019-09-04 20:05:14,217 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-09-04 20:05:14,218 (MainThread): Parsing macros/schema_tests/unique.sql
2019-09-04 20:05:14,219 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-09-04 20:05:14,219 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-09-04 20:05:14,220 (MainThread): Parsing macros/materializations/helpers.sql
2019-09-04 20:05:14,224 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-09-04 20:05:14,227 (MainThread): Parsing macros/materializations/view/view.sql
2019-09-04 20:05:14,229 (MainThread): Parsing macros/materializations/table/table.sql
2019-09-04 20:05:14,232 (MainThread): Parsing macros/materializations/common/merge.sql
2019-09-04 20:05:14,236 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2019-09-04 20:05:14,246 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2019-09-04 20:05:14,252 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2019-09-04 20:05:14,253 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-09-04 20:05:14,261 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-09-04 20:05:14,265 (MainThread): Parsing macros/etc/is_incremental.sql
2019-09-04 20:05:14,266 (MainThread): Parsing macros/etc/get_relation_comment.sql
2019-09-04 20:05:14,267 (MainThread): Parsing macros/etc/datetime.sql
2019-09-04 20:05:14,271 (MainThread): Parsing macros/etc/get_custom_alias.sql
2019-09-04 20:05:14,272 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-09-04 20:05:14,273 (MainThread): Parsing macros/etc/query.sql
2019-09-04 20:05:14,274 (MainThread): Parsing macros/adapters.sql
2019-09-04 20:05:14,278 (MainThread): Parsing macros/catalog.sql
2019-09-04 20:05:14,280 (MainThread): Parsing macros/materializations/incremental.sql
2019-09-04 20:05:14,283 (MainThread): Parsing macros/materializations/merge.sql
2019-09-04 20:05:14,284 (MainThread): Parsing macros/materializations/view.sql
2019-09-04 20:05:14,285 (MainThread): Parsing macros/materializations/table.sql
2019-09-04 20:05:14,287 (MainThread): Parsing macros/sat_template.sql
2019-09-04 20:05:14,287 (MainThread): Parsing macros/hub_template.sql
2019-09-04 20:05:14,289 (MainThread): Parsing macros/link_template.sql
2019-09-04 20:05:14,289 (MainThread): Parsing macros/utility/md5_binary.sql
2019-09-04 20:05:14,290 (MainThread): Parsing macros/utility/cast.sql
2019-09-04 20:05:14,291 (MainThread): Parsing macros/utility/union.sql
2019-09-04 20:05:14,293 (MainThread): Parsing macros/utility/prefix.sql
2019-09-04 20:05:14,302 (MainThread): Parsing model.dbtTest.hub_customer
2019-09-04 20:05:14,302 (MainThread): Acquiring new snowflake connection "hub_customer".
2019-09-04 20:05:14,302 (MainThread): Opening a new connection, currently in state init
2019-09-04 20:05:14,550 (MainThread): /home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/snowflake/connector/ocsp_asn1crypto.py:83: ResourceWarning: unclosed file <_io.BufferedReader name='/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/botocore/vendored/requests/cacert.pem'>

2019-09-04 20:05:14,558 (MainThread): /home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/snowflake/connector/ocsp_asn1crypto.py:83: ResourceWarning: unclosed file <_io.BufferedReader name='/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/certifi/cacert.pem'>

2019-09-04 20:05:14,968 (MainThread): Parsing model.dbtTest.stg_orders_hashed
2019-09-04 20:05:14,969 (MainThread): Acquiring new snowflake connection "stg_orders_hashed".
2019-09-04 20:05:14,969 (MainThread): Re-using an available connection from the pool (formerly hub_customer).
2019-09-04 20:05:14,980 (MainThread): Parsing model.snow_vault.test_sat_hub_customer
2019-09-04 20:05:14,980 (MainThread): Acquiring new snowflake connection "test_sat_hub_customer".
2019-09-04 20:05:14,980 (MainThread): Re-using an available connection from the pool (formerly stg_orders_hashed).
2019-09-04 20:05:14,983 (MainThread): Parsing model.snow_vault.test_source
2019-09-04 20:05:14,984 (MainThread): Acquiring new snowflake connection "test_source".
2019-09-04 20:05:14,984 (MainThread): Re-using an available connection from the pool (formerly test_sat_hub_customer).
2019-09-04 20:05:14,988 (MainThread): Parsing model.snow_vault.test_link_customer_nation
2019-09-04 20:05:14,988 (MainThread): Acquiring new snowflake connection "test_link_customer_nation".
2019-09-04 20:05:14,988 (MainThread): Re-using an available connection from the pool (formerly test_source).
2019-09-04 20:05:14,991 (MainThread): Parsing model.snow_vault.test_stg
2019-09-04 20:05:14,991 (MainThread): Acquiring new snowflake connection "test_stg".
2019-09-04 20:05:14,991 (MainThread): Re-using an available connection from the pool (formerly test_link_customer_nation).
2019-09-04 20:05:14,994 (MainThread): Parsing model.snow_vault.test_hub_customer
2019-09-04 20:05:14,995 (MainThread): Acquiring new snowflake connection "test_hub_customer".
2019-09-04 20:05:14,995 (MainThread): Re-using an available connection from the pool (formerly test_stg).
2019-09-04 20:05:15,011 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 123 macros, 0 operations, 0 seed files, 0 sources
2019-09-04 20:05:15,011 (MainThread): 
2019-09-04 20:05:15,011 (MainThread): Acquiring new snowflake connection "master".
2019-09-04 20:05:15,011 (MainThread): Re-using an available connection from the pool (formerly test_hub_customer).
2019-09-04 20:05:15,018 (MainThread): Parsing macros/core.sql
2019-09-04 20:05:15,020 (MainThread): Parsing macros/adapters/common.sql
2019-09-04 20:05:15,038 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-09-04 20:05:15,039 (MainThread): Parsing macros/schema_tests/unique.sql
2019-09-04 20:05:15,039 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-09-04 20:05:15,040 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-09-04 20:05:15,041 (MainThread): Parsing macros/materializations/helpers.sql
2019-09-04 20:05:15,045 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-09-04 20:05:15,047 (MainThread): Parsing macros/materializations/view/view.sql
2019-09-04 20:05:15,050 (MainThread): Parsing macros/materializations/table/table.sql
2019-09-04 20:05:15,053 (MainThread): Parsing macros/materializations/common/merge.sql
2019-09-04 20:05:15,057 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2019-09-04 20:05:15,066 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2019-09-04 20:05:15,073 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2019-09-04 20:05:15,074 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-09-04 20:05:15,082 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-09-04 20:05:15,086 (MainThread): Parsing macros/etc/is_incremental.sql
2019-09-04 20:05:15,086 (MainThread): Parsing macros/etc/get_relation_comment.sql
2019-09-04 20:05:15,088 (MainThread): Parsing macros/etc/datetime.sql
2019-09-04 20:05:15,111 (MainThread): Parsing macros/etc/get_custom_alias.sql
2019-09-04 20:05:15,112 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-09-04 20:05:15,113 (MainThread): Parsing macros/etc/query.sql
2019-09-04 20:05:15,114 (MainThread): Parsing macros/adapters.sql
2019-09-04 20:05:15,118 (MainThread): Parsing macros/catalog.sql
2019-09-04 20:05:15,119 (MainThread): Parsing macros/materializations/incremental.sql
2019-09-04 20:05:15,123 (MainThread): Parsing macros/materializations/merge.sql
2019-09-04 20:05:15,124 (MainThread): Parsing macros/materializations/view.sql
2019-09-04 20:05:15,124 (MainThread): Parsing macros/materializations/table.sql
2019-09-04 20:05:15,173 (MainThread): Using snowflake connection "master".
2019-09-04 20:05:15,174 (MainThread): On master: select distinct schema_name
    from DV_PROTOTYPE_DB.information_schema.schemata
    where catalog_name ilike 'DV_PROTOTYPE_DB'
2019-09-04 20:05:15,739 (MainThread): SQL status: SUCCESS 8 in 0.57 seconds
2019-09-04 20:05:15,760 (MainThread): Creating schema "DV_PROTOTYPE_DB"."SRC_test_vlt".
2019-09-04 20:05:15,767 (MainThread): Using snowflake connection "master".
2019-09-04 20:05:15,767 (MainThread): On master: BEGIN
2019-09-04 20:05:15,873 (MainThread): SQL status: SUCCESS 1 in 0.11 seconds
2019-09-04 20:05:15,874 (MainThread): Using snowflake connection "master".
2019-09-04 20:05:15,874 (MainThread): On master: create schema if not exists DV_PROTOTYPE_DB.SRC_test_vlt
2019-09-04 20:05:15,995 (MainThread): SQL status: SUCCESS 1 in 0.12 seconds
2019-09-04 20:05:15,998 (MainThread): On master: COMMIT
2019-09-04 20:05:15,998 (MainThread): Using snowflake connection "master".
2019-09-04 20:05:15,999 (MainThread): On master: COMMIT
2019-09-04 20:05:16,309 (MainThread): SQL status: SUCCESS 1 in 0.31 seconds
2019-09-04 20:05:16,321 (MainThread): Using snowflake connection "master".
2019-09-04 20:05:16,321 (MainThread): On master: BEGIN
2019-09-04 20:05:16,417 (MainThread): SQL status: SUCCESS 1 in 0.10 seconds
2019-09-04 20:05:16,418 (MainThread): Using snowflake connection "master".
2019-09-04 20:05:16,419 (MainThread): On master: select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'externaltable'
           else table_type
      end as table_type
    from DV_PROTOTYPE_DB.information_schema.tables
    where table_schema ilike 'src_test_vlt'
      and table_catalog ilike 'dv_prototype_db'
2019-09-04 20:05:17,113 (MainThread): SQL status: SUCCESS 3 in 0.69 seconds
2019-09-04 20:05:17,118 (MainThread): Using snowflake connection "master".
2019-09-04 20:05:17,119 (MainThread): On master: select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'externaltable'
           else table_type
      end as table_type
    from DV_PROTOTYPE_DB.information_schema.tables
    where table_schema ilike 'src_vlt'
      and table_catalog ilike 'dv_prototype_db'
2019-09-04 20:05:17,908 (MainThread): SQL status: SUCCESS 29 in 0.79 seconds
2019-09-04 20:05:17,958 (MainThread): Using snowflake connection "master".
2019-09-04 20:05:17,958 (MainThread): On master: select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'externaltable'
           else table_type
      end as table_type
    from DV_PROTOTYPE_DB.information_schema.tables
    where table_schema ilike 'src_stg'
      and table_catalog ilike 'dv_prototype_db'
2019-09-04 20:05:18,672 (MainThread): SQL status: SUCCESS 6 in 0.71 seconds
2019-09-04 20:05:18,677 (MainThread): On master: ROLLBACK
2019-09-04 20:05:18,799 (MainThread): Using snowflake connection "master".
2019-09-04 20:05:18,800 (MainThread): On master: BEGIN
2019-09-04 20:05:18,900 (MainThread): SQL status: SUCCESS 1 in 0.10 seconds
2019-09-04 20:05:18,901 (MainThread): On master: COMMIT
2019-09-04 20:05:18,901 (MainThread): Using snowflake connection "master".
2019-09-04 20:05:18,902 (MainThread): On master: COMMIT
2019-09-04 20:05:19,054 (MainThread): SQL status: SUCCESS 1 in 0.15 seconds
2019-09-04 20:05:19,056 (MainThread): 20:05:19 | Concurrency: 1 threads (target='dev')
2019-09-04 20:05:19,056 (MainThread): 20:05:19 | 
2019-09-04 20:05:19,059 (Thread-1): 20:05:19 | 1 of 3 START table model SRC_STG.stg_orders_hashed................... [RUN]
2019-09-04 20:05:19,060 (Thread-1): Acquiring new snowflake connection "stg_orders_hashed".
2019-09-04 20:05:19,060 (Thread-1): Opening a new connection, currently in state init
2019-09-04 20:05:19,575 (Thread-1): Compiling model.dbtTest.stg_orders_hashed
2019-09-04 20:05:19,612 (Thread-1): Writing injected SQL for node "model.dbtTest.stg_orders_hashed"
2019-09-04 20:05:19,633 (Thread-1): Writing runtime SQL for node "model.dbtTest.stg_orders_hashed"
2019-09-04 20:05:19,636 (Thread-1): Using snowflake connection "stg_orders_hashed".
2019-09-04 20:05:19,636 (Thread-1): On stg_orders_hashed: BEGIN
2019-09-04 20:05:19,747 (Thread-1): SQL status: SUCCESS 1 in 0.11 seconds
2019-09-04 20:05:19,748 (Thread-1): Using snowflake connection "stg_orders_hashed".
2019-09-04 20:05:19,748 (Thread-1): On stg_orders_hashed: create or replace transient table DV_PROTOTYPE_DB.SRC_STG.stg_orders_hashed
  as (
    

select
CAST(MD5_BINARY(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR)))) AS BINARY(16)) AS ORDER_PK,
CAST(MD5_BINARY(UPPER(TRIM(CAST(PARTKEY AS VARCHAR)))) AS BINARY(16)) AS PART_PK,
CAST(MD5_BINARY(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR)))) AS BINARY(16)) AS SUPPLIER_PK,
CAST(MD5_BINARY(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR)))) AS BINARY(16)) AS LINEITEM_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS INVENTORY_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS INVENTORY_ALLOCATION_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(COMMITDATE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(DISCOUNT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(EXTENDEDPRICE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(LINESTATUS AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(LINE_COMMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(QUANTITY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(RECEIPTDATE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(RETURNFLAG AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SHIPDATE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SHIPINSTRUCT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SHIPMODE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(TAX AS VARCHAR))), '^^') )) AS BINARY(16)) AS LINEITEM_HASHDIFF,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS LINEITEM_ORDER_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CLERK AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDERDATE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDERPRIORITY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDERSTATUS AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDER_COMMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SHIPPRIORITY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(TOTALPRICE AS VARCHAR))), '^^') )) AS BINARY(16)) AS ORDER_HASHDIFF,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS ORDER_CUSTOMER_PK,
CAST(MD5_BINARY(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR)))) AS BINARY(16)) AS CUSTOMER_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_NATIONKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS LINK_CUSTOMER_NATION_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMER_ACCBAL AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_COMMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_MKTSEGMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_NAME AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_PHONE AS VARCHAR))), '^^') )) AS BINARY(16)) AS CUSTOMER_HASHDIFF,
CAST(MD5_BINARY(UPPER(TRIM(CAST(CUSTOMER_NATIONKEY AS VARCHAR)))) AS BINARY(16)) AS CUSTOMER_NATION_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMER_NATION_COMMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_NATION_NAME AS VARCHAR))), '^^') )) AS BINARY(16)) AS CUSTOMER_NATION_HASHDIFF,
CAST(MD5_BINARY(UPPER(TRIM(CAST(CUSTOMER_REGIONKEY AS VARCHAR)))) AS BINARY(16)) AS CUSTOMER_REGION_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMER_NATIONKEY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_REGIONKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS CUSTOMER_NATION_REGION_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMER_REGION_COMMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_REGION_NAME AS VARCHAR))), '^^') )) AS BINARY(16)) AS CUSTOMER_REGION_HASHDIFF,
 *, TO_DATE('1992-01-08') AS LOADDATE, TO_DATE('1992-01-08') AS EFFECTIVE_FROM, 'TPCH' AS SOURCE FROM DV_PROTOTYPE_DB.SRC_STG.V_SRC_STG_ORDERS
  );
2019-09-04 20:05:20,618 (Thread-1): SQL status: SUCCESS 1 in 0.87 seconds
2019-09-04 20:05:20,621 (Thread-1): On stg_orders_hashed: COMMIT
2019-09-04 20:05:20,621 (Thread-1): Using snowflake connection "stg_orders_hashed".
2019-09-04 20:05:20,621 (Thread-1): On stg_orders_hashed: COMMIT
2019-09-04 20:05:20,706 (Thread-1): SQL status: SUCCESS 1 in 0.08 seconds
2019-09-04 20:05:20,718 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f5fba8e-96a0-4b9f-af27-9dec60118b38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb3c50c7f0>]}
2019-09-04 20:05:21,221 (Thread-1): 20:05:21 | 1 of 3 OK created table model SRC_STG.stg_orders_hashed.............. [SUCCESS 1 in 1.66s]
2019-09-04 20:05:21,221 (Thread-1): 20:05:21 | 2 of 3 START incremental model SRC_test_vlt.test_hub_customer........ [RUN]
2019-09-04 20:05:21,223 (Thread-1): Acquiring new snowflake connection "test_hub_customer".
2019-09-04 20:05:21,223 (Thread-1): Re-using an available connection from the pool (formerly stg_orders_hashed).
2019-09-04 20:05:21,223 (Thread-1): Compiling model.snow_vault.test_hub_customer
2019-09-04 20:05:21,225 (Thread-1): Writing injected SQL for node "model.snow_vault.test_hub_customer"
2019-09-04 20:05:21,237 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-04 20:05:21,237 (Thread-1): On test_hub_customer: BEGIN
2019-09-04 20:05:21,338 (Thread-1): SQL status: SUCCESS 1 in 0.10 seconds
2019-09-04 20:05:21,339 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-04 20:05:21,339 (Thread-1): On test_hub_customer: create or replace temporary table DV_PROTOTYPE_DB.SRC_test_vlt.test_hub_customer__dbt_tmp
  as (
    

SELECT
                CAST(CUSTOMER_PK AS BINARY(16)) AS CUSTOMER_PK,
                CAST(CUSTOMERKEY AS NUMBER(38,0)) AS CUSTOMERKEY,
                CAST(SOURCE AS VARCHAR(4)) AS SOURCE,
                CAST(LOADDATE AS DATE) AS LOADDATE

 FROM (
  SELECT DISTINCT CUSTOMER_PK, CUSTOMERKEY, SOURCE, LOADDATE
  FROM
    (SELECT DISTINCT a.CUSTOMER_PK, a.CUSTOMERKEY, a.SOURCE, a.LOADDATE
    FROM DV_PROTOTYPE_DB.SRC_TEST_STG.STG_CUSTOMER AS a
    LEFT JOIN DV_PROTOTYPE_DB.SRC_test_vlt.test_hub_customer AS c
    ON a.CUSTOMER_PK = c.CUSTOMER_PK
    AND c.CUSTOMER_PK IS NULL)
 AS b)
AS stg
WHERE stg.CUSTOMER_PK NOT IN (SELECT CUSTOMER_PK FROM DV_PROTOTYPE_DB.SRC_test_vlt.test_hub_customer)
  );
2019-09-04 20:05:21,810 (Thread-1): SQL status: SUCCESS 1 in 0.47 seconds
2019-09-04 20:05:21,815 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-04 20:05:21,815 (Thread-1): On test_hub_customer: select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from
      DV_PROTOTYPE_DB.information_schema.columns

      where table_name ilike 'test_hub_customer__dbt_tmp'
        
        and table_schema ilike 'SRC_test_vlt'
        
        
        and table_catalog ilike 'DV_PROTOTYPE_DB'
        
      order by ordinal_position
2019-09-04 20:05:22,466 (Thread-1): SQL status: SUCCESS 4 in 0.65 seconds
2019-09-04 20:05:22,471 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-04 20:05:22,471 (Thread-1): On test_hub_customer: select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from
      DV_PROTOTYPE_DB.information_schema.columns

      where table_name ilike 'test_hub_customer'
        
        and table_schema ilike 'SRC_test_vlt'
        
        
        and table_catalog ilike 'DV_PROTOTYPE_DB'
        
      order by ordinal_position
2019-09-04 20:05:23,185 (Thread-1): SQL status: SUCCESS 4 in 0.71 seconds
2019-09-04 20:05:23,190 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-04 20:05:23,190 (Thread-1): On test_hub_customer: select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from
      DV_PROTOTYPE_DB.information_schema.columns

      where table_name ilike 'test_hub_customer'
        
        and table_schema ilike 'SRC_test_vlt'
        
        
        and table_catalog ilike 'DV_PROTOTYPE_DB'
        
      order by ordinal_position
2019-09-04 20:05:23,859 (Thread-1): SQL status: SUCCESS 4 in 0.67 seconds
2019-09-04 20:05:23,869 (Thread-1): Writing runtime SQL for node "model.snow_vault.test_hub_customer"
2019-09-04 20:05:23,870 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-04 20:05:23,870 (Thread-1): On test_hub_customer: insert into DV_PROTOTYPE_DB.SRC_test_vlt.test_hub_customer (CUSTOMER_PK, CUSTOMERKEY, LOADDATE, SOURCE)
        (
            select CUSTOMER_PK, CUSTOMERKEY, LOADDATE, SOURCE
            from DV_PROTOTYPE_DB.SRC_test_vlt.test_hub_customer__dbt_tmp
        );
2019-09-04 20:05:24,122 (Thread-1): SQL status: SUCCESS 0 in 0.25 seconds
2019-09-04 20:05:24,125 (Thread-1): On test_hub_customer: COMMIT
2019-09-04 20:05:24,126 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-04 20:05:24,126 (Thread-1): On test_hub_customer: COMMIT
2019-09-04 20:05:24,263 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2019-09-04 20:05:24,275 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f5fba8e-96a0-4b9f-af27-9dec60118b38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb3c50cbe0>]}
2019-09-04 20:05:24,776 (Thread-1): 20:05:24 | 2 of 3 OK created incremental model SRC_test_vlt.test_hub_customer... [SUCCESS 0 in 3.05s]
2019-09-04 20:05:24,777 (Thread-1): 20:05:24 | 3 of 3 START incremental model SRC_VLT.hub_customer.................. [RUN]
2019-09-04 20:05:24,777 (Thread-1): Acquiring new snowflake connection "hub_customer".
2019-09-04 20:05:24,777 (Thread-1): Re-using an available connection from the pool (formerly test_hub_customer).
2019-09-04 20:05:24,777 (Thread-1): Compiling model.dbtTest.hub_customer
2019-09-04 20:05:24,783 (Thread-1): Writing injected SQL for node "model.dbtTest.hub_customer"
2019-09-04 20:05:24,787 (Thread-1): Using snowflake connection "hub_customer".
2019-09-04 20:05:24,787 (Thread-1): On hub_customer: BEGIN
2019-09-04 20:05:24,894 (Thread-1): SQL status: SUCCESS 1 in 0.11 seconds
2019-09-04 20:05:24,895 (Thread-1): Using snowflake connection "hub_customer".
2019-09-04 20:05:24,896 (Thread-1): On hub_customer: create or replace temporary table DV_PROTOTYPE_DB.SRC_VLT.hub_customer__dbt_tmp
  as (
    SELECT 
                CAST(CUSTOMER_PK AS BINARY(16)) AS CUSTOMER_PK,
                CAST(CUSTOMERKEY AS NUMBER(38,0)) AS CUSTOMERKEY,
                CAST(SOURCE AS VARCHAR(4)) AS SOURCE,
                CAST(LOADDATE AS DATE) AS LOADDATE
 FROM (
  SELECT DISTINCT CUSTOMER_PK, CUSTOMERKEY, SOURCE, LOADDATE
  FROM
    (SELECT a.CUSTOMER_PK, a.CUSTOMERKEY, a.SOURCE, a.LOADDATE,
           lag(c.LOADDATE, 1) over(partition by CUSTOMER_PK order by c.LOADDATE) as FIRST_SEEN
    FROM DV_PROTOTYPE_DB.SRC_STG.stg_orders_hashed AS a
    LEFT JOIN DV_PROTOTYPE_DB.SRC_VLT.hub_customer AS c
    ON a.CUSTOMER_PK = c.CUSTOMER_PK
    AND c.CUSTOMER_PK IS NULL
    )
 AS b)
AS stg
WHERE stg.CUSTOMER_PK NOT IN (SELECT CUSTOMER_PK FROM DV_PROTOTYPE_DB.SRC_VLT.hub_customer)
  );
2019-09-04 20:05:25,139 (Thread-1): Snowflake error: 002028 (42601): 018eaad9-0032-36d9-0000-28a50002f056: SQL compilation error:
ambiguous column name 'CUSTOMER_PK'
2019-09-04 20:05:25,139 (Thread-1): On hub_customer: ROLLBACK
2019-09-04 20:05:25,303 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f5fba8e-96a0-4b9f-af27-9dec60118b38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb3c5c2208>]}
2019-09-04 20:05:25,792 (Thread-1): 20:05:25 | 3 of 3 ERROR creating incremental model SRC_VLT.hub_customer......... [ERROR in 0.52s]
2019-09-04 20:05:25,887 (MainThread): Using snowflake connection "master".
2019-09-04 20:05:25,888 (MainThread): On master: BEGIN
2019-09-04 20:05:26,041 (MainThread): SQL status: SUCCESS 1 in 0.15 seconds
2019-09-04 20:05:26,042 (MainThread): On master: COMMIT
2019-09-04 20:05:26,042 (MainThread): Using snowflake connection "master".
2019-09-04 20:05:26,042 (MainThread): On master: COMMIT
2019-09-04 20:05:26,182 (MainThread): SQL status: SUCCESS 1 in 0.14 seconds
2019-09-04 20:05:26,183 (MainThread): 20:05:26 | 
2019-09-04 20:05:26,183 (MainThread): 20:05:26 | Finished running 1 table models, 2 incremental models in 11.17s.
2019-09-04 20:05:26,183 (MainThread): Connection 'master' was left open.
2019-09-04 20:05:26,184 (MainThread): On master: Close
2019-09-04 20:05:26,319 (MainThread): Connection 'hub_customer' was left open.
2019-09-04 20:05:26,320 (MainThread): On hub_customer: Close
2019-09-04 20:05:26,484 (MainThread): 
2019-09-04 20:05:26,485 (MainThread): Completed with 1 errors:
2019-09-04 20:05:26,485 (MainThread): 
2019-09-04 20:05:26,485 (MainThread): Database Error in model hub_customer (models/hub_sat_link_load/hub_customer.sql)
2019-09-04 20:05:26,485 (MainThread):   002028 (42601): 018eaad9-0032-36d9-0000-28a50002f056: SQL compilation error:
2019-09-04 20:05:26,486 (MainThread):   ambiguous column name 'CUSTOMER_PK'
2019-09-04 20:05:26,486 (MainThread):   compiled SQL at target/compiled/dbtTest/hub_sat_link_load/hub_customer.sql
2019-09-04 20:05:26,486 (MainThread): 
Done. PASS=2 ERROR=1 SKIP=0 TOTAL=3
2019-09-04 20:05:26,486 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb42f9c828>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb42f9c860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb42f9c7f0>]}
2019-09-04 20:05:26,974 (MainThread): Flushing usage events
2019-09-04 20:05:57,845 (MainThread): Tracking: tracking
2019-09-04 20:05:57,846 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f816a861ac8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f816a861f98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f816a7fb588>]}
2019-09-04 20:05:58,376 (MainThread): Parsing macros/core.sql
2019-09-04 20:05:58,378 (MainThread): Parsing macros/adapters/common.sql
2019-09-04 20:05:58,395 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-09-04 20:05:58,396 (MainThread): Parsing macros/schema_tests/unique.sql
2019-09-04 20:05:58,397 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-09-04 20:05:58,397 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-09-04 20:05:58,398 (MainThread): Parsing macros/materializations/helpers.sql
2019-09-04 20:05:58,402 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-09-04 20:05:58,405 (MainThread): Parsing macros/materializations/view/view.sql
2019-09-04 20:05:58,408 (MainThread): Parsing macros/materializations/table/table.sql
2019-09-04 20:05:58,411 (MainThread): Parsing macros/materializations/common/merge.sql
2019-09-04 20:05:58,414 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2019-09-04 20:05:58,424 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2019-09-04 20:05:58,430 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2019-09-04 20:05:58,431 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-09-04 20:05:58,439 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-09-04 20:05:58,443 (MainThread): Parsing macros/etc/is_incremental.sql
2019-09-04 20:05:58,444 (MainThread): Parsing macros/etc/get_relation_comment.sql
2019-09-04 20:05:58,445 (MainThread): Parsing macros/etc/datetime.sql
2019-09-04 20:05:58,450 (MainThread): Parsing macros/etc/get_custom_alias.sql
2019-09-04 20:05:58,450 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-09-04 20:05:58,452 (MainThread): Parsing macros/etc/query.sql
2019-09-04 20:05:58,453 (MainThread): Parsing macros/adapters.sql
2019-09-04 20:05:58,457 (MainThread): Parsing macros/catalog.sql
2019-09-04 20:05:58,458 (MainThread): Parsing macros/materializations/incremental.sql
2019-09-04 20:05:58,462 (MainThread): Parsing macros/materializations/merge.sql
2019-09-04 20:05:58,463 (MainThread): Parsing macros/materializations/view.sql
2019-09-04 20:05:58,463 (MainThread): Parsing macros/materializations/table.sql
2019-09-04 20:05:58,465 (MainThread): Parsing macros/sat_template.sql
2019-09-04 20:05:58,466 (MainThread): Parsing macros/hub_template.sql
2019-09-04 20:05:58,467 (MainThread): Parsing macros/link_template.sql
2019-09-04 20:05:58,467 (MainThread): Parsing macros/utility/md5_binary.sql
2019-09-04 20:05:58,468 (MainThread): Parsing macros/utility/cast.sql
2019-09-04 20:05:58,470 (MainThread): Parsing macros/utility/union.sql
2019-09-04 20:05:58,471 (MainThread): Parsing macros/utility/prefix.sql
2019-09-04 20:05:58,479 (MainThread): Parsing model.dbtTest.hub_customer
2019-09-04 20:05:58,479 (MainThread): Acquiring new snowflake connection "hub_customer".
2019-09-04 20:05:58,479 (MainThread): Opening a new connection, currently in state init
2019-09-04 20:05:58,754 (MainThread): /home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/snowflake/connector/ocsp_asn1crypto.py:83: ResourceWarning: unclosed file <_io.BufferedReader name='/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/botocore/vendored/requests/cacert.pem'>

2019-09-04 20:05:58,762 (MainThread): /home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/snowflake/connector/ocsp_asn1crypto.py:83: ResourceWarning: unclosed file <_io.BufferedReader name='/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/certifi/cacert.pem'>

2019-09-04 20:05:59,157 (MainThread): Parsing model.dbtTest.stg_orders_hashed
2019-09-04 20:05:59,157 (MainThread): Acquiring new snowflake connection "stg_orders_hashed".
2019-09-04 20:05:59,157 (MainThread): Re-using an available connection from the pool (formerly hub_customer).
2019-09-04 20:05:59,169 (MainThread): Parsing model.snow_vault.test_sat_hub_customer
2019-09-04 20:05:59,169 (MainThread): Acquiring new snowflake connection "test_sat_hub_customer".
2019-09-04 20:05:59,169 (MainThread): Re-using an available connection from the pool (formerly stg_orders_hashed).
2019-09-04 20:05:59,172 (MainThread): Parsing model.snow_vault.test_source
2019-09-04 20:05:59,172 (MainThread): Acquiring new snowflake connection "test_source".
2019-09-04 20:05:59,173 (MainThread): Re-using an available connection from the pool (formerly test_sat_hub_customer).
2019-09-04 20:05:59,177 (MainThread): Parsing model.snow_vault.test_link_customer_nation
2019-09-04 20:05:59,177 (MainThread): Acquiring new snowflake connection "test_link_customer_nation".
2019-09-04 20:05:59,177 (MainThread): Re-using an available connection from the pool (formerly test_source).
2019-09-04 20:05:59,180 (MainThread): Parsing model.snow_vault.test_stg
2019-09-04 20:05:59,180 (MainThread): Acquiring new snowflake connection "test_stg".
2019-09-04 20:05:59,180 (MainThread): Re-using an available connection from the pool (formerly test_link_customer_nation).
2019-09-04 20:05:59,183 (MainThread): Parsing model.snow_vault.test_hub_customer
2019-09-04 20:05:59,183 (MainThread): Acquiring new snowflake connection "test_hub_customer".
2019-09-04 20:05:59,183 (MainThread): Re-using an available connection from the pool (formerly test_stg).
2019-09-04 20:05:59,199 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 123 macros, 0 operations, 0 seed files, 0 sources
2019-09-04 20:05:59,200 (MainThread): 
2019-09-04 20:05:59,200 (MainThread): Acquiring new snowflake connection "master".
2019-09-04 20:05:59,200 (MainThread): Re-using an available connection from the pool (formerly test_hub_customer).
2019-09-04 20:05:59,207 (MainThread): Parsing macros/core.sql
2019-09-04 20:05:59,209 (MainThread): Parsing macros/adapters/common.sql
2019-09-04 20:05:59,226 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-09-04 20:05:59,227 (MainThread): Parsing macros/schema_tests/unique.sql
2019-09-04 20:05:59,228 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-09-04 20:05:59,228 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-09-04 20:05:59,229 (MainThread): Parsing macros/materializations/helpers.sql
2019-09-04 20:05:59,233 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-09-04 20:05:59,236 (MainThread): Parsing macros/materializations/view/view.sql
2019-09-04 20:05:59,238 (MainThread): Parsing macros/materializations/table/table.sql
2019-09-04 20:05:59,241 (MainThread): Parsing macros/materializations/common/merge.sql
2019-09-04 20:05:59,245 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2019-09-04 20:05:59,255 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2019-09-04 20:05:59,261 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2019-09-04 20:05:59,262 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-09-04 20:05:59,270 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-09-04 20:05:59,274 (MainThread): Parsing macros/etc/is_incremental.sql
2019-09-04 20:05:59,275 (MainThread): Parsing macros/etc/get_relation_comment.sql
2019-09-04 20:05:59,276 (MainThread): Parsing macros/etc/datetime.sql
2019-09-04 20:05:59,299 (MainThread): Parsing macros/etc/get_custom_alias.sql
2019-09-04 20:05:59,300 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-09-04 20:05:59,301 (MainThread): Parsing macros/etc/query.sql
2019-09-04 20:05:59,302 (MainThread): Parsing macros/adapters.sql
2019-09-04 20:05:59,306 (MainThread): Parsing macros/catalog.sql
2019-09-04 20:05:59,308 (MainThread): Parsing macros/materializations/incremental.sql
2019-09-04 20:05:59,311 (MainThread): Parsing macros/materializations/merge.sql
2019-09-04 20:05:59,312 (MainThread): Parsing macros/materializations/view.sql
2019-09-04 20:05:59,313 (MainThread): Parsing macros/materializations/table.sql
2019-09-04 20:05:59,362 (MainThread): Using snowflake connection "master".
2019-09-04 20:05:59,362 (MainThread): On master: select distinct schema_name
    from DV_PROTOTYPE_DB.information_schema.schemata
    where catalog_name ilike 'DV_PROTOTYPE_DB'
2019-09-04 20:05:59,987 (MainThread): SQL status: SUCCESS 8 in 0.63 seconds
2019-09-04 20:05:59,993 (MainThread): Creating schema "DV_PROTOTYPE_DB"."SRC_test_vlt".
2019-09-04 20:05:59,995 (MainThread): Using snowflake connection "master".
2019-09-04 20:05:59,995 (MainThread): On master: BEGIN
2019-09-04 20:06:00,108 (MainThread): SQL status: SUCCESS 1 in 0.11 seconds
2019-09-04 20:06:00,109 (MainThread): Using snowflake connection "master".
2019-09-04 20:06:00,109 (MainThread): On master: create schema if not exists DV_PROTOTYPE_DB.SRC_test_vlt
2019-09-04 20:06:00,215 (MainThread): SQL status: SUCCESS 1 in 0.11 seconds
2019-09-04 20:06:00,218 (MainThread): On master: COMMIT
2019-09-04 20:06:00,218 (MainThread): Using snowflake connection "master".
2019-09-04 20:06:00,219 (MainThread): On master: COMMIT
2019-09-04 20:06:00,377 (MainThread): SQL status: SUCCESS 1 in 0.16 seconds
2019-09-04 20:06:00,421 (MainThread): Using snowflake connection "master".
2019-09-04 20:06:00,421 (MainThread): On master: BEGIN
2019-09-04 20:06:00,519 (MainThread): SQL status: SUCCESS 1 in 0.10 seconds
2019-09-04 20:06:00,520 (MainThread): Using snowflake connection "master".
2019-09-04 20:06:00,521 (MainThread): On master: select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'externaltable'
           else table_type
      end as table_type
    from DV_PROTOTYPE_DB.information_schema.tables
    where table_schema ilike 'src_vlt'
      and table_catalog ilike 'dv_prototype_db'
2019-09-04 20:06:01,120 (MainThread): SQL status: SUCCESS 29 in 0.60 seconds
2019-09-04 20:06:01,135 (MainThread): Using snowflake connection "master".
2019-09-04 20:06:01,135 (MainThread): On master: select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'externaltable'
           else table_type
      end as table_type
    from DV_PROTOTYPE_DB.information_schema.tables
    where table_schema ilike 'src_stg'
      and table_catalog ilike 'dv_prototype_db'
2019-09-04 20:06:01,772 (MainThread): SQL status: SUCCESS 6 in 0.64 seconds
2019-09-04 20:06:01,779 (MainThread): Using snowflake connection "master".
2019-09-04 20:06:01,779 (MainThread): On master: select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'externaltable'
           else table_type
      end as table_type
    from DV_PROTOTYPE_DB.information_schema.tables
    where table_schema ilike 'src_test_vlt'
      and table_catalog ilike 'dv_prototype_db'
2019-09-04 20:06:02,539 (MainThread): SQL status: SUCCESS 3 in 0.76 seconds
2019-09-04 20:06:02,544 (MainThread): On master: ROLLBACK
2019-09-04 20:06:02,675 (MainThread): Using snowflake connection "master".
2019-09-04 20:06:02,676 (MainThread): On master: BEGIN
2019-09-04 20:06:02,832 (MainThread): SQL status: SUCCESS 1 in 0.16 seconds
2019-09-04 20:06:02,833 (MainThread): On master: COMMIT
2019-09-04 20:06:02,833 (MainThread): Using snowflake connection "master".
2019-09-04 20:06:02,833 (MainThread): On master: COMMIT
2019-09-04 20:06:03,122 (MainThread): SQL status: SUCCESS 1 in 0.29 seconds
2019-09-04 20:06:03,123 (MainThread): 20:06:03 | Concurrency: 1 threads (target='dev')
2019-09-04 20:06:03,123 (MainThread): 20:06:03 | 
2019-09-04 20:06:03,126 (Thread-1): 20:06:03 | 1 of 3 START table model SRC_STG.stg_orders_hashed................... [RUN]
2019-09-04 20:06:03,128 (Thread-1): Acquiring new snowflake connection "stg_orders_hashed".
2019-09-04 20:06:03,128 (Thread-1): Opening a new connection, currently in state init
2019-09-04 20:06:03,762 (Thread-1): Compiling model.dbtTest.stg_orders_hashed
2019-09-04 20:06:03,801 (Thread-1): Writing injected SQL for node "model.dbtTest.stg_orders_hashed"
2019-09-04 20:06:03,822 (Thread-1): Writing runtime SQL for node "model.dbtTest.stg_orders_hashed"
2019-09-04 20:06:03,825 (Thread-1): Using snowflake connection "stg_orders_hashed".
2019-09-04 20:06:03,825 (Thread-1): On stg_orders_hashed: BEGIN
2019-09-04 20:06:03,940 (Thread-1): SQL status: SUCCESS 1 in 0.11 seconds
2019-09-04 20:06:03,940 (Thread-1): Using snowflake connection "stg_orders_hashed".
2019-09-04 20:06:03,940 (Thread-1): On stg_orders_hashed: create or replace transient table DV_PROTOTYPE_DB.SRC_STG.stg_orders_hashed
  as (
    

select
CAST(MD5_BINARY(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR)))) AS BINARY(16)) AS ORDER_PK,
CAST(MD5_BINARY(UPPER(TRIM(CAST(PARTKEY AS VARCHAR)))) AS BINARY(16)) AS PART_PK,
CAST(MD5_BINARY(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR)))) AS BINARY(16)) AS SUPPLIER_PK,
CAST(MD5_BINARY(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR)))) AS BINARY(16)) AS LINEITEM_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS INVENTORY_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS INVENTORY_ALLOCATION_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(COMMITDATE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(DISCOUNT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(EXTENDEDPRICE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(LINESTATUS AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(LINE_COMMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(QUANTITY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(RECEIPTDATE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(RETURNFLAG AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SHIPDATE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SHIPINSTRUCT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SHIPMODE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(TAX AS VARCHAR))), '^^') )) AS BINARY(16)) AS LINEITEM_HASHDIFF,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS LINEITEM_ORDER_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CLERK AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDERDATE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDERPRIORITY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDERSTATUS AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDER_COMMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SHIPPRIORITY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(TOTALPRICE AS VARCHAR))), '^^') )) AS BINARY(16)) AS ORDER_HASHDIFF,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS ORDER_CUSTOMER_PK,
CAST(MD5_BINARY(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR)))) AS BINARY(16)) AS CUSTOMER_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_NATIONKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS LINK_CUSTOMER_NATION_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMER_ACCBAL AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_COMMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_MKTSEGMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_NAME AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_PHONE AS VARCHAR))), '^^') )) AS BINARY(16)) AS CUSTOMER_HASHDIFF,
CAST(MD5_BINARY(UPPER(TRIM(CAST(CUSTOMER_NATIONKEY AS VARCHAR)))) AS BINARY(16)) AS CUSTOMER_NATION_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMER_NATION_COMMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_NATION_NAME AS VARCHAR))), '^^') )) AS BINARY(16)) AS CUSTOMER_NATION_HASHDIFF,
CAST(MD5_BINARY(UPPER(TRIM(CAST(CUSTOMER_REGIONKEY AS VARCHAR)))) AS BINARY(16)) AS CUSTOMER_REGION_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMER_NATIONKEY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_REGIONKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS CUSTOMER_NATION_REGION_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMER_REGION_COMMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_REGION_NAME AS VARCHAR))), '^^') )) AS BINARY(16)) AS CUSTOMER_REGION_HASHDIFF,
 *, TO_DATE('1992-01-08') AS LOADDATE, TO_DATE('1992-01-08') AS EFFECTIVE_FROM, 'TPCH' AS SOURCE FROM DV_PROTOTYPE_DB.SRC_STG.V_SRC_STG_ORDERS
  );
2019-09-04 20:06:04,832 (Thread-1): SQL status: SUCCESS 1 in 0.89 seconds
2019-09-04 20:06:04,835 (Thread-1): On stg_orders_hashed: COMMIT
2019-09-04 20:06:04,835 (Thread-1): Using snowflake connection "stg_orders_hashed".
2019-09-04 20:06:04,835 (Thread-1): On stg_orders_hashed: COMMIT
2019-09-04 20:06:04,933 (Thread-1): SQL status: SUCCESS 1 in 0.10 seconds
2019-09-04 20:06:04,945 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdd0d735-27cd-4b35-a18e-99a4d5bf729b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f818ac8bd68>]}
2019-09-04 20:06:05,450 (Thread-1): 20:06:05 | 1 of 3 OK created table model SRC_STG.stg_orders_hashed.............. [SUCCESS 1 in 1.81s]
2019-09-04 20:06:05,450 (Thread-1): 20:06:05 | 2 of 3 START incremental model SRC_test_vlt.test_hub_customer........ [RUN]
2019-09-04 20:06:05,451 (Thread-1): Acquiring new snowflake connection "test_hub_customer".
2019-09-04 20:06:05,451 (Thread-1): Re-using an available connection from the pool (formerly stg_orders_hashed).
2019-09-04 20:06:05,453 (Thread-1): Compiling model.snow_vault.test_hub_customer
2019-09-04 20:06:05,458 (Thread-1): Writing injected SQL for node "model.snow_vault.test_hub_customer"
2019-09-04 20:06:05,470 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-04 20:06:05,470 (Thread-1): On test_hub_customer: BEGIN
2019-09-04 20:06:05,573 (Thread-1): SQL status: SUCCESS 1 in 0.10 seconds
2019-09-04 20:06:05,574 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-04 20:06:05,574 (Thread-1): On test_hub_customer: create or replace temporary table DV_PROTOTYPE_DB.SRC_test_vlt.test_hub_customer__dbt_tmp
  as (
    

SELECT
                CAST(CUSTOMER_PK AS BINARY(16)) AS CUSTOMER_PK,
                CAST(CUSTOMERKEY AS NUMBER(38,0)) AS CUSTOMERKEY,
                CAST(SOURCE AS VARCHAR(4)) AS SOURCE,
                CAST(LOADDATE AS DATE) AS LOADDATE

 FROM (
  SELECT DISTINCT CUSTOMER_PK, CUSTOMERKEY, SOURCE, LOADDATE
  FROM
    (SELECT DISTINCT a.CUSTOMER_PK, a.CUSTOMERKEY, a.SOURCE, a.LOADDATE
    FROM DV_PROTOTYPE_DB.SRC_TEST_STG.STG_CUSTOMER AS a
    LEFT JOIN DV_PROTOTYPE_DB.SRC_test_vlt.test_hub_customer AS c
    ON a.CUSTOMER_PK = c.CUSTOMER_PK
    AND c.CUSTOMER_PK IS NULL)
 AS b)
AS stg
WHERE stg.CUSTOMER_PK NOT IN (SELECT CUSTOMER_PK FROM DV_PROTOTYPE_DB.SRC_test_vlt.test_hub_customer)
  );
2019-09-04 20:06:06,037 (Thread-1): SQL status: SUCCESS 1 in 0.46 seconds
2019-09-04 20:06:06,042 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-04 20:06:06,042 (Thread-1): On test_hub_customer: select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from
      DV_PROTOTYPE_DB.information_schema.columns

      where table_name ilike 'test_hub_customer__dbt_tmp'
        
        and table_schema ilike 'SRC_test_vlt'
        
        
        and table_catalog ilike 'DV_PROTOTYPE_DB'
        
      order by ordinal_position
2019-09-04 20:06:06,655 (Thread-1): SQL status: SUCCESS 4 in 0.61 seconds
2019-09-04 20:06:06,660 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-04 20:06:06,660 (Thread-1): On test_hub_customer: select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from
      DV_PROTOTYPE_DB.information_schema.columns

      where table_name ilike 'test_hub_customer'
        
        and table_schema ilike 'SRC_test_vlt'
        
        
        and table_catalog ilike 'DV_PROTOTYPE_DB'
        
      order by ordinal_position
2019-09-04 20:06:07,473 (Thread-1): SQL status: SUCCESS 4 in 0.81 seconds
2019-09-04 20:06:07,478 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-04 20:06:07,478 (Thread-1): On test_hub_customer: select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from
      DV_PROTOTYPE_DB.information_schema.columns

      where table_name ilike 'test_hub_customer'
        
        and table_schema ilike 'SRC_test_vlt'
        
        
        and table_catalog ilike 'DV_PROTOTYPE_DB'
        
      order by ordinal_position
2019-09-04 20:06:08,242 (Thread-1): SQL status: SUCCESS 4 in 0.76 seconds
2019-09-04 20:06:08,253 (Thread-1): Writing runtime SQL for node "model.snow_vault.test_hub_customer"
2019-09-04 20:06:08,254 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-04 20:06:08,254 (Thread-1): On test_hub_customer: insert into DV_PROTOTYPE_DB.SRC_test_vlt.test_hub_customer (CUSTOMER_PK, CUSTOMERKEY, LOADDATE, SOURCE)
        (
            select CUSTOMER_PK, CUSTOMERKEY, LOADDATE, SOURCE
            from DV_PROTOTYPE_DB.SRC_test_vlt.test_hub_customer__dbt_tmp
        );
2019-09-04 20:06:08,511 (Thread-1): SQL status: SUCCESS 0 in 0.26 seconds
2019-09-04 20:06:08,514 (Thread-1): On test_hub_customer: COMMIT
2019-09-04 20:06:08,514 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-04 20:06:08,514 (Thread-1): On test_hub_customer: COMMIT
2019-09-04 20:06:08,650 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2019-09-04 20:06:08,662 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdd0d735-27cd-4b35-a18e-99a4d5bf729b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f818ae409e8>]}
2019-09-04 20:06:09,174 (Thread-1): 20:06:09 | 2 of 3 OK created incremental model SRC_test_vlt.test_hub_customer... [SUCCESS 0 in 3.21s]
2019-09-04 20:06:09,175 (Thread-1): 20:06:09 | 3 of 3 START incremental model SRC_VLT.hub_customer.................. [RUN]
2019-09-04 20:06:09,175 (Thread-1): Acquiring new snowflake connection "hub_customer".
2019-09-04 20:06:09,175 (Thread-1): Re-using an available connection from the pool (formerly test_hub_customer).
2019-09-04 20:06:09,176 (Thread-1): Compiling model.dbtTest.hub_customer
2019-09-04 20:06:09,212 (Thread-1): Writing injected SQL for node "model.dbtTest.hub_customer"
2019-09-04 20:06:09,221 (Thread-1): Using snowflake connection "hub_customer".
2019-09-04 20:06:09,221 (Thread-1): On hub_customer: BEGIN
2019-09-04 20:06:09,321 (Thread-1): SQL status: SUCCESS 1 in 0.10 seconds
2019-09-04 20:06:09,322 (Thread-1): Using snowflake connection "hub_customer".
2019-09-04 20:06:09,322 (Thread-1): On hub_customer: create or replace temporary table DV_PROTOTYPE_DB.SRC_VLT.hub_customer__dbt_tmp
  as (
    SELECT 
                CAST(CUSTOMER_PK AS BINARY(16)) AS CUSTOMER_PK,
                CAST(CUSTOMERKEY AS NUMBER(38,0)) AS CUSTOMERKEY,
                CAST(SOURCE AS VARCHAR(4)) AS SOURCE,
                CAST(LOADDATE AS DATE) AS LOADDATE
 FROM (
  SELECT DISTINCT CUSTOMER_PK, CUSTOMERKEY, SOURCE, LOADDATE
  FROM
    (SELECT a.CUSTOMER_PK, a.CUSTOMERKEY, a.SOURCE, a.LOADDATE,
           lag(c.LOADDATE, 1) over(partition by c.CUSTOMER_PK order by c.LOADDATE) as FIRST_SEEN
    FROM DV_PROTOTYPE_DB.SRC_STG.stg_orders_hashed AS a
    LEFT JOIN DV_PROTOTYPE_DB.SRC_VLT.hub_customer AS c
    ON a.CUSTOMER_PK = c.CUSTOMER_PK
    AND c.CUSTOMER_PK IS NULL
    )
 AS b)
AS stg
WHERE stg.CUSTOMER_PK NOT IN (SELECT CUSTOMER_PK FROM DV_PROTOTYPE_DB.SRC_VLT.hub_customer)
  );
2019-09-04 20:06:09,981 (Thread-1): SQL status: SUCCESS 1 in 0.66 seconds
2019-09-04 20:06:09,994 (Thread-1): Using snowflake connection "hub_customer".
2019-09-04 20:06:09,994 (Thread-1): On hub_customer: select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from
      DV_PROTOTYPE_DB.information_schema.columns

      where table_name ilike 'hub_customer__dbt_tmp'
        
        and table_schema ilike 'SRC_VLT'
        
        
        and table_catalog ilike 'DV_PROTOTYPE_DB'
        
      order by ordinal_position
2019-09-04 20:06:10,671 (Thread-1): SQL status: SUCCESS 4 in 0.68 seconds
2019-09-04 20:06:10,676 (Thread-1): Using snowflake connection "hub_customer".
2019-09-04 20:06:10,676 (Thread-1): On hub_customer: select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from
      DV_PROTOTYPE_DB.information_schema.columns

      where table_name ilike 'hub_customer'
        
        and table_schema ilike 'SRC_VLT'
        
        
        and table_catalog ilike 'DV_PROTOTYPE_DB'
        
      order by ordinal_position
2019-09-04 20:06:11,315 (Thread-1): SQL status: SUCCESS 4 in 0.64 seconds
2019-09-04 20:06:11,331 (Thread-1): Using snowflake connection "hub_customer".
2019-09-04 20:06:11,331 (Thread-1): On hub_customer: select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from
      DV_PROTOTYPE_DB.information_schema.columns

      where table_name ilike 'hub_customer'
        
        and table_schema ilike 'SRC_VLT'
        
        
        and table_catalog ilike 'DV_PROTOTYPE_DB'
        
      order by ordinal_position
2019-09-04 20:06:12,011 (Thread-1): SQL status: SUCCESS 4 in 0.68 seconds
2019-09-04 20:06:12,015 (Thread-1): Writing runtime SQL for node "model.dbtTest.hub_customer"
2019-09-04 20:06:12,015 (Thread-1): Using snowflake connection "hub_customer".
2019-09-04 20:06:12,015 (Thread-1): On hub_customer: insert into DV_PROTOTYPE_DB.SRC_VLT.hub_customer (CUSTOMER_PK, CUSTOMERKEY, SOURCE, LOADDATE)
        (
            select CUSTOMER_PK, CUSTOMERKEY, SOURCE, LOADDATE
            from DV_PROTOTYPE_DB.SRC_VLT.hub_customer__dbt_tmp
        );
2019-09-04 20:06:12,206 (Thread-1): SQL status: SUCCESS 0 in 0.19 seconds
2019-09-04 20:06:12,209 (Thread-1): On hub_customer: COMMIT
2019-09-04 20:06:12,210 (Thread-1): Using snowflake connection "hub_customer".
2019-09-04 20:06:12,210 (Thread-1): On hub_customer: COMMIT
2019-09-04 20:06:12,430 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2019-09-04 20:06:12,443 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdd0d735-27cd-4b35-a18e-99a4d5bf729b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f818acf5a90>]}
2019-09-04 20:06:12,947 (Thread-1): 20:06:12 | 3 of 3 OK created incremental model SRC_VLT.hub_customer............. [SUCCESS 0 in 3.26s]
2019-09-04 20:06:12,953 (MainThread): Using snowflake connection "master".
2019-09-04 20:06:12,953 (MainThread): On master: BEGIN
2019-09-04 20:06:13,072 (MainThread): SQL status: SUCCESS 1 in 0.12 seconds
2019-09-04 20:06:13,073 (MainThread): On master: COMMIT
2019-09-04 20:06:13,073 (MainThread): Using snowflake connection "master".
2019-09-04 20:06:13,073 (MainThread): On master: COMMIT
2019-09-04 20:06:13,231 (MainThread): SQL status: SUCCESS 1 in 0.16 seconds
2019-09-04 20:06:13,233 (MainThread): 20:06:13 | 
2019-09-04 20:06:13,233 (MainThread): 20:06:13 | Finished running 1 table models, 2 incremental models in 14.03s.
2019-09-04 20:06:13,233 (MainThread): Connection 'master' was left open.
2019-09-04 20:06:13,234 (MainThread): On master: Close
2019-09-04 20:06:13,380 (MainThread): Connection 'hub_customer' was left open.
2019-09-04 20:06:13,381 (MainThread): On hub_customer: Close
2019-09-04 20:06:13,548 (MainThread): 
2019-09-04 20:06:13,548 (MainThread): Completed successfully
2019-09-04 20:06:13,548 (MainThread): 
Done. PASS=3 ERROR=0 SKIP=0 TOTAL=3
2019-09-04 20:06:13,549 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f818ae219b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8169f51198>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8169f519e8>]}
2019-09-04 20:06:14,071 (MainThread): Flushing usage events
2019-09-05 07:44:12,862 (MainThread): Tracking: tracking
2019-09-05 07:44:12,863 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2c0db09b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2c0db0e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2c0d48470>]}
2019-09-05 07:44:13,399 (MainThread): Parsing macros/core.sql
2019-09-05 07:44:13,402 (MainThread): Parsing macros/adapters/common.sql
2019-09-05 07:44:13,419 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-09-05 07:44:13,420 (MainThread): Parsing macros/schema_tests/unique.sql
2019-09-05 07:44:13,421 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-09-05 07:44:13,421 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-09-05 07:44:13,422 (MainThread): Parsing macros/materializations/helpers.sql
2019-09-05 07:44:13,426 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-09-05 07:44:13,429 (MainThread): Parsing macros/materializations/view/view.sql
2019-09-05 07:44:13,432 (MainThread): Parsing macros/materializations/table/table.sql
2019-09-05 07:44:13,435 (MainThread): Parsing macros/materializations/common/merge.sql
2019-09-05 07:44:13,439 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2019-09-05 07:44:13,448 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2019-09-05 07:44:13,455 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2019-09-05 07:44:13,456 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-09-05 07:44:13,464 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-09-05 07:44:13,468 (MainThread): Parsing macros/etc/is_incremental.sql
2019-09-05 07:44:13,469 (MainThread): Parsing macros/etc/get_relation_comment.sql
2019-09-05 07:44:13,470 (MainThread): Parsing macros/etc/datetime.sql
2019-09-05 07:44:13,475 (MainThread): Parsing macros/etc/get_custom_alias.sql
2019-09-05 07:44:13,476 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-09-05 07:44:13,477 (MainThread): Parsing macros/etc/query.sql
2019-09-05 07:44:13,478 (MainThread): Parsing macros/adapters.sql
2019-09-05 07:44:13,482 (MainThread): Parsing macros/catalog.sql
2019-09-05 07:44:13,484 (MainThread): Parsing macros/materializations/incremental.sql
2019-09-05 07:44:13,487 (MainThread): Parsing macros/materializations/merge.sql
2019-09-05 07:44:13,489 (MainThread): Parsing macros/materializations/view.sql
2019-09-05 07:44:13,489 (MainThread): Parsing macros/materializations/table.sql
2019-09-05 07:44:13,491 (MainThread): Parsing macros/sat_template.sql
2019-09-05 07:44:13,492 (MainThread): Parsing macros/hub_template.sql
2019-09-05 07:44:13,493 (MainThread): Parsing macros/link_template.sql
2019-09-05 07:44:13,493 (MainThread): Parsing macros/utility/md5_binary.sql
2019-09-05 07:44:13,494 (MainThread): Parsing macros/utility/cast.sql
2019-09-05 07:44:13,496 (MainThread): Parsing macros/utility/union.sql
2019-09-05 07:44:13,497 (MainThread): Parsing macros/utility/prefix.sql
2019-09-05 07:44:13,505 (MainThread): Parsing model.dbtTest.hub_customer
2019-09-05 07:44:13,505 (MainThread): Acquiring new snowflake connection "hub_customer".
2019-09-05 07:44:13,505 (MainThread): Opening a new connection, currently in state init
2019-09-05 07:44:13,763 (MainThread): /home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/snowflake/connector/ocsp_asn1crypto.py:83: ResourceWarning: unclosed file <_io.BufferedReader name='/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/botocore/vendored/requests/cacert.pem'>

2019-09-05 07:44:13,772 (MainThread): /home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/snowflake/connector/ocsp_asn1crypto.py:83: ResourceWarning: unclosed file <_io.BufferedReader name='/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/certifi/cacert.pem'>

2019-09-05 07:44:14,257 (MainThread): Parsing model.dbtTest.stg_orders_hashed
2019-09-05 07:44:14,258 (MainThread): Acquiring new snowflake connection "stg_orders_hashed".
2019-09-05 07:44:14,258 (MainThread): Re-using an available connection from the pool (formerly hub_customer).
2019-09-05 07:44:14,267 (MainThread): Parsing model.snow_vault.test_sat_hub_customer
2019-09-05 07:44:14,268 (MainThread): Acquiring new snowflake connection "test_sat_hub_customer".
2019-09-05 07:44:14,268 (MainThread): Re-using an available connection from the pool (formerly stg_orders_hashed).
2019-09-05 07:44:14,271 (MainThread): Parsing model.snow_vault.test_source
2019-09-05 07:44:14,271 (MainThread): Acquiring new snowflake connection "test_source".
2019-09-05 07:44:14,271 (MainThread): Re-using an available connection from the pool (formerly test_sat_hub_customer).
2019-09-05 07:44:14,275 (MainThread): Parsing model.snow_vault.test_link_customer_nation
2019-09-05 07:44:14,275 (MainThread): Acquiring new snowflake connection "test_link_customer_nation".
2019-09-05 07:44:14,275 (MainThread): Re-using an available connection from the pool (formerly test_source).
2019-09-05 07:44:14,278 (MainThread): Parsing model.snow_vault.test_stg
2019-09-05 07:44:14,279 (MainThread): Acquiring new snowflake connection "test_stg".
2019-09-05 07:44:14,279 (MainThread): Re-using an available connection from the pool (formerly test_link_customer_nation).
2019-09-05 07:44:14,281 (MainThread): Parsing model.snow_vault.test_hub_customer
2019-09-05 07:44:14,282 (MainThread): Acquiring new snowflake connection "test_hub_customer".
2019-09-05 07:44:14,282 (MainThread): Re-using an available connection from the pool (formerly test_stg).
2019-09-05 07:44:14,316 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 123 macros, 0 operations, 0 seed files, 0 sources
2019-09-05 07:44:14,317 (MainThread): 
2019-09-05 07:44:14,317 (MainThread): Acquiring new snowflake connection "master".
2019-09-05 07:44:14,317 (MainThread): Re-using an available connection from the pool (formerly test_hub_customer).
2019-09-05 07:44:14,326 (MainThread): Parsing macros/core.sql
2019-09-05 07:44:14,328 (MainThread): Parsing macros/adapters/common.sql
2019-09-05 07:44:14,346 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-09-05 07:44:14,347 (MainThread): Parsing macros/schema_tests/unique.sql
2019-09-05 07:44:14,348 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-09-05 07:44:14,348 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-09-05 07:44:14,349 (MainThread): Parsing macros/materializations/helpers.sql
2019-09-05 07:44:14,353 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-09-05 07:44:14,356 (MainThread): Parsing macros/materializations/view/view.sql
2019-09-05 07:44:14,359 (MainThread): Parsing macros/materializations/table/table.sql
2019-09-05 07:44:14,362 (MainThread): Parsing macros/materializations/common/merge.sql
2019-09-05 07:44:14,365 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2019-09-05 07:44:14,375 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2019-09-05 07:44:14,381 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2019-09-05 07:44:14,382 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-09-05 07:44:14,390 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-09-05 07:44:14,394 (MainThread): Parsing macros/etc/is_incremental.sql
2019-09-05 07:44:14,395 (MainThread): Parsing macros/etc/get_relation_comment.sql
2019-09-05 07:44:14,397 (MainThread): Parsing macros/etc/datetime.sql
2019-09-05 07:44:14,419 (MainThread): Parsing macros/etc/get_custom_alias.sql
2019-09-05 07:44:14,420 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-09-05 07:44:14,421 (MainThread): Parsing macros/etc/query.sql
2019-09-05 07:44:14,422 (MainThread): Parsing macros/adapters.sql
2019-09-05 07:44:14,427 (MainThread): Parsing macros/catalog.sql
2019-09-05 07:44:14,428 (MainThread): Parsing macros/materializations/incremental.sql
2019-09-05 07:44:14,431 (MainThread): Parsing macros/materializations/merge.sql
2019-09-05 07:44:14,432 (MainThread): Parsing macros/materializations/view.sql
2019-09-05 07:44:14,433 (MainThread): Parsing macros/materializations/table.sql
2019-09-05 07:44:14,482 (MainThread): Using snowflake connection "master".
2019-09-05 07:44:14,482 (MainThread): On master: select distinct schema_name
    from DV_PROTOTYPE_DB.information_schema.schemata
    where catalog_name ilike 'DV_PROTOTYPE_DB'
2019-09-05 07:44:15,537 (MainThread): SQL status: SUCCESS 8 in 1.05 seconds
2019-09-05 07:44:15,558 (MainThread): Creating schema "DV_PROTOTYPE_DB"."SRC_test_vlt".
2019-09-05 07:44:15,566 (MainThread): Using snowflake connection "master".
2019-09-05 07:44:15,566 (MainThread): On master: BEGIN
2019-09-05 07:44:15,687 (MainThread): SQL status: SUCCESS 1 in 0.12 seconds
2019-09-05 07:44:15,688 (MainThread): Using snowflake connection "master".
2019-09-05 07:44:15,688 (MainThread): On master: create schema if not exists DV_PROTOTYPE_DB.SRC_test_vlt
2019-09-05 07:44:15,860 (MainThread): SQL status: SUCCESS 1 in 0.17 seconds
2019-09-05 07:44:15,861 (MainThread): On master: COMMIT
2019-09-05 07:44:15,861 (MainThread): Using snowflake connection "master".
2019-09-05 07:44:15,861 (MainThread): On master: COMMIT
2019-09-05 07:44:16,157 (MainThread): SQL status: SUCCESS 1 in 0.30 seconds
2019-09-05 07:44:16,170 (MainThread): Using snowflake connection "master".
2019-09-05 07:44:16,170 (MainThread): On master: BEGIN
2019-09-05 07:44:16,307 (MainThread): SQL status: SUCCESS 1 in 0.14 seconds
2019-09-05 07:44:16,308 (MainThread): Using snowflake connection "master".
2019-09-05 07:44:16,308 (MainThread): On master: select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'externaltable'
           else table_type
      end as table_type
    from DV_PROTOTYPE_DB.information_schema.tables
    where table_schema ilike 'src_test_vlt'
      and table_catalog ilike 'dv_prototype_db'
2019-09-05 07:44:17,734 (MainThread): SQL status: SUCCESS 3 in 1.43 seconds
2019-09-05 07:44:17,739 (MainThread): Using snowflake connection "master".
2019-09-05 07:44:17,739 (MainThread): On master: select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'externaltable'
           else table_type
      end as table_type
    from DV_PROTOTYPE_DB.information_schema.tables
    where table_schema ilike 'src_stg'
      and table_catalog ilike 'dv_prototype_db'
2019-09-05 07:44:18,902 (MainThread): SQL status: SUCCESS 6 in 1.16 seconds
2019-09-05 07:44:18,909 (MainThread): Using snowflake connection "master".
2019-09-05 07:44:18,909 (MainThread): On master: select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'externaltable'
           else table_type
      end as table_type
    from DV_PROTOTYPE_DB.information_schema.tables
    where table_schema ilike 'src_vlt'
      and table_catalog ilike 'dv_prototype_db'
2019-09-05 07:44:19,784 (MainThread): SQL status: SUCCESS 29 in 0.87 seconds
2019-09-05 07:44:19,799 (MainThread): On master: ROLLBACK
2019-09-05 07:44:19,935 (MainThread): Using snowflake connection "master".
2019-09-05 07:44:19,935 (MainThread): On master: BEGIN
2019-09-05 07:44:20,064 (MainThread): SQL status: SUCCESS 1 in 0.13 seconds
2019-09-05 07:44:20,065 (MainThread): On master: COMMIT
2019-09-05 07:44:20,066 (MainThread): Using snowflake connection "master".
2019-09-05 07:44:20,066 (MainThread): On master: COMMIT
2019-09-05 07:44:20,251 (MainThread): SQL status: SUCCESS 1 in 0.18 seconds
2019-09-05 07:44:20,252 (MainThread): 07:44:20 | Concurrency: 1 threads (target='dev')
2019-09-05 07:44:20,252 (MainThread): 07:44:20 | 
2019-09-05 07:44:20,255 (Thread-1): 07:44:20 | 1 of 3 START table model SRC_STG.stg_orders_hashed................... [RUN]
2019-09-05 07:44:20,256 (Thread-1): Acquiring new snowflake connection "stg_orders_hashed".
2019-09-05 07:44:20,257 (Thread-1): Opening a new connection, currently in state init
2019-09-05 07:44:20,813 (Thread-1): Compiling model.dbtTest.stg_orders_hashed
2019-09-05 07:44:20,827 (Thread-1): Writing injected SQL for node "model.dbtTest.stg_orders_hashed"
2019-09-05 07:44:20,849 (Thread-1): Writing runtime SQL for node "model.dbtTest.stg_orders_hashed"
2019-09-05 07:44:20,852 (Thread-1): Using snowflake connection "stg_orders_hashed".
2019-09-05 07:44:20,852 (Thread-1): On stg_orders_hashed: BEGIN
2019-09-05 07:44:21,008 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2019-09-05 07:44:21,009 (Thread-1): Using snowflake connection "stg_orders_hashed".
2019-09-05 07:44:21,010 (Thread-1): On stg_orders_hashed: create or replace transient table DV_PROTOTYPE_DB.SRC_STG.stg_orders_hashed
  as (
    

select
CAST(MD5_BINARY(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR)))) AS BINARY(16)) AS ORDER_PK,
CAST(MD5_BINARY(UPPER(TRIM(CAST(PARTKEY AS VARCHAR)))) AS BINARY(16)) AS PART_PK,
CAST(MD5_BINARY(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR)))) AS BINARY(16)) AS SUPPLIER_PK,
CAST(MD5_BINARY(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR)))) AS BINARY(16)) AS LINEITEM_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS INVENTORY_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS INVENTORY_ALLOCATION_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(COMMITDATE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(DISCOUNT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(EXTENDEDPRICE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(LINESTATUS AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(LINE_COMMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(QUANTITY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(RECEIPTDATE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(RETURNFLAG AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SHIPDATE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SHIPINSTRUCT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SHIPMODE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(TAX AS VARCHAR))), '^^') )) AS BINARY(16)) AS LINEITEM_HASHDIFF,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS LINEITEM_ORDER_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CLERK AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDERDATE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDERPRIORITY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDERSTATUS AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDER_COMMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SHIPPRIORITY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(TOTALPRICE AS VARCHAR))), '^^') )) AS BINARY(16)) AS ORDER_HASHDIFF,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS ORDER_CUSTOMER_PK,
CAST(MD5_BINARY(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR)))) AS BINARY(16)) AS CUSTOMER_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_NATIONKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS LINK_CUSTOMER_NATION_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMER_ACCBAL AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_COMMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_MKTSEGMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_NAME AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_PHONE AS VARCHAR))), '^^') )) AS BINARY(16)) AS CUSTOMER_HASHDIFF,
CAST(MD5_BINARY(UPPER(TRIM(CAST(CUSTOMER_NATIONKEY AS VARCHAR)))) AS BINARY(16)) AS CUSTOMER_NATION_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMER_NATION_COMMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_NATION_NAME AS VARCHAR))), '^^') )) AS BINARY(16)) AS CUSTOMER_NATION_HASHDIFF,
CAST(MD5_BINARY(UPPER(TRIM(CAST(CUSTOMER_REGIONKEY AS VARCHAR)))) AS BINARY(16)) AS CUSTOMER_REGION_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMER_NATIONKEY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_REGIONKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS CUSTOMER_NATION_REGION_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMER_REGION_COMMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_REGION_NAME AS VARCHAR))), '^^') )) AS BINARY(16)) AS CUSTOMER_REGION_HASHDIFF,
 *, TO_DATE('1992-01-08') AS LOADDATE, TO_DATE('1992-01-08') AS EFFECTIVE_FROM, 'TPCH' AS SOURCE FROM DV_PROTOTYPE_DB.SRC_STG.V_SRC_STG_ORDERS
  );
2019-09-05 07:44:22,596 (Thread-1): SQL status: SUCCESS 1 in 1.59 seconds
2019-09-05 07:44:22,599 (Thread-1): On stg_orders_hashed: COMMIT
2019-09-05 07:44:22,599 (Thread-1): Using snowflake connection "stg_orders_hashed".
2019-09-05 07:44:22,599 (Thread-1): On stg_orders_hashed: COMMIT
2019-09-05 07:44:22,740 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2019-09-05 07:44:22,752 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f8b754e-1fe5-4ef0-9315-dd910f2b5ead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2e1380ba8>]}
2019-09-05 07:44:23,251 (Thread-1): 07:44:23 | 1 of 3 OK created table model SRC_STG.stg_orders_hashed.............. [SUCCESS 1 in 2.49s]
2019-09-05 07:44:23,252 (Thread-1): 07:44:23 | 2 of 3 START incremental model SRC_test_vlt.test_hub_customer........ [RUN]
2019-09-05 07:44:23,252 (Thread-1): Acquiring new snowflake connection "test_hub_customer".
2019-09-05 07:44:23,252 (Thread-1): Re-using an available connection from the pool (formerly stg_orders_hashed).
2019-09-05 07:44:23,253 (Thread-1): Compiling model.snow_vault.test_hub_customer
2019-09-05 07:44:23,256 (Thread-1): Writing injected SQL for node "model.snow_vault.test_hub_customer"
2019-09-05 07:44:23,268 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-05 07:44:23,268 (Thread-1): On test_hub_customer: BEGIN
2019-09-05 07:44:23,376 (Thread-1): SQL status: SUCCESS 1 in 0.11 seconds
2019-09-05 07:44:23,377 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-05 07:44:23,378 (Thread-1): On test_hub_customer: create or replace temporary table DV_PROTOTYPE_DB.SRC_test_vlt.test_hub_customer__dbt_tmp
  as (
    

SELECT
                CAST(CUSTOMER_PK AS BINARY(16)) AS CUSTOMER_PK,
                CAST(CUSTOMERKEY AS NUMBER(38,0)) AS CUSTOMERKEY,
                CAST(SOURCE AS VARCHAR(4)) AS SOURCE,
                CAST(LOADDATE AS DATE) AS LOADDATE

 FROM (
  SELECT DISTINCT CUSTOMER_PK, CUSTOMERKEY, SOURCE, LOADDATE, FIRST_SOURCE
  FROM
    (SELECT DISTINCT a.CUSTOMER_PK, a.CUSTOMERKEY, a.SOURCE, a.LOADDATE,
                     lag(a.SOURCE, 1) over(partition by a.CUSTOMER_PK order by a.CUSTOMER_PK) as FIRST_SOURCE
    FROM DV_PROTOTYPE_DB.SRC_TEST_STG.STG_CUSTOMER AS a
    LEFT JOIN DV_PROTOTYPE_DB.SRC_test_vlt.test_hub_customer AS c
    ON a.CUSTOMER_PK = c.CUSTOMER_PK
    AND c.CUSTOMER_PK IS NULL) AS b)
AS stg
WHERE stg.CUSTOMER_PK NOT IN (SELECT CUSTOMER_PK FROM DV_PROTOTYPE_DB.SRC_test_vlt.test_hub_customer)
AND FIRST_SOURCE IS NULL
  );
2019-09-05 07:44:24,181 (Thread-1): SQL status: SUCCESS 1 in 0.80 seconds
2019-09-05 07:44:24,186 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-05 07:44:24,186 (Thread-1): On test_hub_customer: select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from
      DV_PROTOTYPE_DB.information_schema.columns

      where table_name ilike 'test_hub_customer__dbt_tmp'
        
        and table_schema ilike 'SRC_test_vlt'
        
        
        and table_catalog ilike 'DV_PROTOTYPE_DB'
        
      order by ordinal_position
2019-09-05 07:44:25,237 (Thread-1): SQL status: SUCCESS 4 in 1.05 seconds
2019-09-05 07:44:25,241 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-05 07:44:25,241 (Thread-1): On test_hub_customer: select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from
      DV_PROTOTYPE_DB.information_schema.columns

      where table_name ilike 'test_hub_customer'
        
        and table_schema ilike 'SRC_test_vlt'
        
        
        and table_catalog ilike 'DV_PROTOTYPE_DB'
        
      order by ordinal_position
2019-09-05 07:44:26,049 (Thread-1): SQL status: SUCCESS 4 in 0.81 seconds
2019-09-05 07:44:26,053 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-05 07:44:26,053 (Thread-1): On test_hub_customer: select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from
      DV_PROTOTYPE_DB.information_schema.columns

      where table_name ilike 'test_hub_customer'
        
        and table_schema ilike 'SRC_test_vlt'
        
        
        and table_catalog ilike 'DV_PROTOTYPE_DB'
        
      order by ordinal_position
2019-09-05 07:44:26,767 (Thread-1): SQL status: SUCCESS 4 in 0.71 seconds
2019-09-05 07:44:26,779 (Thread-1): Writing runtime SQL for node "model.snow_vault.test_hub_customer"
2019-09-05 07:44:26,779 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-05 07:44:26,779 (Thread-1): On test_hub_customer: insert into DV_PROTOTYPE_DB.SRC_test_vlt.test_hub_customer (CUSTOMER_PK, CUSTOMERKEY, SOURCE, LOADDATE)
        (
            select CUSTOMER_PK, CUSTOMERKEY, SOURCE, LOADDATE
            from DV_PROTOTYPE_DB.SRC_test_vlt.test_hub_customer__dbt_tmp
        );
2019-09-05 07:44:27,126 (Thread-1): SQL status: SUCCESS 0 in 0.35 seconds
2019-09-05 07:44:27,129 (Thread-1): On test_hub_customer: COMMIT
2019-09-05 07:44:27,130 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-05 07:44:27,130 (Thread-1): On test_hub_customer: COMMIT
2019-09-05 07:44:27,258 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2019-09-05 07:44:27,270 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f8b754e-1fe5-4ef0-9315-dd910f2b5ead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2e11d8518>]}
2019-09-05 07:44:27,756 (Thread-1): 07:44:27 | 2 of 3 OK created incremental model SRC_test_vlt.test_hub_customer... [SUCCESS 0 in 4.01s]
2019-09-05 07:44:27,756 (Thread-1): 07:44:27 | 3 of 3 START incremental model SRC_VLT.hub_customer.................. [RUN]
2019-09-05 07:44:27,761 (Thread-1): Acquiring new snowflake connection "hub_customer".
2019-09-05 07:44:27,761 (Thread-1): Re-using an available connection from the pool (formerly test_hub_customer).
2019-09-05 07:44:27,762 (Thread-1): Compiling model.dbtTest.hub_customer
2019-09-05 07:44:27,794 (Thread-1): Writing injected SQL for node "model.dbtTest.hub_customer"
2019-09-05 07:44:27,804 (Thread-1): Using snowflake connection "hub_customer".
2019-09-05 07:44:27,804 (Thread-1): On hub_customer: BEGIN
2019-09-05 07:44:27,904 (Thread-1): SQL status: SUCCESS 1 in 0.10 seconds
2019-09-05 07:44:27,905 (Thread-1): Using snowflake connection "hub_customer".
2019-09-05 07:44:27,905 (Thread-1): On hub_customer: create or replace temporary table DV_PROTOTYPE_DB.SRC_VLT.hub_customer__dbt_tmp
  as (
    SELECT 
                CAST(CUSTOMER_PK AS BINARY(16)) AS CUSTOMER_PK,
                CAST(CUSTOMERKEY AS NUMBER(38,0)) AS CUSTOMERKEY,
                CAST(SOURCE AS VARCHAR(4)) AS SOURCE,
                CAST(LOADDATE AS DATE) AS LOADDATE
 FROM (
  SELECT DISTINCT CUSTOMER_PK, CUSTOMERKEY, SOURCE, LOADDATE, FIRST_SOURCE
  FROM
    (SELECT DISTINCT a.CUSTOMER_PK, a.CUSTOMERKEY, a.SOURCE, a.LOADDATE,
           lag(a.src_ldts[loop.index0]], 1) over(partition by a.src_pk[loop.index0] order by a.src_pk[loop.index0]) as FIRST_SOURCE
    FROM DV_PROTOTYPE_DB.SRC_STG.stg_orders_hashed AS a
    LEFT JOIN DV_PROTOTYPE_DB.SRC_VLT.hub_customer AS c
    ON a.CUSTOMER_PK = c.CUSTOMER_PK
    AND c.CUSTOMER_PK IS NULL
    )
 AS b)
AS stg
WHERE stg.CUSTOMER_PK NOT IN (SELECT CUSTOMER_PK FROM DV_PROTOTYPE_DB.SRC_VLT.hub_customer)
 AND FIRST_SOURCE IS NULL
  );
2019-09-05 07:44:29,020 (Thread-1): Snowflake error: 001003 (42000): 018ead94-0069-14fd-0000-28a50002f9a6: SQL compilation error:
syntax error line 12 at position 38 unexpected ']'.
syntax error line 12 at position 59 unexpected 'by'.
syntax error line 12 at position 116 unexpected 'as'.
2019-09-05 07:44:29,021 (Thread-1): On hub_customer: ROLLBACK
2019-09-05 07:44:29,151 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f8b754e-1fe5-4ef0-9315-dd910f2b5ead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2e1286550>]}
2019-09-05 07:44:29,942 (Thread-1): 07:44:29 | 3 of 3 ERROR creating incremental model SRC_VLT.hub_customer......... [ERROR in 1.39s]
2019-09-05 07:44:29,995 (MainThread): Using snowflake connection "master".
2019-09-05 07:44:29,996 (MainThread): On master: BEGIN
2019-09-05 07:44:30,107 (MainThread): SQL status: SUCCESS 1 in 0.11 seconds
2019-09-05 07:44:30,108 (MainThread): On master: COMMIT
2019-09-05 07:44:30,109 (MainThread): Using snowflake connection "master".
2019-09-05 07:44:30,109 (MainThread): On master: COMMIT
2019-09-05 07:44:30,266 (MainThread): SQL status: SUCCESS 1 in 0.16 seconds
2019-09-05 07:44:30,267 (MainThread): 07:44:30 | 
2019-09-05 07:44:30,268 (MainThread): 07:44:30 | Finished running 1 table models, 2 incremental models in 15.95s.
2019-09-05 07:44:30,268 (MainThread): Connection 'master' was left open.
2019-09-05 07:44:30,269 (MainThread): On master: Close
2019-09-05 07:44:30,423 (MainThread): Connection 'hub_customer' was left open.
2019-09-05 07:44:30,424 (MainThread): On hub_customer: Close
2019-09-05 07:44:30,583 (MainThread): 
2019-09-05 07:44:30,583 (MainThread): Completed with 1 errors:
2019-09-05 07:44:30,583 (MainThread): 
2019-09-05 07:44:30,583 (MainThread): Database Error in model hub_customer (models/hub_sat_link_load/hub_customer.sql)
2019-09-05 07:44:30,584 (MainThread):   001003 (42000): 018ead94-0069-14fd-0000-28a50002f9a6: SQL compilation error:
2019-09-05 07:44:30,584 (MainThread):   syntax error line 12 at position 38 unexpected ']'.
2019-09-05 07:44:30,584 (MainThread):   syntax error line 12 at position 59 unexpected 'by'.
2019-09-05 07:44:30,584 (MainThread):   syntax error line 12 at position 116 unexpected 'as'.
2019-09-05 07:44:30,584 (MainThread):   compiled SQL at target/compiled/dbtTest/hub_sat_link_load/hub_customer.sql
2019-09-05 07:44:30,584 (MainThread): 
Done. PASS=2 ERROR=1 SKIP=0 TOTAL=3
2019-09-05 07:44:30,585 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2e11b4e48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2e11b4860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2e11b4f60>]}
2019-09-05 07:44:31,073 (MainThread): Flushing usage events
2019-09-05 07:46:21,995 (MainThread): Tracking: tracking
2019-09-05 07:46:21,996 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faee54f0978>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faee54f0e48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faee5487438>]}
2019-09-05 07:46:22,590 (MainThread): Parsing macros/core.sql
2019-09-05 07:46:22,594 (MainThread): Parsing macros/adapters/common.sql
2019-09-05 07:46:22,616 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-09-05 07:46:22,617 (MainThread): Parsing macros/schema_tests/unique.sql
2019-09-05 07:46:22,618 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-09-05 07:46:22,619 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-09-05 07:46:22,619 (MainThread): Parsing macros/materializations/helpers.sql
2019-09-05 07:46:22,623 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-09-05 07:46:22,626 (MainThread): Parsing macros/materializations/view/view.sql
2019-09-05 07:46:22,629 (MainThread): Parsing macros/materializations/table/table.sql
2019-09-05 07:46:22,632 (MainThread): Parsing macros/materializations/common/merge.sql
2019-09-05 07:46:22,635 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2019-09-05 07:46:22,645 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2019-09-05 07:46:22,651 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2019-09-05 07:46:22,652 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-09-05 07:46:22,660 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-09-05 07:46:22,664 (MainThread): Parsing macros/etc/is_incremental.sql
2019-09-05 07:46:22,665 (MainThread): Parsing macros/etc/get_relation_comment.sql
2019-09-05 07:46:22,666 (MainThread): Parsing macros/etc/datetime.sql
2019-09-05 07:46:22,671 (MainThread): Parsing macros/etc/get_custom_alias.sql
2019-09-05 07:46:22,672 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-09-05 07:46:22,673 (MainThread): Parsing macros/etc/query.sql
2019-09-05 07:46:22,674 (MainThread): Parsing macros/adapters.sql
2019-09-05 07:46:22,678 (MainThread): Parsing macros/catalog.sql
2019-09-05 07:46:22,679 (MainThread): Parsing macros/materializations/incremental.sql
2019-09-05 07:46:22,683 (MainThread): Parsing macros/materializations/merge.sql
2019-09-05 07:46:22,684 (MainThread): Parsing macros/materializations/view.sql
2019-09-05 07:46:22,684 (MainThread): Parsing macros/materializations/table.sql
2019-09-05 07:46:22,686 (MainThread): Parsing macros/sat_template.sql
2019-09-05 07:46:22,687 (MainThread): Parsing macros/hub_template.sql
2019-09-05 07:46:22,688 (MainThread): Parsing macros/link_template.sql
2019-09-05 07:46:22,689 (MainThread): Parsing macros/utility/md5_binary.sql
2019-09-05 07:46:22,690 (MainThread): Parsing macros/utility/cast.sql
2019-09-05 07:46:22,691 (MainThread): Parsing macros/utility/union.sql
2019-09-05 07:46:22,693 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faee54acd68>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faee54ac898>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faee54ac400>]}
2019-09-05 07:46:23,170 (MainThread): Flushing usage events
2019-09-05 07:46:23,171 (MainThread): /home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/dbt/main.py:97: DeprecationWarning: The 'warn' method is deprecated, use 'warning' instead

2019-09-05 07:46:23,172 (MainThread): Encountered an error:
2019-09-05 07:46:23,172 (MainThread): /home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/dbt/main.py:98: DeprecationWarning: The 'warn' method is deprecated, use 'warning' instead

2019-09-05 07:46:23,172 (MainThread): Compilation Error in None unknown (macros/utility/union.sql)
  unexpected ']'
    line 8
      lag(a.{{ src_ldts[loop.index0]] }}, 1) o
2019-09-05 07:46:23,176 (MainThread): Traceback (most recent call last):
  File "/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/dbt/clients/jinja.py", line 243, in parse
    return get_environment().parse(dbt.compat.to_string(string))
  File "/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/jinja2/environment.py", line 493, in parse
    self.handle_exception(exc_info, source_hint=source)
  File "/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/jinja2/environment.py", line 780, in handle_exception
    reraise(exc_type, exc_value, tb)
  File "/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/jinja2/_compat.py", line 37, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 8, in template
  File "/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/dbt/clients/jinja.py", line 41, in _parse
    jinja2._compat.encode_filename(filename)
  File "/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/jinja2/parser.py", line 901, in parse
    result = nodes.Template(self.subparse(), lineno=1)
  File "/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/jinja2/parser.py", line 883, in subparse
    rv = self.parse_statement()
  File "/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/jinja2/parser.py", line 130, in parse_statement
    return getattr(self, 'parse_' + self.stream.current.value)()
  File "/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/dbt/clients/jinja.py", line 33, in parse_macro
    drop_needle=True)
  File "/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/jinja2/parser.py", line 165, in parse_statements
    result = self.subparse(end_tokens)
  File "/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/jinja2/parser.py", line 883, in subparse
    rv = self.parse_statement()
  File "/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/jinja2/parser.py", line 130, in parse_statement
    return getattr(self, 'parse_' + self.stream.current.value)()
  File "/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/jinja2/parser.py", line 199, in parse_for
    body = self.parse_statements(('name:endfor', 'name:else'))
  File "/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/jinja2/parser.py", line 165, in parse_statements
    result = self.subparse(end_tokens)
  File "/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/jinja2/parser.py", line 875, in subparse
    add_data(self.parse_tuple(with_condexpr=True))
  File "/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/jinja2/parser.py", line 620, in parse_tuple
    args.append(parse())
  File "/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/jinja2/parser.py", line 432, in parse_expression
    return self.parse_condexpr()
  File "/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/jinja2/parser.py", line 437, in parse_condexpr
    expr1 = self.parse_or()
  File "/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/jinja2/parser.py", line 450, in parse_or
    left = self.parse_and()
  File "/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/jinja2/parser.py", line 459, in parse_and
    left = self.parse_not()
  File "/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/jinja2/parser.py", line 470, in parse_not
    return self.parse_compare()
  File "/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/jinja2/parser.py", line 474, in parse_compare
    expr = self.parse_math1()
  File "/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/jinja2/parser.py", line 496, in parse_math1
    left = self.parse_concat()
  File "/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/jinja2/parser.py", line 507, in parse_concat
    args = [self.parse_math2()]
  File "/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/jinja2/parser.py", line 517, in parse_math2
    left = self.parse_pow()
  File "/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/jinja2/parser.py", line 528, in parse_pow
    left = self.parse_unary()
  File "/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/jinja2/parser.py", line 547, in parse_unary
    node = self.parse_postfix(node)
  File "/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/jinja2/parser.py", line 672, in parse_postfix
    node = self.parse_subscript(node)
  File "/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/jinja2/parser.py", line 714, in parse_subscript
    self.stream.expect('rbracket')
  File "/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/jinja2/lexer.py", line 388, in expect
    next(self)
  File "/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/jinja2/lexer.py", line 359, in __next__
    self.current = next(self._iter)
  File "/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/jinja2/lexer.py", line 562, in wrap
    for lineno, token, value in stream:
  File "/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/jinja2/lexer.py", line 683, in tokeniter
    filename)
jinja2.exceptions.TemplateSyntaxError: unexpected ']'
  line 8
    lag(a.{{ src_ldts[loop.index0]] }}, 1) o

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/dbt/main.py", line 82, in main
    results, succeeded = handle_and_check(args)
  File "/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/dbt/main.py", line 151, in handle_and_check
    task, res = run_from_args(parsed)
  File "/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/dbt/main.py", line 216, in run_from_args
    results = task.run()
  File "/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/dbt/task/runnable.py", line 272, in run
    self._runtime_initialize()
  File "/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/dbt/task/runnable.py", line 68, in _runtime_initialize
    super(GraphRunnableTask, self)._runtime_initialize()
  File "/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/dbt/task/runnable.py", line 46, in _runtime_initialize
    self.manifest = load_manifest(self.config)
  File "/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/dbt/task/runnable.py", line 33, in load_manifest
    internal_manifest=internal_manifest)
  File "/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/dbt/loader.py", line 170, in load_all
    internal_manifest)
  File "/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/dbt/loader.py", line 163, in _load_from_projects
    loader.load(internal_manifest=internal_manifest)
  File "/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/dbt/loader.py", line 132, in load
    self._load_macros(internal_manifest=internal_manifest)
  File "/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/dbt/loader.py", line 63, in _load_macros
    resource_type=NodeType.Macro,
  File "/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/dbt/parser/macros.py", line 107, in load_and_parse
    resource_type))
  File "/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/dbt/parser/macros.py", line 44, in parse_macro_file
    raise e
  File "/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/dbt/parser/macros.py", line 41, in parse_macro_file
    ast = dbt.clients.jinja.parse(macro_file_contents)
  File "/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/dbt/clients/jinja.py", line 248, in parse
    dbt.exceptions.raise_compiler_error(str(e))
  File "/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/dbt/exceptions.py", line 286, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in None unknown (macros/utility/union.sql)
  unexpected ']'
    line 8
      lag(a.{{ src_ldts[loop.index0]] }}, 1) o

2019-09-05 07:46:45,664 (MainThread): Tracking: tracking
2019-09-05 07:46:45,664 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc558eea940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc558eeae10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc558e82400>]}
2019-09-05 07:46:46,199 (MainThread): Parsing macros/core.sql
2019-09-05 07:46:46,203 (MainThread): Parsing macros/adapters/common.sql
2019-09-05 07:46:46,226 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-09-05 07:46:46,227 (MainThread): Parsing macros/schema_tests/unique.sql
2019-09-05 07:46:46,227 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-09-05 07:46:46,228 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-09-05 07:46:46,229 (MainThread): Parsing macros/materializations/helpers.sql
2019-09-05 07:46:46,233 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-09-05 07:46:46,236 (MainThread): Parsing macros/materializations/view/view.sql
2019-09-05 07:46:46,238 (MainThread): Parsing macros/materializations/table/table.sql
2019-09-05 07:46:46,241 (MainThread): Parsing macros/materializations/common/merge.sql
2019-09-05 07:46:46,245 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2019-09-05 07:46:46,255 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2019-09-05 07:46:46,261 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2019-09-05 07:46:46,262 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-09-05 07:46:46,270 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-09-05 07:46:46,274 (MainThread): Parsing macros/etc/is_incremental.sql
2019-09-05 07:46:46,275 (MainThread): Parsing macros/etc/get_relation_comment.sql
2019-09-05 07:46:46,277 (MainThread): Parsing macros/etc/datetime.sql
2019-09-05 07:46:46,281 (MainThread): Parsing macros/etc/get_custom_alias.sql
2019-09-05 07:46:46,282 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-09-05 07:46:46,283 (MainThread): Parsing macros/etc/query.sql
2019-09-05 07:46:46,284 (MainThread): Parsing macros/adapters.sql
2019-09-05 07:46:46,288 (MainThread): Parsing macros/catalog.sql
2019-09-05 07:46:46,289 (MainThread): Parsing macros/materializations/incremental.sql
2019-09-05 07:46:46,293 (MainThread): Parsing macros/materializations/merge.sql
2019-09-05 07:46:46,294 (MainThread): Parsing macros/materializations/view.sql
2019-09-05 07:46:46,295 (MainThread): Parsing macros/materializations/table.sql
2019-09-05 07:46:46,297 (MainThread): Parsing macros/sat_template.sql
2019-09-05 07:46:46,297 (MainThread): Parsing macros/hub_template.sql
2019-09-05 07:46:46,299 (MainThread): Parsing macros/link_template.sql
2019-09-05 07:46:46,299 (MainThread): Parsing macros/utility/md5_binary.sql
2019-09-05 07:46:46,300 (MainThread): Parsing macros/utility/cast.sql
2019-09-05 07:46:46,301 (MainThread): Parsing macros/utility/union.sql
2019-09-05 07:46:46,303 (MainThread): Parsing macros/utility/prefix.sql
2019-09-05 07:46:46,310 (MainThread): Parsing model.dbtTest.hub_customer
2019-09-05 07:46:46,311 (MainThread): Acquiring new snowflake connection "hub_customer".
2019-09-05 07:46:46,311 (MainThread): Opening a new connection, currently in state init
2019-09-05 07:46:46,543 (MainThread): /home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/snowflake/connector/ocsp_asn1crypto.py:83: ResourceWarning: unclosed file <_io.BufferedReader name='/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/botocore/vendored/requests/cacert.pem'>

2019-09-05 07:46:46,551 (MainThread): /home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/snowflake/connector/ocsp_asn1crypto.py:83: ResourceWarning: unclosed file <_io.BufferedReader name='/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/certifi/cacert.pem'>

2019-09-05 07:46:46,935 (MainThread): Parsing model.dbtTest.stg_orders_hashed
2019-09-05 07:46:46,936 (MainThread): Acquiring new snowflake connection "stg_orders_hashed".
2019-09-05 07:46:46,936 (MainThread): Re-using an available connection from the pool (formerly hub_customer).
2019-09-05 07:46:46,948 (MainThread): Parsing model.snow_vault.test_sat_hub_customer
2019-09-05 07:46:46,948 (MainThread): Acquiring new snowflake connection "test_sat_hub_customer".
2019-09-05 07:46:46,948 (MainThread): Re-using an available connection from the pool (formerly stg_orders_hashed).
2019-09-05 07:46:46,951 (MainThread): Parsing model.snow_vault.test_source
2019-09-05 07:46:46,952 (MainThread): Acquiring new snowflake connection "test_source".
2019-09-05 07:46:46,952 (MainThread): Re-using an available connection from the pool (formerly test_sat_hub_customer).
2019-09-05 07:46:46,956 (MainThread): Parsing model.snow_vault.test_link_customer_nation
2019-09-05 07:46:46,956 (MainThread): Acquiring new snowflake connection "test_link_customer_nation".
2019-09-05 07:46:46,956 (MainThread): Re-using an available connection from the pool (formerly test_source).
2019-09-05 07:46:46,959 (MainThread): Parsing model.snow_vault.test_stg
2019-09-05 07:46:46,959 (MainThread): Acquiring new snowflake connection "test_stg".
2019-09-05 07:46:46,959 (MainThread): Re-using an available connection from the pool (formerly test_link_customer_nation).
2019-09-05 07:46:46,962 (MainThread): Parsing model.snow_vault.test_hub_customer
2019-09-05 07:46:46,962 (MainThread): Acquiring new snowflake connection "test_hub_customer".
2019-09-05 07:46:46,963 (MainThread): Re-using an available connection from the pool (formerly test_stg).
2019-09-05 07:46:46,979 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 123 macros, 0 operations, 0 seed files, 0 sources
2019-09-05 07:46:46,979 (MainThread): 
2019-09-05 07:46:46,979 (MainThread): Acquiring new snowflake connection "master".
2019-09-05 07:46:46,979 (MainThread): Re-using an available connection from the pool (formerly test_hub_customer).
2019-09-05 07:46:46,986 (MainThread): Parsing macros/core.sql
2019-09-05 07:46:46,988 (MainThread): Parsing macros/adapters/common.sql
2019-09-05 07:46:47,005 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-09-05 07:46:47,006 (MainThread): Parsing macros/schema_tests/unique.sql
2019-09-05 07:46:47,007 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-09-05 07:46:47,008 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-09-05 07:46:47,009 (MainThread): Parsing macros/materializations/helpers.sql
2019-09-05 07:46:47,012 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-09-05 07:46:47,015 (MainThread): Parsing macros/materializations/view/view.sql
2019-09-05 07:46:47,018 (MainThread): Parsing macros/materializations/table/table.sql
2019-09-05 07:46:47,021 (MainThread): Parsing macros/materializations/common/merge.sql
2019-09-05 07:46:47,024 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2019-09-05 07:46:47,034 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2019-09-05 07:46:47,040 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2019-09-05 07:46:47,042 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-09-05 07:46:47,050 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-09-05 07:46:47,054 (MainThread): Parsing macros/etc/is_incremental.sql
2019-09-05 07:46:47,055 (MainThread): Parsing macros/etc/get_relation_comment.sql
2019-09-05 07:46:47,056 (MainThread): Parsing macros/etc/datetime.sql
2019-09-05 07:46:47,079 (MainThread): Parsing macros/etc/get_custom_alias.sql
2019-09-05 07:46:47,079 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-09-05 07:46:47,081 (MainThread): Parsing macros/etc/query.sql
2019-09-05 07:46:47,082 (MainThread): Parsing macros/adapters.sql
2019-09-05 07:46:47,086 (MainThread): Parsing macros/catalog.sql
2019-09-05 07:46:47,087 (MainThread): Parsing macros/materializations/incremental.sql
2019-09-05 07:46:47,091 (MainThread): Parsing macros/materializations/merge.sql
2019-09-05 07:46:47,092 (MainThread): Parsing macros/materializations/view.sql
2019-09-05 07:46:47,092 (MainThread): Parsing macros/materializations/table.sql
2019-09-05 07:46:47,142 (MainThread): Using snowflake connection "master".
2019-09-05 07:46:47,142 (MainThread): On master: select distinct schema_name
    from DV_PROTOTYPE_DB.information_schema.schemata
    where catalog_name ilike 'DV_PROTOTYPE_DB'
2019-09-05 07:46:47,825 (MainThread): SQL status: SUCCESS 8 in 0.68 seconds
2019-09-05 07:46:47,831 (MainThread): Creating schema "DV_PROTOTYPE_DB"."SRC_test_vlt".
2019-09-05 07:46:47,832 (MainThread): Using snowflake connection "master".
2019-09-05 07:46:47,832 (MainThread): On master: BEGIN
2019-09-05 07:46:47,953 (MainThread): SQL status: SUCCESS 1 in 0.12 seconds
2019-09-05 07:46:47,954 (MainThread): Using snowflake connection "master".
2019-09-05 07:46:47,954 (MainThread): On master: create schema if not exists DV_PROTOTYPE_DB.SRC_test_vlt
2019-09-05 07:46:48,102 (MainThread): SQL status: SUCCESS 1 in 0.15 seconds
2019-09-05 07:46:48,105 (MainThread): On master: COMMIT
2019-09-05 07:46:48,105 (MainThread): Using snowflake connection "master".
2019-09-05 07:46:48,105 (MainThread): On master: COMMIT
2019-09-05 07:46:48,330 (MainThread): SQL status: SUCCESS 1 in 0.22 seconds
2019-09-05 07:46:48,374 (MainThread): Using snowflake connection "master".
2019-09-05 07:46:48,375 (MainThread): On master: BEGIN
2019-09-05 07:46:48,665 (MainThread): SQL status: SUCCESS 1 in 0.29 seconds
2019-09-05 07:46:48,666 (MainThread): Using snowflake connection "master".
2019-09-05 07:46:48,667 (MainThread): On master: select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'externaltable'
           else table_type
      end as table_type
    from DV_PROTOTYPE_DB.information_schema.tables
    where table_schema ilike 'src_stg'
      and table_catalog ilike 'dv_prototype_db'
2019-09-05 07:46:49,405 (MainThread): SQL status: SUCCESS 6 in 0.74 seconds
2019-09-05 07:46:49,412 (MainThread): Using snowflake connection "master".
2019-09-05 07:46:49,412 (MainThread): On master: select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'externaltable'
           else table_type
      end as table_type
    from DV_PROTOTYPE_DB.information_schema.tables
    where table_schema ilike 'src_vlt'
      and table_catalog ilike 'dv_prototype_db'
2019-09-05 07:46:50,100 (MainThread): SQL status: SUCCESS 29 in 0.69 seconds
2019-09-05 07:46:50,116 (MainThread): Using snowflake connection "master".
2019-09-05 07:46:50,116 (MainThread): On master: select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'externaltable'
           else table_type
      end as table_type
    from DV_PROTOTYPE_DB.information_schema.tables
    where table_schema ilike 'src_test_vlt'
      and table_catalog ilike 'dv_prototype_db'
2019-09-05 07:46:50,769 (MainThread): SQL status: SUCCESS 3 in 0.65 seconds
2019-09-05 07:46:50,773 (MainThread): On master: ROLLBACK
2019-09-05 07:46:50,923 (MainThread): Using snowflake connection "master".
2019-09-05 07:46:50,924 (MainThread): On master: BEGIN
2019-09-05 07:46:51,033 (MainThread): SQL status: SUCCESS 1 in 0.11 seconds
2019-09-05 07:46:51,034 (MainThread): On master: COMMIT
2019-09-05 07:46:51,034 (MainThread): Using snowflake connection "master".
2019-09-05 07:46:51,035 (MainThread): On master: COMMIT
2019-09-05 07:46:51,158 (MainThread): SQL status: SUCCESS 1 in 0.12 seconds
2019-09-05 07:46:51,159 (MainThread): 07:46:51 | Concurrency: 1 threads (target='dev')
2019-09-05 07:46:51,159 (MainThread): 07:46:51 | 
2019-09-05 07:46:51,162 (Thread-1): 07:46:51 | 1 of 3 START table model SRC_STG.stg_orders_hashed................... [RUN]
2019-09-05 07:46:51,164 (Thread-1): Acquiring new snowflake connection "stg_orders_hashed".
2019-09-05 07:46:51,164 (Thread-1): Opening a new connection, currently in state init
2019-09-05 07:46:51,644 (Thread-1): Compiling model.dbtTest.stg_orders_hashed
2019-09-05 07:46:51,685 (Thread-1): Writing injected SQL for node "model.dbtTest.stg_orders_hashed"
2019-09-05 07:46:51,706 (Thread-1): Writing runtime SQL for node "model.dbtTest.stg_orders_hashed"
2019-09-05 07:46:51,709 (Thread-1): Using snowflake connection "stg_orders_hashed".
2019-09-05 07:46:51,709 (Thread-1): On stg_orders_hashed: BEGIN
2019-09-05 07:46:51,807 (Thread-1): SQL status: SUCCESS 1 in 0.10 seconds
2019-09-05 07:46:51,808 (Thread-1): Using snowflake connection "stg_orders_hashed".
2019-09-05 07:46:51,808 (Thread-1): On stg_orders_hashed: create or replace transient table DV_PROTOTYPE_DB.SRC_STG.stg_orders_hashed
  as (
    

select
CAST(MD5_BINARY(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR)))) AS BINARY(16)) AS ORDER_PK,
CAST(MD5_BINARY(UPPER(TRIM(CAST(PARTKEY AS VARCHAR)))) AS BINARY(16)) AS PART_PK,
CAST(MD5_BINARY(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR)))) AS BINARY(16)) AS SUPPLIER_PK,
CAST(MD5_BINARY(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR)))) AS BINARY(16)) AS LINEITEM_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS INVENTORY_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS INVENTORY_ALLOCATION_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(COMMITDATE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(DISCOUNT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(EXTENDEDPRICE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(LINESTATUS AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(LINE_COMMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(QUANTITY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(RECEIPTDATE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(RETURNFLAG AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SHIPDATE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SHIPINSTRUCT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SHIPMODE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(TAX AS VARCHAR))), '^^') )) AS BINARY(16)) AS LINEITEM_HASHDIFF,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS LINEITEM_ORDER_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CLERK AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDERDATE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDERPRIORITY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDERSTATUS AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDER_COMMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SHIPPRIORITY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(TOTALPRICE AS VARCHAR))), '^^') )) AS BINARY(16)) AS ORDER_HASHDIFF,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS ORDER_CUSTOMER_PK,
CAST(MD5_BINARY(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR)))) AS BINARY(16)) AS CUSTOMER_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_NATIONKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS LINK_CUSTOMER_NATION_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMER_ACCBAL AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_COMMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_MKTSEGMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_NAME AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_PHONE AS VARCHAR))), '^^') )) AS BINARY(16)) AS CUSTOMER_HASHDIFF,
CAST(MD5_BINARY(UPPER(TRIM(CAST(CUSTOMER_NATIONKEY AS VARCHAR)))) AS BINARY(16)) AS CUSTOMER_NATION_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMER_NATION_COMMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_NATION_NAME AS VARCHAR))), '^^') )) AS BINARY(16)) AS CUSTOMER_NATION_HASHDIFF,
CAST(MD5_BINARY(UPPER(TRIM(CAST(CUSTOMER_REGIONKEY AS VARCHAR)))) AS BINARY(16)) AS CUSTOMER_REGION_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMER_NATIONKEY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_REGIONKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS CUSTOMER_NATION_REGION_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMER_REGION_COMMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_REGION_NAME AS VARCHAR))), '^^') )) AS BINARY(16)) AS CUSTOMER_REGION_HASHDIFF,
 *, TO_DATE('1992-01-08') AS LOADDATE, TO_DATE('1992-01-08') AS EFFECTIVE_FROM, 'TPCH' AS SOURCE FROM DV_PROTOTYPE_DB.SRC_STG.V_SRC_STG_ORDERS
  );
2019-09-05 07:46:52,907 (Thread-1): SQL status: SUCCESS 1 in 1.10 seconds
2019-09-05 07:46:52,910 (Thread-1): On stg_orders_hashed: COMMIT
2019-09-05 07:46:52,910 (Thread-1): Using snowflake connection "stg_orders_hashed".
2019-09-05 07:46:52,910 (Thread-1): On stg_orders_hashed: COMMIT
2019-09-05 07:46:53,057 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2019-09-05 07:46:53,069 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0708dc91-e9a4-43ec-8625-b37f43c6738f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5794be4e0>]}
2019-09-05 07:46:53,549 (Thread-1): 07:46:53 | 1 of 3 OK created table model SRC_STG.stg_orders_hashed.............. [SUCCESS 1 in 1.90s]
2019-09-05 07:46:53,549 (Thread-1): 07:46:53 | 2 of 3 START incremental model SRC_test_vlt.test_hub_customer........ [RUN]
2019-09-05 07:46:53,551 (Thread-1): Acquiring new snowflake connection "test_hub_customer".
2019-09-05 07:46:53,551 (Thread-1): Re-using an available connection from the pool (formerly stg_orders_hashed).
2019-09-05 07:46:53,551 (Thread-1): Compiling model.snow_vault.test_hub_customer
2019-09-05 07:46:53,554 (Thread-1): Writing injected SQL for node "model.snow_vault.test_hub_customer"
2019-09-05 07:46:53,565 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-05 07:46:53,565 (Thread-1): On test_hub_customer: BEGIN
2019-09-05 07:46:53,662 (Thread-1): SQL status: SUCCESS 1 in 0.10 seconds
2019-09-05 07:46:53,663 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-05 07:46:53,663 (Thread-1): On test_hub_customer: create or replace temporary table DV_PROTOTYPE_DB.SRC_test_vlt.test_hub_customer__dbt_tmp
  as (
    

SELECT
                CAST(CUSTOMER_PK AS BINARY(16)) AS CUSTOMER_PK,
                CAST(CUSTOMERKEY AS NUMBER(38,0)) AS CUSTOMERKEY,
                CAST(SOURCE AS VARCHAR(4)) AS SOURCE,
                CAST(LOADDATE AS DATE) AS LOADDATE

 FROM (
  SELECT DISTINCT CUSTOMER_PK, CUSTOMERKEY, SOURCE, LOADDATE, FIRST_SOURCE
  FROM
    (SELECT DISTINCT a.CUSTOMER_PK, a.CUSTOMERKEY, a.SOURCE, a.LOADDATE,
                     lag(a.SOURCE, 1) over(partition by a.CUSTOMER_PK order by a.CUSTOMER_PK) as FIRST_SOURCE
    FROM DV_PROTOTYPE_DB.SRC_TEST_STG.STG_CUSTOMER AS a
    LEFT JOIN DV_PROTOTYPE_DB.SRC_test_vlt.test_hub_customer AS c
    ON a.CUSTOMER_PK = c.CUSTOMER_PK
    AND c.CUSTOMER_PK IS NULL) AS b)
AS stg
WHERE stg.CUSTOMER_PK NOT IN (SELECT CUSTOMER_PK FROM DV_PROTOTYPE_DB.SRC_test_vlt.test_hub_customer)
AND FIRST_SOURCE IS NULL
  );
2019-09-05 07:46:54,105 (Thread-1): SQL status: SUCCESS 1 in 0.44 seconds
2019-09-05 07:46:54,110 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-05 07:46:54,110 (Thread-1): On test_hub_customer: select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from
      DV_PROTOTYPE_DB.information_schema.columns

      where table_name ilike 'test_hub_customer__dbt_tmp'
        
        and table_schema ilike 'SRC_test_vlt'
        
        
        and table_catalog ilike 'DV_PROTOTYPE_DB'
        
      order by ordinal_position
2019-09-05 07:46:54,990 (Thread-1): SQL status: SUCCESS 4 in 0.88 seconds
2019-09-05 07:46:54,995 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-05 07:46:54,995 (Thread-1): On test_hub_customer: select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from
      DV_PROTOTYPE_DB.information_schema.columns

      where table_name ilike 'test_hub_customer'
        
        and table_schema ilike 'SRC_test_vlt'
        
        
        and table_catalog ilike 'DV_PROTOTYPE_DB'
        
      order by ordinal_position
2019-09-05 07:46:55,671 (Thread-1): SQL status: SUCCESS 4 in 0.68 seconds
2019-09-05 07:46:55,676 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-05 07:46:55,676 (Thread-1): On test_hub_customer: select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from
      DV_PROTOTYPE_DB.information_schema.columns

      where table_name ilike 'test_hub_customer'
        
        and table_schema ilike 'SRC_test_vlt'
        
        
        and table_catalog ilike 'DV_PROTOTYPE_DB'
        
      order by ordinal_position
2019-09-05 07:46:56,425 (Thread-1): SQL status: SUCCESS 4 in 0.75 seconds
2019-09-05 07:46:56,436 (Thread-1): Writing runtime SQL for node "model.snow_vault.test_hub_customer"
2019-09-05 07:46:56,436 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-05 07:46:56,436 (Thread-1): On test_hub_customer: insert into DV_PROTOTYPE_DB.SRC_test_vlt.test_hub_customer (CUSTOMER_PK, CUSTOMERKEY, SOURCE, LOADDATE)
        (
            select CUSTOMER_PK, CUSTOMERKEY, SOURCE, LOADDATE
            from DV_PROTOTYPE_DB.SRC_test_vlt.test_hub_customer__dbt_tmp
        );
2019-09-05 07:46:57,004 (Thread-1): SQL status: SUCCESS 0 in 0.57 seconds
2019-09-05 07:46:57,007 (Thread-1): On test_hub_customer: COMMIT
2019-09-05 07:46:57,007 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-05 07:46:57,008 (Thread-1): On test_hub_customer: COMMIT
2019-09-05 07:46:57,140 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2019-09-05 07:46:57,152 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0708dc91-e9a4-43ec-8625-b37f43c6738f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5794b9dd8>]}
2019-09-05 07:46:57,832 (Thread-1): 07:46:57 | 2 of 3 OK created incremental model SRC_test_vlt.test_hub_customer... [SUCCESS 0 in 3.60s]
2019-09-05 07:46:57,833 (Thread-1): 07:46:57 | 3 of 3 START incremental model SRC_VLT.hub_customer.................. [RUN]
2019-09-05 07:46:57,834 (Thread-1): Acquiring new snowflake connection "hub_customer".
2019-09-05 07:46:57,834 (Thread-1): Re-using an available connection from the pool (formerly test_hub_customer).
2019-09-05 07:46:57,834 (Thread-1): Compiling model.dbtTest.hub_customer
2019-09-05 07:46:57,840 (Thread-1): Writing injected SQL for node "model.dbtTest.hub_customer"
2019-09-05 07:46:57,843 (Thread-1): Using snowflake connection "hub_customer".
2019-09-05 07:46:57,843 (Thread-1): On hub_customer: BEGIN
2019-09-05 07:46:57,947 (Thread-1): SQL status: SUCCESS 1 in 0.10 seconds
2019-09-05 07:46:57,948 (Thread-1): Using snowflake connection "hub_customer".
2019-09-05 07:46:57,948 (Thread-1): On hub_customer: create or replace temporary table DV_PROTOTYPE_DB.SRC_VLT.hub_customer__dbt_tmp
  as (
    SELECT 
                CAST(CUSTOMER_PK AS BINARY(16)) AS CUSTOMER_PK,
                CAST(CUSTOMERKEY AS NUMBER(38,0)) AS CUSTOMERKEY,
                CAST(SOURCE AS VARCHAR(4)) AS SOURCE,
                CAST(LOADDATE AS DATE) AS LOADDATE
 FROM (
  SELECT DISTINCT CUSTOMER_PK, CUSTOMERKEY, SOURCE, LOADDATE, FIRST_SOURCE
  FROM
    (SELECT DISTINCT a.CUSTOMER_PK, a.CUSTOMERKEY, a.SOURCE, a.LOADDATE,
           lag(a.LOADDATE, 1) o
           ver(partition by a.CUSTOMER_PK
           order by a.CUSTOMER_PK) as FIRST_SOURCE
    FROM DV_PROTOTYPE_DB.SRC_STG.stg_orders_hashed AS a
    LEFT JOIN DV_PROTOTYPE_DB.SRC_VLT.hub_customer AS c
    ON a.CUSTOMER_PK = c.CUSTOMER_PK
    AND c.CUSTOMER_PK IS NULL
    )
 AS b)
AS stg
WHERE stg.CUSTOMER_PK NOT IN (SELECT CUSTOMER_PK FROM DV_PROTOTYPE_DB.SRC_VLT.hub_customer)
 AND FIRST_SOURCE IS NULL
  );
2019-09-05 07:46:58,277 (Thread-1): Snowflake error: 001003 (42000): 018ead96-00ec-e692-0000-28a50002f9ba: SQL compilation error:
syntax error line 13 at position 11 unexpected 'ver'.
syntax error line 14 at position 35 unexpected 'as'.
2019-09-05 07:46:58,277 (Thread-1): On hub_customer: ROLLBACK
2019-09-05 07:46:58,504 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0708dc91-e9a4-43ec-8625-b37f43c6738f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc579310f28>]}
2019-09-05 07:46:58,978 (Thread-1): 07:46:58 | 3 of 3 ERROR creating incremental model SRC_VLT.hub_customer......... [ERROR in 0.67s]
2019-09-05 07:46:58,985 (MainThread): Using snowflake connection "master".
2019-09-05 07:46:58,985 (MainThread): On master: BEGIN
2019-09-05 07:46:59,222 (MainThread): SQL status: SUCCESS 1 in 0.24 seconds
2019-09-05 07:46:59,223 (MainThread): On master: COMMIT
2019-09-05 07:46:59,223 (MainThread): Using snowflake connection "master".
2019-09-05 07:46:59,224 (MainThread): On master: COMMIT
2019-09-05 07:46:59,357 (MainThread): SQL status: SUCCESS 1 in 0.13 seconds
2019-09-05 07:46:59,358 (MainThread): 07:46:59 | 
2019-09-05 07:46:59,359 (MainThread): 07:46:59 | Finished running 1 table models, 2 incremental models in 12.38s.
2019-09-05 07:46:59,359 (MainThread): Connection 'master' was left open.
2019-09-05 07:46:59,359 (MainThread): On master: Close
2019-09-05 07:46:59,581 (MainThread): Connection 'hub_customer' was left open.
2019-09-05 07:46:59,582 (MainThread): On hub_customer: Close
2019-09-05 07:46:59,779 (MainThread): 
2019-09-05 07:46:59,780 (MainThread): Completed with 1 errors:
2019-09-05 07:46:59,780 (MainThread): 
2019-09-05 07:46:59,780 (MainThread): Database Error in model hub_customer (models/hub_sat_link_load/hub_customer.sql)
2019-09-05 07:46:59,780 (MainThread):   001003 (42000): 018ead96-00ec-e692-0000-28a50002f9ba: SQL compilation error:
2019-09-05 07:46:59,780 (MainThread):   syntax error line 13 at position 11 unexpected 'ver'.
2019-09-05 07:46:59,781 (MainThread):   syntax error line 14 at position 35 unexpected 'as'.
2019-09-05 07:46:59,781 (MainThread):   compiled SQL at target/compiled/dbtTest/hub_sat_link_load/hub_customer.sql
2019-09-05 07:46:59,781 (MainThread): 
Done. PASS=2 ERROR=1 SKIP=0 TOTAL=3
2019-09-05 07:46:59,782 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc57d64a668>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5829b4eb8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc558eea748>]}
2019-09-05 07:47:00,274 (MainThread): Flushing usage events
2019-09-05 07:47:11,875 (MainThread): Tracking: tracking
2019-09-05 07:47:11,875 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f201f0609b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f201f060e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f201eff7470>]}
2019-09-05 07:47:12,429 (MainThread): Parsing macros/core.sql
2019-09-05 07:47:12,433 (MainThread): Parsing macros/adapters/common.sql
2019-09-05 07:47:12,455 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-09-05 07:47:12,456 (MainThread): Parsing macros/schema_tests/unique.sql
2019-09-05 07:47:12,456 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-09-05 07:47:12,457 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-09-05 07:47:12,458 (MainThread): Parsing macros/materializations/helpers.sql
2019-09-05 07:47:12,462 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-09-05 07:47:12,464 (MainThread): Parsing macros/materializations/view/view.sql
2019-09-05 07:47:12,467 (MainThread): Parsing macros/materializations/table/table.sql
2019-09-05 07:47:12,470 (MainThread): Parsing macros/materializations/common/merge.sql
2019-09-05 07:47:12,474 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2019-09-05 07:47:12,483 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2019-09-05 07:47:12,490 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2019-09-05 07:47:12,491 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-09-05 07:47:12,499 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-09-05 07:47:12,502 (MainThread): Parsing macros/etc/is_incremental.sql
2019-09-05 07:47:12,503 (MainThread): Parsing macros/etc/get_relation_comment.sql
2019-09-05 07:47:12,505 (MainThread): Parsing macros/etc/datetime.sql
2019-09-05 07:47:12,509 (MainThread): Parsing macros/etc/get_custom_alias.sql
2019-09-05 07:47:12,510 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-09-05 07:47:12,511 (MainThread): Parsing macros/etc/query.sql
2019-09-05 07:47:12,512 (MainThread): Parsing macros/adapters.sql
2019-09-05 07:47:12,516 (MainThread): Parsing macros/catalog.sql
2019-09-05 07:47:12,518 (MainThread): Parsing macros/materializations/incremental.sql
2019-09-05 07:47:12,521 (MainThread): Parsing macros/materializations/merge.sql
2019-09-05 07:47:12,522 (MainThread): Parsing macros/materializations/view.sql
2019-09-05 07:47:12,523 (MainThread): Parsing macros/materializations/table.sql
2019-09-05 07:47:12,525 (MainThread): Parsing macros/sat_template.sql
2019-09-05 07:47:12,525 (MainThread): Parsing macros/hub_template.sql
2019-09-05 07:47:12,527 (MainThread): Parsing macros/link_template.sql
2019-09-05 07:47:12,527 (MainThread): Parsing macros/utility/md5_binary.sql
2019-09-05 07:47:12,528 (MainThread): Parsing macros/utility/cast.sql
2019-09-05 07:47:12,529 (MainThread): Parsing macros/utility/union.sql
2019-09-05 07:47:12,531 (MainThread): Parsing macros/utility/prefix.sql
2019-09-05 07:47:12,538 (MainThread): Parsing model.dbtTest.hub_customer
2019-09-05 07:47:12,539 (MainThread): Acquiring new snowflake connection "hub_customer".
2019-09-05 07:47:12,539 (MainThread): Opening a new connection, currently in state init
2019-09-05 07:47:12,742 (MainThread): /home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/snowflake/connector/ocsp_asn1crypto.py:83: ResourceWarning: unclosed file <_io.BufferedReader name='/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/botocore/vendored/requests/cacert.pem'>

2019-09-05 07:47:12,750 (MainThread): /home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/snowflake/connector/ocsp_asn1crypto.py:83: ResourceWarning: unclosed file <_io.BufferedReader name='/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/certifi/cacert.pem'>

2019-09-05 07:47:13,120 (MainThread): Parsing model.dbtTest.stg_orders_hashed
2019-09-05 07:47:13,120 (MainThread): Acquiring new snowflake connection "stg_orders_hashed".
2019-09-05 07:47:13,120 (MainThread): Re-using an available connection from the pool (formerly hub_customer).
2019-09-05 07:47:13,132 (MainThread): Parsing model.snow_vault.test_sat_hub_customer
2019-09-05 07:47:13,132 (MainThread): Acquiring new snowflake connection "test_sat_hub_customer".
2019-09-05 07:47:13,132 (MainThread): Re-using an available connection from the pool (formerly stg_orders_hashed).
2019-09-05 07:47:13,135 (MainThread): Parsing model.snow_vault.test_source
2019-09-05 07:47:13,136 (MainThread): Acquiring new snowflake connection "test_source".
2019-09-05 07:47:13,136 (MainThread): Re-using an available connection from the pool (formerly test_sat_hub_customer).
2019-09-05 07:47:13,140 (MainThread): Parsing model.snow_vault.test_link_customer_nation
2019-09-05 07:47:13,140 (MainThread): Acquiring new snowflake connection "test_link_customer_nation".
2019-09-05 07:47:13,140 (MainThread): Re-using an available connection from the pool (formerly test_source).
2019-09-05 07:47:13,143 (MainThread): Parsing model.snow_vault.test_stg
2019-09-05 07:47:13,143 (MainThread): Acquiring new snowflake connection "test_stg".
2019-09-05 07:47:13,143 (MainThread): Re-using an available connection from the pool (formerly test_link_customer_nation).
2019-09-05 07:47:13,146 (MainThread): Parsing model.snow_vault.test_hub_customer
2019-09-05 07:47:13,146 (MainThread): Acquiring new snowflake connection "test_hub_customer".
2019-09-05 07:47:13,146 (MainThread): Re-using an available connection from the pool (formerly test_stg).
2019-09-05 07:47:13,162 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 123 macros, 0 operations, 0 seed files, 0 sources
2019-09-05 07:47:13,163 (MainThread): 
2019-09-05 07:47:13,163 (MainThread): Acquiring new snowflake connection "master".
2019-09-05 07:47:13,163 (MainThread): Re-using an available connection from the pool (formerly test_hub_customer).
2019-09-05 07:47:13,169 (MainThread): Parsing macros/core.sql
2019-09-05 07:47:13,171 (MainThread): Parsing macros/adapters/common.sql
2019-09-05 07:47:13,188 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-09-05 07:47:13,189 (MainThread): Parsing macros/schema_tests/unique.sql
2019-09-05 07:47:13,190 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-09-05 07:47:13,191 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-09-05 07:47:13,192 (MainThread): Parsing macros/materializations/helpers.sql
2019-09-05 07:47:13,195 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-09-05 07:47:13,198 (MainThread): Parsing macros/materializations/view/view.sql
2019-09-05 07:47:13,201 (MainThread): Parsing macros/materializations/table/table.sql
2019-09-05 07:47:13,204 (MainThread): Parsing macros/materializations/common/merge.sql
2019-09-05 07:47:13,207 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2019-09-05 07:47:13,217 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2019-09-05 07:47:13,223 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2019-09-05 07:47:13,224 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-09-05 07:47:13,232 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-09-05 07:47:13,236 (MainThread): Parsing macros/etc/is_incremental.sql
2019-09-05 07:47:13,237 (MainThread): Parsing macros/etc/get_relation_comment.sql
2019-09-05 07:47:13,238 (MainThread): Parsing macros/etc/datetime.sql
2019-09-05 07:47:13,261 (MainThread): Parsing macros/etc/get_custom_alias.sql
2019-09-05 07:47:13,262 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-09-05 07:47:13,263 (MainThread): Parsing macros/etc/query.sql
2019-09-05 07:47:13,264 (MainThread): Parsing macros/adapters.sql
2019-09-05 07:47:13,268 (MainThread): Parsing macros/catalog.sql
2019-09-05 07:47:13,269 (MainThread): Parsing macros/materializations/incremental.sql
2019-09-05 07:47:13,273 (MainThread): Parsing macros/materializations/merge.sql
2019-09-05 07:47:13,274 (MainThread): Parsing macros/materializations/view.sql
2019-09-05 07:47:13,274 (MainThread): Parsing macros/materializations/table.sql
2019-09-05 07:47:13,323 (MainThread): Using snowflake connection "master".
2019-09-05 07:47:13,323 (MainThread): On master: select distinct schema_name
    from DV_PROTOTYPE_DB.information_schema.schemata
    where catalog_name ilike 'DV_PROTOTYPE_DB'
2019-09-05 07:47:14,038 (MainThread): SQL status: SUCCESS 8 in 0.71 seconds
2019-09-05 07:47:14,044 (MainThread): Creating schema "DV_PROTOTYPE_DB"."SRC_test_vlt".
2019-09-05 07:47:14,045 (MainThread): Using snowflake connection "master".
2019-09-05 07:47:14,045 (MainThread): On master: BEGIN
2019-09-05 07:47:14,144 (MainThread): SQL status: SUCCESS 1 in 0.10 seconds
2019-09-05 07:47:14,145 (MainThread): Using snowflake connection "master".
2019-09-05 07:47:14,145 (MainThread): On master: create schema if not exists DV_PROTOTYPE_DB.SRC_test_vlt
2019-09-05 07:47:14,242 (MainThread): SQL status: SUCCESS 1 in 0.10 seconds
2019-09-05 07:47:14,246 (MainThread): On master: COMMIT
2019-09-05 07:47:14,246 (MainThread): Using snowflake connection "master".
2019-09-05 07:47:14,246 (MainThread): On master: COMMIT
2019-09-05 07:47:14,405 (MainThread): SQL status: SUCCESS 1 in 0.16 seconds
2019-09-05 07:47:14,452 (MainThread): Using snowflake connection "master".
2019-09-05 07:47:14,452 (MainThread): On master: BEGIN
2019-09-05 07:47:14,551 (MainThread): SQL status: SUCCESS 1 in 0.10 seconds
2019-09-05 07:47:14,552 (MainThread): Using snowflake connection "master".
2019-09-05 07:47:14,552 (MainThread): On master: select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'externaltable'
           else table_type
      end as table_type
    from DV_PROTOTYPE_DB.information_schema.tables
    where table_schema ilike 'src_test_vlt'
      and table_catalog ilike 'dv_prototype_db'
2019-09-05 07:47:15,243 (MainThread): SQL status: SUCCESS 3 in 0.69 seconds
2019-09-05 07:47:15,259 (MainThread): Using snowflake connection "master".
2019-09-05 07:47:15,260 (MainThread): On master: select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'externaltable'
           else table_type
      end as table_type
    from DV_PROTOTYPE_DB.information_schema.tables
    where table_schema ilike 'src_vlt'
      and table_catalog ilike 'dv_prototype_db'
2019-09-05 07:47:15,887 (MainThread): SQL status: SUCCESS 29 in 0.63 seconds
2019-09-05 07:47:15,902 (MainThread): Using snowflake connection "master".
2019-09-05 07:47:15,902 (MainThread): On master: select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'externaltable'
           else table_type
      end as table_type
    from DV_PROTOTYPE_DB.information_schema.tables
    where table_schema ilike 'src_stg'
      and table_catalog ilike 'dv_prototype_db'
2019-09-05 07:47:16,677 (MainThread): SQL status: SUCCESS 6 in 0.78 seconds
2019-09-05 07:47:16,699 (MainThread): On master: ROLLBACK
2019-09-05 07:47:16,852 (MainThread): Using snowflake connection "master".
2019-09-05 07:47:16,852 (MainThread): On master: BEGIN
2019-09-05 07:47:16,954 (MainThread): SQL status: SUCCESS 1 in 0.10 seconds
2019-09-05 07:47:16,955 (MainThread): On master: COMMIT
2019-09-05 07:47:16,955 (MainThread): Using snowflake connection "master".
2019-09-05 07:47:16,955 (MainThread): On master: COMMIT
2019-09-05 07:47:17,114 (MainThread): SQL status: SUCCESS 1 in 0.16 seconds
2019-09-05 07:47:17,115 (MainThread): 07:47:17 | Concurrency: 1 threads (target='dev')
2019-09-05 07:47:17,115 (MainThread): 07:47:17 | 
2019-09-05 07:47:17,118 (Thread-1): 07:47:17 | 1 of 3 START table model SRC_STG.stg_orders_hashed................... [RUN]
2019-09-05 07:47:17,119 (Thread-1): Acquiring new snowflake connection "stg_orders_hashed".
2019-09-05 07:47:17,119 (Thread-1): Opening a new connection, currently in state init
2019-09-05 07:47:17,445 (Thread-1): Compiling model.dbtTest.stg_orders_hashed
2019-09-05 07:47:17,484 (Thread-1): Writing injected SQL for node "model.dbtTest.stg_orders_hashed"
2019-09-05 07:47:17,506 (Thread-1): Writing runtime SQL for node "model.dbtTest.stg_orders_hashed"
2019-09-05 07:47:17,508 (Thread-1): Using snowflake connection "stg_orders_hashed".
2019-09-05 07:47:17,508 (Thread-1): On stg_orders_hashed: BEGIN
2019-09-05 07:47:17,659 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2019-09-05 07:47:17,660 (Thread-1): Using snowflake connection "stg_orders_hashed".
2019-09-05 07:47:17,660 (Thread-1): On stg_orders_hashed: create or replace transient table DV_PROTOTYPE_DB.SRC_STG.stg_orders_hashed
  as (
    

select
CAST(MD5_BINARY(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR)))) AS BINARY(16)) AS ORDER_PK,
CAST(MD5_BINARY(UPPER(TRIM(CAST(PARTKEY AS VARCHAR)))) AS BINARY(16)) AS PART_PK,
CAST(MD5_BINARY(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR)))) AS BINARY(16)) AS SUPPLIER_PK,
CAST(MD5_BINARY(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR)))) AS BINARY(16)) AS LINEITEM_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS INVENTORY_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS INVENTORY_ALLOCATION_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(COMMITDATE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(DISCOUNT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(EXTENDEDPRICE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(LINESTATUS AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(LINE_COMMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(QUANTITY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(RECEIPTDATE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(RETURNFLAG AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SHIPDATE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SHIPINSTRUCT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SHIPMODE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(TAX AS VARCHAR))), '^^') )) AS BINARY(16)) AS LINEITEM_HASHDIFF,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS LINEITEM_ORDER_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CLERK AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDERDATE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDERPRIORITY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDERSTATUS AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDER_COMMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SHIPPRIORITY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(TOTALPRICE AS VARCHAR))), '^^') )) AS BINARY(16)) AS ORDER_HASHDIFF,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS ORDER_CUSTOMER_PK,
CAST(MD5_BINARY(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR)))) AS BINARY(16)) AS CUSTOMER_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_NATIONKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS LINK_CUSTOMER_NATION_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMER_ACCBAL AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_COMMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_MKTSEGMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_NAME AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_PHONE AS VARCHAR))), '^^') )) AS BINARY(16)) AS CUSTOMER_HASHDIFF,
CAST(MD5_BINARY(UPPER(TRIM(CAST(CUSTOMER_NATIONKEY AS VARCHAR)))) AS BINARY(16)) AS CUSTOMER_NATION_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMER_NATION_COMMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_NATION_NAME AS VARCHAR))), '^^') )) AS BINARY(16)) AS CUSTOMER_NATION_HASHDIFF,
CAST(MD5_BINARY(UPPER(TRIM(CAST(CUSTOMER_REGIONKEY AS VARCHAR)))) AS BINARY(16)) AS CUSTOMER_REGION_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMER_NATIONKEY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_REGIONKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS CUSTOMER_NATION_REGION_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMER_REGION_COMMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_REGION_NAME AS VARCHAR))), '^^') )) AS BINARY(16)) AS CUSTOMER_REGION_HASHDIFF,
 *, TO_DATE('1992-01-08') AS LOADDATE, TO_DATE('1992-01-08') AS EFFECTIVE_FROM, 'TPCH' AS SOURCE FROM DV_PROTOTYPE_DB.SRC_STG.V_SRC_STG_ORDERS
  );
2019-09-05 07:47:18,574 (Thread-1): SQL status: SUCCESS 1 in 0.91 seconds
2019-09-05 07:47:18,577 (Thread-1): On stg_orders_hashed: COMMIT
2019-09-05 07:47:18,577 (Thread-1): Using snowflake connection "stg_orders_hashed".
2019-09-05 07:47:18,577 (Thread-1): On stg_orders_hashed: COMMIT
2019-09-05 07:47:18,661 (Thread-1): SQL status: SUCCESS 1 in 0.08 seconds
2019-09-05 07:47:18,673 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d7d84c6-2b30-4a60-8362-e84b7339bd6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f203f53be48>]}
2019-09-05 07:47:19,156 (Thread-1): 07:47:19 | 1 of 3 OK created table model SRC_STG.stg_orders_hashed.............. [SUCCESS 1 in 1.55s]
2019-09-05 07:47:19,157 (Thread-1): 07:47:19 | 2 of 3 START incremental model SRC_test_vlt.test_hub_customer........ [RUN]
2019-09-05 07:47:19,157 (Thread-1): Acquiring new snowflake connection "test_hub_customer".
2019-09-05 07:47:19,157 (Thread-1): Re-using an available connection from the pool (formerly stg_orders_hashed).
2019-09-05 07:47:19,158 (Thread-1): Compiling model.snow_vault.test_hub_customer
2019-09-05 07:47:19,174 (Thread-1): Writing injected SQL for node "model.snow_vault.test_hub_customer"
2019-09-05 07:47:19,185 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-05 07:47:19,185 (Thread-1): On test_hub_customer: BEGIN
2019-09-05 07:47:19,341 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2019-09-05 07:47:19,342 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-05 07:47:19,342 (Thread-1): On test_hub_customer: create or replace temporary table DV_PROTOTYPE_DB.SRC_test_vlt.test_hub_customer__dbt_tmp
  as (
    

SELECT
                CAST(CUSTOMER_PK AS BINARY(16)) AS CUSTOMER_PK,
                CAST(CUSTOMERKEY AS NUMBER(38,0)) AS CUSTOMERKEY,
                CAST(SOURCE AS VARCHAR(4)) AS SOURCE,
                CAST(LOADDATE AS DATE) AS LOADDATE

 FROM (
  SELECT DISTINCT CUSTOMER_PK, CUSTOMERKEY, SOURCE, LOADDATE, FIRST_SOURCE
  FROM
    (SELECT DISTINCT a.CUSTOMER_PK, a.CUSTOMERKEY, a.SOURCE, a.LOADDATE,
                     lag(a.SOURCE, 1) over(partition by a.CUSTOMER_PK order by a.CUSTOMER_PK) as FIRST_SOURCE
    FROM DV_PROTOTYPE_DB.SRC_TEST_STG.STG_CUSTOMER AS a
    LEFT JOIN DV_PROTOTYPE_DB.SRC_test_vlt.test_hub_customer AS c
    ON a.CUSTOMER_PK = c.CUSTOMER_PK
    AND c.CUSTOMER_PK IS NULL) AS b)
AS stg
WHERE stg.CUSTOMER_PK NOT IN (SELECT CUSTOMER_PK FROM DV_PROTOTYPE_DB.SRC_test_vlt.test_hub_customer)
AND FIRST_SOURCE IS NULL
  );
2019-09-05 07:47:19,936 (Thread-1): SQL status: SUCCESS 1 in 0.59 seconds
2019-09-05 07:47:19,941 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-05 07:47:19,941 (Thread-1): On test_hub_customer: select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from
      DV_PROTOTYPE_DB.information_schema.columns

      where table_name ilike 'test_hub_customer__dbt_tmp'
        
        and table_schema ilike 'SRC_test_vlt'
        
        
        and table_catalog ilike 'DV_PROTOTYPE_DB'
        
      order by ordinal_position
2019-09-05 07:47:20,744 (Thread-1): SQL status: SUCCESS 4 in 0.80 seconds
2019-09-05 07:47:20,748 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-05 07:47:20,749 (Thread-1): On test_hub_customer: select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from
      DV_PROTOTYPE_DB.information_schema.columns

      where table_name ilike 'test_hub_customer'
        
        and table_schema ilike 'SRC_test_vlt'
        
        
        and table_catalog ilike 'DV_PROTOTYPE_DB'
        
      order by ordinal_position
2019-09-05 07:47:21,542 (Thread-1): SQL status: SUCCESS 4 in 0.79 seconds
2019-09-05 07:47:21,546 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-05 07:47:21,546 (Thread-1): On test_hub_customer: select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from
      DV_PROTOTYPE_DB.information_schema.columns

      where table_name ilike 'test_hub_customer'
        
        and table_schema ilike 'SRC_test_vlt'
        
        
        and table_catalog ilike 'DV_PROTOTYPE_DB'
        
      order by ordinal_position
2019-09-05 07:47:22,251 (Thread-1): SQL status: SUCCESS 4 in 0.70 seconds
2019-09-05 07:47:22,262 (Thread-1): Writing runtime SQL for node "model.snow_vault.test_hub_customer"
2019-09-05 07:47:22,262 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-05 07:47:22,263 (Thread-1): On test_hub_customer: insert into DV_PROTOTYPE_DB.SRC_test_vlt.test_hub_customer (CUSTOMER_PK, CUSTOMERKEY, SOURCE, LOADDATE)
        (
            select CUSTOMER_PK, CUSTOMERKEY, SOURCE, LOADDATE
            from DV_PROTOTYPE_DB.SRC_test_vlt.test_hub_customer__dbt_tmp
        );
2019-09-05 07:47:22,486 (Thread-1): SQL status: SUCCESS 0 in 0.22 seconds
2019-09-05 07:47:22,489 (Thread-1): On test_hub_customer: COMMIT
2019-09-05 07:47:22,490 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-05 07:47:22,490 (Thread-1): On test_hub_customer: COMMIT
2019-09-05 07:47:22,637 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2019-09-05 07:47:22,649 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d7d84c6-2b30-4a60-8362-e84b7339bd6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f203f4e8e80>]}
2019-09-05 07:47:23,215 (Thread-1): 07:47:23 | 2 of 3 OK created incremental model SRC_test_vlt.test_hub_customer... [SUCCESS 0 in 3.49s]
2019-09-05 07:47:23,216 (Thread-1): 07:47:23 | 3 of 3 START incremental model SRC_VLT.hub_customer.................. [RUN]
2019-09-05 07:47:23,216 (Thread-1): Acquiring new snowflake connection "hub_customer".
2019-09-05 07:47:23,217 (Thread-1): Re-using an available connection from the pool (formerly test_hub_customer).
2019-09-05 07:47:23,217 (Thread-1): Compiling model.dbtTest.hub_customer
2019-09-05 07:47:23,222 (Thread-1): Writing injected SQL for node "model.dbtTest.hub_customer"
2019-09-05 07:47:23,226 (Thread-1): Using snowflake connection "hub_customer".
2019-09-05 07:47:23,226 (Thread-1): On hub_customer: BEGIN
2019-09-05 07:47:23,325 (Thread-1): SQL status: SUCCESS 1 in 0.10 seconds
2019-09-05 07:47:23,326 (Thread-1): Using snowflake connection "hub_customer".
2019-09-05 07:47:23,326 (Thread-1): On hub_customer: create or replace temporary table DV_PROTOTYPE_DB.SRC_VLT.hub_customer__dbt_tmp
  as (
    SELECT 
                CAST(CUSTOMER_PK AS BINARY(16)) AS CUSTOMER_PK,
                CAST(CUSTOMERKEY AS NUMBER(38,0)) AS CUSTOMERKEY,
                CAST(SOURCE AS VARCHAR(4)) AS SOURCE,
                CAST(LOADDATE AS DATE) AS LOADDATE
 FROM (
  SELECT DISTINCT CUSTOMER_PK, CUSTOMERKEY, SOURCE, LOADDATE, FIRST_SOURCE
  FROM
    (SELECT DISTINCT a.CUSTOMER_PK, a.CUSTOMERKEY, a.SOURCE, a.LOADDATE,
           lag(a.LOADDATE, 1)
           over(partition by a.CUSTOMER_PK
           order by a.CUSTOMER_PK) as FIRST_SOURCE
    FROM DV_PROTOTYPE_DB.SRC_STG.stg_orders_hashed AS a
    LEFT JOIN DV_PROTOTYPE_DB.SRC_VLT.hub_customer AS c
    ON a.CUSTOMER_PK = c.CUSTOMER_PK
    AND c.CUSTOMER_PK IS NULL
    )
 AS b)
AS stg
WHERE stg.CUSTOMER_PK NOT IN (SELECT CUSTOMER_PK FROM DV_PROTOTYPE_DB.SRC_VLT.hub_customer)
 AND FIRST_SOURCE IS NULL
  );
2019-09-05 07:47:24,012 (Thread-1): SQL status: SUCCESS 1 in 0.69 seconds
2019-09-05 07:47:24,016 (Thread-1): Using snowflake connection "hub_customer".
2019-09-05 07:47:24,016 (Thread-1): On hub_customer: select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from
      DV_PROTOTYPE_DB.information_schema.columns

      where table_name ilike 'hub_customer__dbt_tmp'
        
        and table_schema ilike 'SRC_VLT'
        
        
        and table_catalog ilike 'DV_PROTOTYPE_DB'
        
      order by ordinal_position
2019-09-05 07:47:25,146 (Thread-1): SQL status: SUCCESS 4 in 1.13 seconds
2019-09-05 07:47:25,150 (Thread-1): Using snowflake connection "hub_customer".
2019-09-05 07:47:25,150 (Thread-1): On hub_customer: select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from
      DV_PROTOTYPE_DB.information_schema.columns

      where table_name ilike 'hub_customer'
        
        and table_schema ilike 'SRC_VLT'
        
        
        and table_catalog ilike 'DV_PROTOTYPE_DB'
        
      order by ordinal_position
2019-09-05 07:47:25,918 (Thread-1): SQL status: SUCCESS 4 in 0.77 seconds
2019-09-05 07:47:25,923 (Thread-1): Using snowflake connection "hub_customer".
2019-09-05 07:47:25,923 (Thread-1): On hub_customer: select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from
      DV_PROTOTYPE_DB.information_schema.columns

      where table_name ilike 'hub_customer'
        
        and table_schema ilike 'SRC_VLT'
        
        
        and table_catalog ilike 'DV_PROTOTYPE_DB'
        
      order by ordinal_position
2019-09-05 07:47:26,689 (Thread-1): SQL status: SUCCESS 4 in 0.77 seconds
2019-09-05 07:47:26,692 (Thread-1): Writing runtime SQL for node "model.dbtTest.hub_customer"
2019-09-05 07:47:26,693 (Thread-1): Using snowflake connection "hub_customer".
2019-09-05 07:47:26,693 (Thread-1): On hub_customer: insert into DV_PROTOTYPE_DB.SRC_VLT.hub_customer (CUSTOMER_PK, CUSTOMERKEY, SOURCE, LOADDATE)
        (
            select CUSTOMER_PK, CUSTOMERKEY, SOURCE, LOADDATE
            from DV_PROTOTYPE_DB.SRC_VLT.hub_customer__dbt_tmp
        );
2019-09-05 07:47:26,891 (Thread-1): SQL status: SUCCESS 0 in 0.20 seconds
2019-09-05 07:47:26,894 (Thread-1): On hub_customer: COMMIT
2019-09-05 07:47:26,895 (Thread-1): Using snowflake connection "hub_customer".
2019-09-05 07:47:26,895 (Thread-1): On hub_customer: COMMIT
2019-09-05 07:47:27,024 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2019-09-05 07:47:27,036 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d7d84c6-2b30-4a60-8362-e84b7339bd6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f203f382080>]}
2019-09-05 07:47:27,536 (Thread-1): 07:47:27 | 3 of 3 OK created incremental model SRC_VLT.hub_customer............. [SUCCESS 0 in 3.82s]
2019-09-05 07:47:27,543 (MainThread): Using snowflake connection "master".
2019-09-05 07:47:27,543 (MainThread): On master: BEGIN
2019-09-05 07:47:27,671 (MainThread): SQL status: SUCCESS 1 in 0.13 seconds
2019-09-05 07:47:27,672 (MainThread): On master: COMMIT
2019-09-05 07:47:27,672 (MainThread): Using snowflake connection "master".
2019-09-05 07:47:27,673 (MainThread): On master: COMMIT
2019-09-05 07:47:27,815 (MainThread): SQL status: SUCCESS 1 in 0.14 seconds
2019-09-05 07:47:27,816 (MainThread): 07:47:27 | 
2019-09-05 07:47:27,816 (MainThread): 07:47:27 | Finished running 1 table models, 2 incremental models in 14.65s.
2019-09-05 07:47:27,816 (MainThread): Connection 'master' was left open.
2019-09-05 07:47:27,817 (MainThread): On master: Close
2019-09-05 07:47:27,959 (MainThread): Connection 'hub_customer' was left open.
2019-09-05 07:47:27,960 (MainThread): On hub_customer: Close
2019-09-05 07:47:28,189 (MainThread): 
2019-09-05 07:47:28,189 (MainThread): Completed successfully
2019-09-05 07:47:28,189 (MainThread): 
Done. PASS=3 ERROR=0 SKIP=0 TOTAL=3
2019-09-05 07:47:28,190 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f201e75a438>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f203f4756a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f203f475be0>]}
2019-09-05 07:47:28,674 (MainThread): Flushing usage events
2019-09-05 07:48:10,746 (MainThread): Tracking: tracking
2019-09-05 07:48:10,747 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bbb78e9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bbb78ee80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bbb725438>]}
2019-09-05 07:48:11,477 (MainThread): Parsing macros/core.sql
2019-09-05 07:48:11,479 (MainThread): Parsing macros/adapters/common.sql
2019-09-05 07:48:11,496 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-09-05 07:48:11,497 (MainThread): Parsing macros/schema_tests/unique.sql
2019-09-05 07:48:11,498 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-09-05 07:48:11,499 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-09-05 07:48:11,500 (MainThread): Parsing macros/materializations/helpers.sql
2019-09-05 07:48:11,503 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-09-05 07:48:11,506 (MainThread): Parsing macros/materializations/view/view.sql
2019-09-05 07:48:11,509 (MainThread): Parsing macros/materializations/table/table.sql
2019-09-05 07:48:11,512 (MainThread): Parsing macros/materializations/common/merge.sql
2019-09-05 07:48:11,515 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2019-09-05 07:48:11,525 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2019-09-05 07:48:11,531 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2019-09-05 07:48:11,532 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-09-05 07:48:11,540 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-09-05 07:48:11,544 (MainThread): Parsing macros/etc/is_incremental.sql
2019-09-05 07:48:11,545 (MainThread): Parsing macros/etc/get_relation_comment.sql
2019-09-05 07:48:11,547 (MainThread): Parsing macros/etc/datetime.sql
2019-09-05 07:48:11,551 (MainThread): Parsing macros/etc/get_custom_alias.sql
2019-09-05 07:48:11,552 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-09-05 07:48:11,553 (MainThread): Parsing macros/etc/query.sql
2019-09-05 07:48:11,554 (MainThread): Parsing macros/adapters.sql
2019-09-05 07:48:11,558 (MainThread): Parsing macros/catalog.sql
2019-09-05 07:48:11,559 (MainThread): Parsing macros/materializations/incremental.sql
2019-09-05 07:48:11,563 (MainThread): Parsing macros/materializations/merge.sql
2019-09-05 07:48:11,564 (MainThread): Parsing macros/materializations/view.sql
2019-09-05 07:48:11,564 (MainThread): Parsing macros/materializations/table.sql
2019-09-05 07:48:11,566 (MainThread): Parsing macros/sat_template.sql
2019-09-05 07:48:11,567 (MainThread): Parsing macros/hub_template.sql
2019-09-05 07:48:11,568 (MainThread): Parsing macros/link_template.sql
2019-09-05 07:48:11,569 (MainThread): Parsing macros/utility/md5_binary.sql
2019-09-05 07:48:11,570 (MainThread): Parsing macros/utility/cast.sql
2019-09-05 07:48:11,571 (MainThread): Parsing macros/utility/union.sql
2019-09-05 07:48:11,572 (MainThread): Parsing macros/utility/prefix.sql
2019-09-05 07:48:11,580 (MainThread): Parsing model.dbtTest.hub_customer
2019-09-05 07:48:11,581 (MainThread): Acquiring new snowflake connection "hub_customer".
2019-09-05 07:48:11,581 (MainThread): Opening a new connection, currently in state init
2019-09-05 07:48:11,816 (MainThread): /home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/snowflake/connector/ocsp_asn1crypto.py:83: ResourceWarning: unclosed file <_io.BufferedReader name='/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/botocore/vendored/requests/cacert.pem'>

2019-09-05 07:48:11,824 (MainThread): /home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/snowflake/connector/ocsp_asn1crypto.py:83: ResourceWarning: unclosed file <_io.BufferedReader name='/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/certifi/cacert.pem'>

2019-09-05 07:48:12,265 (MainThread): Parsing model.dbtTest.stg_orders_hashed
2019-09-05 07:48:12,265 (MainThread): Acquiring new snowflake connection "stg_orders_hashed".
2019-09-05 07:48:12,265 (MainThread): Re-using an available connection from the pool (formerly hub_customer).
2019-09-05 07:48:12,277 (MainThread): Parsing model.snow_vault.test_sat_hub_customer
2019-09-05 07:48:12,277 (MainThread): Acquiring new snowflake connection "test_sat_hub_customer".
2019-09-05 07:48:12,277 (MainThread): Re-using an available connection from the pool (formerly stg_orders_hashed).
2019-09-05 07:48:12,280 (MainThread): Parsing model.snow_vault.test_source
2019-09-05 07:48:12,280 (MainThread): Acquiring new snowflake connection "test_source".
2019-09-05 07:48:12,280 (MainThread): Re-using an available connection from the pool (formerly test_sat_hub_customer).
2019-09-05 07:48:12,284 (MainThread): Parsing model.snow_vault.test_link_customer_nation
2019-09-05 07:48:12,285 (MainThread): Acquiring new snowflake connection "test_link_customer_nation".
2019-09-05 07:48:12,285 (MainThread): Re-using an available connection from the pool (formerly test_source).
2019-09-05 07:48:12,288 (MainThread): Parsing model.snow_vault.test_stg
2019-09-05 07:48:12,288 (MainThread): Acquiring new snowflake connection "test_stg".
2019-09-05 07:48:12,288 (MainThread): Re-using an available connection from the pool (formerly test_link_customer_nation).
2019-09-05 07:48:12,291 (MainThread): Parsing model.snow_vault.test_hub_customer
2019-09-05 07:48:12,291 (MainThread): Acquiring new snowflake connection "test_hub_customer".
2019-09-05 07:48:12,291 (MainThread): Re-using an available connection from the pool (formerly test_stg).
2019-09-05 07:48:12,307 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 123 macros, 0 operations, 0 seed files, 0 sources
2019-09-05 07:48:12,308 (MainThread): 
2019-09-05 07:48:12,308 (MainThread): Acquiring new snowflake connection "master".
2019-09-05 07:48:12,308 (MainThread): Re-using an available connection from the pool (formerly test_hub_customer).
2019-09-05 07:48:12,315 (MainThread): Parsing macros/core.sql
2019-09-05 07:48:12,317 (MainThread): Parsing macros/adapters/common.sql
2019-09-05 07:48:12,334 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-09-05 07:48:12,335 (MainThread): Parsing macros/schema_tests/unique.sql
2019-09-05 07:48:12,336 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-09-05 07:48:12,336 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-09-05 07:48:12,337 (MainThread): Parsing macros/materializations/helpers.sql
2019-09-05 07:48:12,341 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-09-05 07:48:12,344 (MainThread): Parsing macros/materializations/view/view.sql
2019-09-05 07:48:12,346 (MainThread): Parsing macros/materializations/table/table.sql
2019-09-05 07:48:12,349 (MainThread): Parsing macros/materializations/common/merge.sql
2019-09-05 07:48:12,353 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2019-09-05 07:48:12,363 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2019-09-05 07:48:12,369 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2019-09-05 07:48:12,370 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-09-05 07:48:12,378 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-09-05 07:48:12,382 (MainThread): Parsing macros/etc/is_incremental.sql
2019-09-05 07:48:12,383 (MainThread): Parsing macros/etc/get_relation_comment.sql
2019-09-05 07:48:12,384 (MainThread): Parsing macros/etc/datetime.sql
2019-09-05 07:48:12,407 (MainThread): Parsing macros/etc/get_custom_alias.sql
2019-09-05 07:48:12,407 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-09-05 07:48:12,409 (MainThread): Parsing macros/etc/query.sql
2019-09-05 07:48:12,410 (MainThread): Parsing macros/adapters.sql
2019-09-05 07:48:12,414 (MainThread): Parsing macros/catalog.sql
2019-09-05 07:48:12,415 (MainThread): Parsing macros/materializations/incremental.sql
2019-09-05 07:48:12,419 (MainThread): Parsing macros/materializations/merge.sql
2019-09-05 07:48:12,420 (MainThread): Parsing macros/materializations/view.sql
2019-09-05 07:48:12,420 (MainThread): Parsing macros/materializations/table.sql
2019-09-05 07:48:12,469 (MainThread): Using snowflake connection "master".
2019-09-05 07:48:12,469 (MainThread): On master: select distinct schema_name
    from DV_PROTOTYPE_DB.information_schema.schemata
    where catalog_name ilike 'DV_PROTOTYPE_DB'
2019-09-05 07:48:13,532 (MainThread): SQL status: SUCCESS 8 in 1.06 seconds
2019-09-05 07:48:13,538 (MainThread): Creating schema "DV_PROTOTYPE_DB"."SRC_test_vlt".
2019-09-05 07:48:13,539 (MainThread): Using snowflake connection "master".
2019-09-05 07:48:13,539 (MainThread): On master: BEGIN
2019-09-05 07:48:13,707 (MainThread): SQL status: SUCCESS 1 in 0.17 seconds
2019-09-05 07:48:13,708 (MainThread): Using snowflake connection "master".
2019-09-05 07:48:13,708 (MainThread): On master: create schema if not exists DV_PROTOTYPE_DB.SRC_test_vlt
2019-09-05 07:48:13,859 (MainThread): SQL status: SUCCESS 1 in 0.15 seconds
2019-09-05 07:48:13,862 (MainThread): On master: COMMIT
2019-09-05 07:48:13,862 (MainThread): Using snowflake connection "master".
2019-09-05 07:48:13,863 (MainThread): On master: COMMIT
2019-09-05 07:48:14,190 (MainThread): SQL status: SUCCESS 1 in 0.33 seconds
2019-09-05 07:48:14,203 (MainThread): Using snowflake connection "master".
2019-09-05 07:48:14,203 (MainThread): On master: BEGIN
2019-09-05 07:48:14,404 (MainThread): SQL status: SUCCESS 1 in 0.20 seconds
2019-09-05 07:48:14,404 (MainThread): Using snowflake connection "master".
2019-09-05 07:48:14,405 (MainThread): On master: select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'externaltable'
           else table_type
      end as table_type
    from DV_PROTOTYPE_DB.information_schema.tables
    where table_schema ilike 'src_test_vlt'
      and table_catalog ilike 'dv_prototype_db'
2019-09-05 07:48:15,356 (MainThread): SQL status: SUCCESS 3 in 0.95 seconds
2019-09-05 07:48:15,361 (MainThread): Using snowflake connection "master".
2019-09-05 07:48:15,361 (MainThread): On master: select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'externaltable'
           else table_type
      end as table_type
    from DV_PROTOTYPE_DB.information_schema.tables
    where table_schema ilike 'src_vlt'
      and table_catalog ilike 'dv_prototype_db'
2019-09-05 07:48:16,506 (MainThread): SQL status: SUCCESS 29 in 1.14 seconds
2019-09-05 07:48:16,521 (MainThread): Using snowflake connection "master".
2019-09-05 07:48:16,521 (MainThread): On master: select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'externaltable'
           else table_type
      end as table_type
    from DV_PROTOTYPE_DB.information_schema.tables
    where table_schema ilike 'src_stg'
      and table_catalog ilike 'dv_prototype_db'
2019-09-05 07:48:17,228 (MainThread): SQL status: SUCCESS 6 in 0.71 seconds
2019-09-05 07:48:17,233 (MainThread): On master: ROLLBACK
2019-09-05 07:48:17,443 (MainThread): Using snowflake connection "master".
2019-09-05 07:48:17,443 (MainThread): On master: BEGIN
2019-09-05 07:48:17,658 (MainThread): SQL status: SUCCESS 1 in 0.21 seconds
2019-09-05 07:48:17,659 (MainThread): On master: COMMIT
2019-09-05 07:48:17,660 (MainThread): Using snowflake connection "master".
2019-09-05 07:48:17,660 (MainThread): On master: COMMIT
2019-09-05 07:48:17,874 (MainThread): SQL status: SUCCESS 1 in 0.21 seconds
2019-09-05 07:48:17,875 (MainThread): 07:48:17 | Concurrency: 1 threads (target='dev')
2019-09-05 07:48:17,875 (MainThread): 07:48:17 | 
2019-09-05 07:48:17,878 (Thread-1): 07:48:17 | 1 of 3 START table model SRC_STG.stg_orders_hashed................... [RUN]
2019-09-05 07:48:17,879 (Thread-1): Acquiring new snowflake connection "stg_orders_hashed".
2019-09-05 07:48:17,880 (Thread-1): Opening a new connection, currently in state init
2019-09-05 07:48:18,472 (Thread-1): Compiling model.dbtTest.stg_orders_hashed
2019-09-05 07:48:18,481 (Thread-1): Writing injected SQL for node "model.dbtTest.stg_orders_hashed"
2019-09-05 07:48:18,493 (Thread-1): Writing runtime SQL for node "model.dbtTest.stg_orders_hashed"
2019-09-05 07:48:18,495 (Thread-1): Using snowflake connection "stg_orders_hashed".
2019-09-05 07:48:18,495 (Thread-1): On stg_orders_hashed: BEGIN
2019-09-05 07:48:18,620 (Thread-1): SQL status: SUCCESS 1 in 0.12 seconds
2019-09-05 07:48:18,621 (Thread-1): Using snowflake connection "stg_orders_hashed".
2019-09-05 07:48:18,621 (Thread-1): On stg_orders_hashed: create or replace transient table DV_PROTOTYPE_DB.SRC_STG.stg_orders_hashed
  as (
    

select
CAST(MD5_BINARY(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR)))) AS BINARY(16)) AS ORDER_PK,
CAST(MD5_BINARY(UPPER(TRIM(CAST(PARTKEY AS VARCHAR)))) AS BINARY(16)) AS PART_PK,
CAST(MD5_BINARY(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR)))) AS BINARY(16)) AS SUPPLIER_PK,
CAST(MD5_BINARY(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR)))) AS BINARY(16)) AS LINEITEM_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS INVENTORY_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS INVENTORY_ALLOCATION_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(COMMITDATE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(DISCOUNT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(EXTENDEDPRICE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(LINESTATUS AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(LINE_COMMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(QUANTITY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(RECEIPTDATE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(RETURNFLAG AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SHIPDATE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SHIPINSTRUCT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SHIPMODE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(TAX AS VARCHAR))), '^^') )) AS BINARY(16)) AS LINEITEM_HASHDIFF,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS LINEITEM_ORDER_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CLERK AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDERDATE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDERPRIORITY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDERSTATUS AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDER_COMMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SHIPPRIORITY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(TOTALPRICE AS VARCHAR))), '^^') )) AS BINARY(16)) AS ORDER_HASHDIFF,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS ORDER_CUSTOMER_PK,
CAST(MD5_BINARY(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR)))) AS BINARY(16)) AS CUSTOMER_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_NATIONKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS LINK_CUSTOMER_NATION_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMER_ACCBAL AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_COMMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_MKTSEGMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_NAME AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_PHONE AS VARCHAR))), '^^') )) AS BINARY(16)) AS CUSTOMER_HASHDIFF,
CAST(MD5_BINARY(UPPER(TRIM(CAST(CUSTOMER_NATIONKEY AS VARCHAR)))) AS BINARY(16)) AS CUSTOMER_NATION_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMER_NATION_COMMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_NATION_NAME AS VARCHAR))), '^^') )) AS BINARY(16)) AS CUSTOMER_NATION_HASHDIFF,
CAST(MD5_BINARY(UPPER(TRIM(CAST(CUSTOMER_REGIONKEY AS VARCHAR)))) AS BINARY(16)) AS CUSTOMER_REGION_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMER_NATIONKEY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_REGIONKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS CUSTOMER_NATION_REGION_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMER_REGION_COMMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_REGION_NAME AS VARCHAR))), '^^') )) AS BINARY(16)) AS CUSTOMER_REGION_HASHDIFF,
 *, TO_DATE('1992-01-08') AS LOADDATE, TO_DATE('1992-01-08') AS EFFECTIVE_FROM, 'TPCH' AS SOURCE FROM DV_PROTOTYPE_DB.SRC_STG.V_SRC_STG_ORDERS
  );
2019-09-05 07:48:19,694 (Thread-1): SQL status: SUCCESS 1 in 1.07 seconds
2019-09-05 07:48:19,696 (Thread-1): On stg_orders_hashed: COMMIT
2019-09-05 07:48:19,697 (Thread-1): Using snowflake connection "stg_orders_hashed".
2019-09-05 07:48:19,697 (Thread-1): On stg_orders_hashed: COMMIT
2019-09-05 07:48:19,786 (Thread-1): SQL status: SUCCESS 1 in 0.09 seconds
2019-09-05 07:48:19,798 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8cdf077-ac3e-4f00-84cd-aa740713ecab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bdbd63ac8>]}
2019-09-05 07:48:20,296 (Thread-1): 07:48:20 | 1 of 3 OK created table model SRC_STG.stg_orders_hashed.............. [SUCCESS 1 in 1.92s]
2019-09-05 07:48:20,297 (Thread-1): 07:48:20 | 2 of 3 START incremental model SRC_test_vlt.test_hub_customer........ [RUN]
2019-09-05 07:48:20,301 (Thread-1): Acquiring new snowflake connection "test_hub_customer".
2019-09-05 07:48:20,301 (Thread-1): Re-using an available connection from the pool (formerly stg_orders_hashed).
2019-09-05 07:48:20,302 (Thread-1): Compiling model.snow_vault.test_hub_customer
2019-09-05 07:48:20,318 (Thread-1): Writing injected SQL for node "model.snow_vault.test_hub_customer"
2019-09-05 07:48:20,352 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-05 07:48:20,352 (Thread-1): On test_hub_customer: BEGIN
2019-09-05 07:48:20,524 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2019-09-05 07:48:20,524 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-05 07:48:20,525 (Thread-1): On test_hub_customer: create or replace temporary table DV_PROTOTYPE_DB.SRC_test_vlt.test_hub_customer__dbt_tmp
  as (
    

SELECT
                CAST(CUSTOMER_PK AS BINARY(16)) AS CUSTOMER_PK,
                CAST(CUSTOMERKEY AS NUMBER(38,0)) AS CUSTOMERKEY,
                CAST(SOURCE AS VARCHAR(4)) AS SOURCE,
                CAST(LOADDATE AS DATE) AS LOADDATE

 FROM (
  SELECT DISTINCT CUSTOMER_PK, CUSTOMERKEY, SOURCE, LOADDATE, FIRST_SOURCE
  FROM
    (SELECT DISTINCT a.CUSTOMER_PK, a.CUSTOMERKEY, a.SOURCE, a.LOADDATE,
                     lag(a.SOURCE, 1) over(partition by a.CUSTOMER_PK order by a.CUSTOMER_PK) as FIRST_SOURCE
    FROM DV_PROTOTYPE_DB.SRC_TEST_STG.STG_CUSTOMER AS a
    LEFT JOIN DV_PROTOTYPE_DB.SRC_test_vlt.test_hub_customer AS c
    ON a.CUSTOMER_PK = c.CUSTOMER_PK
    AND c.CUSTOMER_PK IS NULL) AS b)
AS stg
WHERE stg.CUSTOMER_PK NOT IN (SELECT CUSTOMER_PK FROM DV_PROTOTYPE_DB.SRC_test_vlt.test_hub_customer)
AND FIRST_SOURCE IS NULL
  );
2019-09-05 07:48:21,158 (Thread-1): SQL status: SUCCESS 1 in 0.63 seconds
2019-09-05 07:48:21,163 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-05 07:48:21,163 (Thread-1): On test_hub_customer: select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from
      DV_PROTOTYPE_DB.information_schema.columns

      where table_name ilike 'test_hub_customer__dbt_tmp'
        
        and table_schema ilike 'SRC_test_vlt'
        
        
        and table_catalog ilike 'DV_PROTOTYPE_DB'
        
      order by ordinal_position
2019-09-05 07:48:21,916 (Thread-1): SQL status: SUCCESS 4 in 0.75 seconds
2019-09-05 07:48:21,920 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-05 07:48:21,920 (Thread-1): On test_hub_customer: select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from
      DV_PROTOTYPE_DB.information_schema.columns

      where table_name ilike 'test_hub_customer'
        
        and table_schema ilike 'SRC_test_vlt'
        
        
        and table_catalog ilike 'DV_PROTOTYPE_DB'
        
      order by ordinal_position
2019-09-05 07:48:22,617 (Thread-1): SQL status: SUCCESS 4 in 0.70 seconds
2019-09-05 07:48:22,621 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-05 07:48:22,621 (Thread-1): On test_hub_customer: select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from
      DV_PROTOTYPE_DB.information_schema.columns

      where table_name ilike 'test_hub_customer'
        
        and table_schema ilike 'SRC_test_vlt'
        
        
        and table_catalog ilike 'DV_PROTOTYPE_DB'
        
      order by ordinal_position
2019-09-05 07:48:23,351 (Thread-1): SQL status: SUCCESS 4 in 0.73 seconds
2019-09-05 07:48:23,362 (Thread-1): Writing runtime SQL for node "model.snow_vault.test_hub_customer"
2019-09-05 07:48:23,362 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-05 07:48:23,362 (Thread-1): On test_hub_customer: insert into DV_PROTOTYPE_DB.SRC_test_vlt.test_hub_customer (CUSTOMER_PK, CUSTOMERKEY, SOURCE, LOADDATE)
        (
            select CUSTOMER_PK, CUSTOMERKEY, SOURCE, LOADDATE
            from DV_PROTOTYPE_DB.SRC_test_vlt.test_hub_customer__dbt_tmp
        );
2019-09-05 07:48:23,605 (Thread-1): SQL status: SUCCESS 0 in 0.24 seconds
2019-09-05 07:48:23,609 (Thread-1): On test_hub_customer: COMMIT
2019-09-05 07:48:23,609 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-05 07:48:23,609 (Thread-1): On test_hub_customer: COMMIT
2019-09-05 07:48:23,810 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2019-09-05 07:48:23,817 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8cdf077-ac3e-4f00-84cd-aa740713ecab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bdbd6bcc0>]}
2019-09-05 07:48:24,342 (Thread-1): 07:48:24 | 2 of 3 OK created incremental model SRC_test_vlt.test_hub_customer... [SUCCESS 0 in 3.52s]
2019-09-05 07:48:24,342 (Thread-1): 07:48:24 | 3 of 3 START incremental model SRC_VLT.hub_customer.................. [RUN]
2019-09-05 07:48:24,342 (Thread-1): Acquiring new snowflake connection "hub_customer".
2019-09-05 07:48:24,343 (Thread-1): Re-using an available connection from the pool (formerly test_hub_customer).
2019-09-05 07:48:24,344 (Thread-1): Compiling model.dbtTest.hub_customer
2019-09-05 07:48:24,379 (Thread-1): Writing injected SQL for node "model.dbtTest.hub_customer"
2019-09-05 07:48:24,389 (Thread-1): Using snowflake connection "hub_customer".
2019-09-05 07:48:24,389 (Thread-1): On hub_customer: BEGIN
2019-09-05 07:48:24,531 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2019-09-05 07:48:24,532 (Thread-1): Using snowflake connection "hub_customer".
2019-09-05 07:48:24,532 (Thread-1): On hub_customer: create or replace temporary table DV_PROTOTYPE_DB.SRC_VLT.hub_customer__dbt_tmp
  as (
    SELECT 
                CAST(CUSTOMER_PK AS BINARY(16)) AS CUSTOMER_PK,
                CAST(CUSTOMERKEY AS NUMBER(38,0)) AS CUSTOMERKEY,
                CAST(SOURCE AS VARCHAR(4)) AS SOURCE,
                CAST(LOADDATE AS DATE) AS LOADDATE
 FROM (
  SELECT DISTINCT CUSTOMER_PK, CUSTOMERKEY, SOURCE, LOADDATE, FIRST_SOURCE
  FROM
    (SELECT DISTINCT a.CUSTOMER_PK, a.CUSTOMERKEY, a.SOURCE, a.LOADDATE,
           lag(a.LOADDATE, 1)
           over(partition by a.CUSTOMER_PK
           order by a.CUSTOMER_PK) as FIRST_SOURCE
    FROM DV_PROTOTYPE_DB.SRC_STG.stg_orders_hashed AS a
    LEFT JOIN DV_PROTOTYPE_DB.SRC_VLT.hub_customer AS c
    ON a.CUSTOMER_PK = c.CUSTOMER_PK
    AND c.CUSTOMER_PK IS NULL
    )
 AS b)
AS stg
WHERE stg.CUSTOMER_PK NOT IN (SELECT CUSTOMER_PK FROM DV_PROTOTYPE_DB.SRC_VLT.hub_customer)
AND FIRST_SOURCE IS NULL
  );
2019-09-05 07:48:25,085 (Thread-1): SQL status: SUCCESS 1 in 0.55 seconds
2019-09-05 07:48:25,090 (Thread-1): Using snowflake connection "hub_customer".
2019-09-05 07:48:25,090 (Thread-1): On hub_customer: select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from
      DV_PROTOTYPE_DB.information_schema.columns

      where table_name ilike 'hub_customer__dbt_tmp'
        
        and table_schema ilike 'SRC_VLT'
        
        
        and table_catalog ilike 'DV_PROTOTYPE_DB'
        
      order by ordinal_position
2019-09-05 07:48:25,791 (Thread-1): SQL status: SUCCESS 4 in 0.70 seconds
2019-09-05 07:48:25,796 (Thread-1): Using snowflake connection "hub_customer".
2019-09-05 07:48:25,796 (Thread-1): On hub_customer: select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from
      DV_PROTOTYPE_DB.information_schema.columns

      where table_name ilike 'hub_customer'
        
        and table_schema ilike 'SRC_VLT'
        
        
        and table_catalog ilike 'DV_PROTOTYPE_DB'
        
      order by ordinal_position
2019-09-05 07:48:26,507 (Thread-1): SQL status: SUCCESS 4 in 0.71 seconds
2019-09-05 07:48:26,511 (Thread-1): Using snowflake connection "hub_customer".
2019-09-05 07:48:26,512 (Thread-1): On hub_customer: select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from
      DV_PROTOTYPE_DB.information_schema.columns

      where table_name ilike 'hub_customer'
        
        and table_schema ilike 'SRC_VLT'
        
        
        and table_catalog ilike 'DV_PROTOTYPE_DB'
        
      order by ordinal_position
2019-09-05 07:48:27,373 (Thread-1): SQL status: SUCCESS 4 in 0.86 seconds
2019-09-05 07:48:27,377 (Thread-1): Writing runtime SQL for node "model.dbtTest.hub_customer"
2019-09-05 07:48:27,377 (Thread-1): Using snowflake connection "hub_customer".
2019-09-05 07:48:27,377 (Thread-1): On hub_customer: insert into DV_PROTOTYPE_DB.SRC_VLT.hub_customer (CUSTOMER_PK, CUSTOMERKEY, SOURCE, LOADDATE)
        (
            select CUSTOMER_PK, CUSTOMERKEY, SOURCE, LOADDATE
            from DV_PROTOTYPE_DB.SRC_VLT.hub_customer__dbt_tmp
        );
2019-09-05 07:48:27,598 (Thread-1): SQL status: SUCCESS 0 in 0.22 seconds
2019-09-05 07:48:27,601 (Thread-1): On hub_customer: COMMIT
2019-09-05 07:48:27,601 (Thread-1): Using snowflake connection "hub_customer".
2019-09-05 07:48:27,601 (Thread-1): On hub_customer: COMMIT
2019-09-05 07:48:27,741 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2019-09-05 07:48:27,753 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8cdf077-ac3e-4f00-84cd-aa740713ecab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bdbba3278>]}
2019-09-05 07:48:28,254 (Thread-1): 07:48:28 | 3 of 3 OK created incremental model SRC_VLT.hub_customer............. [SUCCESS 0 in 3.41s]
2019-09-05 07:48:28,304 (MainThread): Using snowflake connection "master".
2019-09-05 07:48:28,305 (MainThread): On master: BEGIN
2019-09-05 07:48:28,419 (MainThread): SQL status: SUCCESS 1 in 0.11 seconds
2019-09-05 07:48:28,420 (MainThread): On master: COMMIT
2019-09-05 07:48:28,421 (MainThread): Using snowflake connection "master".
2019-09-05 07:48:28,421 (MainThread): On master: COMMIT
2019-09-05 07:48:28,573 (MainThread): SQL status: SUCCESS 1 in 0.15 seconds
2019-09-05 07:48:28,574 (MainThread): 07:48:28 | 
2019-09-05 07:48:28,575 (MainThread): 07:48:28 | Finished running 1 table models, 2 incremental models in 16.27s.
2019-09-05 07:48:28,575 (MainThread): Connection 'master' was left open.
2019-09-05 07:48:28,576 (MainThread): On master: Close
2019-09-05 07:48:28,717 (MainThread): Connection 'hub_customer' was left open.
2019-09-05 07:48:28,718 (MainThread): On hub_customer: Close
2019-09-05 07:48:29,184 (MainThread): 
2019-09-05 07:48:29,184 (MainThread): Completed successfully
2019-09-05 07:48:29,184 (MainThread): 
Done. PASS=3 ERROR=0 SKIP=0 TOTAL=3
2019-09-05 07:48:29,185 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bdbaaecc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bdbd25978>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bdbd257b8>]}
2019-09-05 07:48:29,702 (MainThread): Flushing usage events
2019-09-05 07:49:25,604 (MainThread): Tracking: tracking
2019-09-05 07:49:25,604 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda23331908>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda23331dd8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda232c93c8>]}
2019-09-05 07:49:26,141 (MainThread): Parsing macros/core.sql
2019-09-05 07:49:26,144 (MainThread): Parsing macros/adapters/common.sql
2019-09-05 07:49:26,162 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-09-05 07:49:26,162 (MainThread): Parsing macros/schema_tests/unique.sql
2019-09-05 07:49:26,163 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-09-05 07:49:26,164 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-09-05 07:49:26,165 (MainThread): Parsing macros/materializations/helpers.sql
2019-09-05 07:49:26,169 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-09-05 07:49:26,171 (MainThread): Parsing macros/materializations/view/view.sql
2019-09-05 07:49:26,174 (MainThread): Parsing macros/materializations/table/table.sql
2019-09-05 07:49:26,177 (MainThread): Parsing macros/materializations/common/merge.sql
2019-09-05 07:49:26,181 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2019-09-05 07:49:26,191 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2019-09-05 07:49:26,197 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2019-09-05 07:49:26,198 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-09-05 07:49:26,206 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-09-05 07:49:26,210 (MainThread): Parsing macros/etc/is_incremental.sql
2019-09-05 07:49:26,211 (MainThread): Parsing macros/etc/get_relation_comment.sql
2019-09-05 07:49:26,213 (MainThread): Parsing macros/etc/datetime.sql
2019-09-05 07:49:26,217 (MainThread): Parsing macros/etc/get_custom_alias.sql
2019-09-05 07:49:26,218 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-09-05 07:49:26,219 (MainThread): Parsing macros/etc/query.sql
2019-09-05 07:49:26,220 (MainThread): Parsing macros/adapters.sql
2019-09-05 07:49:26,224 (MainThread): Parsing macros/catalog.sql
2019-09-05 07:49:26,226 (MainThread): Parsing macros/materializations/incremental.sql
2019-09-05 07:49:26,229 (MainThread): Parsing macros/materializations/merge.sql
2019-09-05 07:49:26,230 (MainThread): Parsing macros/materializations/view.sql
2019-09-05 07:49:26,231 (MainThread): Parsing macros/materializations/table.sql
2019-09-05 07:49:26,233 (MainThread): Parsing macros/sat_template.sql
2019-09-05 07:49:26,234 (MainThread): Parsing macros/hub_template.sql
2019-09-05 07:49:26,235 (MainThread): Parsing macros/link_template.sql
2019-09-05 07:49:26,235 (MainThread): Parsing macros/utility/md5_binary.sql
2019-09-05 07:49:26,236 (MainThread): Parsing macros/utility/cast.sql
2019-09-05 07:49:26,238 (MainThread): Parsing macros/utility/union.sql
2019-09-05 07:49:26,239 (MainThread): Parsing macros/utility/prefix.sql
2019-09-05 07:49:26,247 (MainThread): Parsing model.dbtTest.hub_customer
2019-09-05 07:49:26,247 (MainThread): Acquiring new snowflake connection "hub_customer".
2019-09-05 07:49:26,247 (MainThread): Opening a new connection, currently in state init
2019-09-05 07:49:26,493 (MainThread): /home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/snowflake/connector/ocsp_asn1crypto.py:83: ResourceWarning: unclosed file <_io.BufferedReader name='/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/botocore/vendored/requests/cacert.pem'>

2019-09-05 07:49:26,501 (MainThread): /home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/snowflake/connector/ocsp_asn1crypto.py:83: ResourceWarning: unclosed file <_io.BufferedReader name='/home/alex/venvs/SnowflakeDemo/lib/python3.6/site-packages/certifi/cacert.pem'>

2019-09-05 07:49:26,921 (MainThread): Parsing model.dbtTest.stg_orders_hashed
2019-09-05 07:49:26,921 (MainThread): Acquiring new snowflake connection "stg_orders_hashed".
2019-09-05 07:49:26,921 (MainThread): Re-using an available connection from the pool (formerly hub_customer).
2019-09-05 07:49:26,933 (MainThread): Parsing model.snow_vault.test_sat_hub_customer
2019-09-05 07:49:26,934 (MainThread): Acquiring new snowflake connection "test_sat_hub_customer".
2019-09-05 07:49:26,934 (MainThread): Re-using an available connection from the pool (formerly stg_orders_hashed).
2019-09-05 07:49:26,937 (MainThread): Parsing model.snow_vault.test_source
2019-09-05 07:49:26,937 (MainThread): Acquiring new snowflake connection "test_source".
2019-09-05 07:49:26,937 (MainThread): Re-using an available connection from the pool (formerly test_sat_hub_customer).
2019-09-05 07:49:26,941 (MainThread): Parsing model.snow_vault.test_link_customer_nation
2019-09-05 07:49:26,941 (MainThread): Acquiring new snowflake connection "test_link_customer_nation".
2019-09-05 07:49:26,941 (MainThread): Re-using an available connection from the pool (formerly test_source).
2019-09-05 07:49:26,944 (MainThread): Parsing model.snow_vault.test_stg
2019-09-05 07:49:26,945 (MainThread): Acquiring new snowflake connection "test_stg".
2019-09-05 07:49:26,945 (MainThread): Re-using an available connection from the pool (formerly test_link_customer_nation).
2019-09-05 07:49:26,947 (MainThread): Parsing model.snow_vault.test_hub_customer
2019-09-05 07:49:26,948 (MainThread): Acquiring new snowflake connection "test_hub_customer".
2019-09-05 07:49:26,948 (MainThread): Re-using an available connection from the pool (formerly test_stg).
2019-09-05 07:49:26,964 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 123 macros, 0 operations, 0 seed files, 0 sources
2019-09-05 07:49:26,965 (MainThread): 
2019-09-05 07:49:26,965 (MainThread): Acquiring new snowflake connection "master".
2019-09-05 07:49:26,965 (MainThread): Re-using an available connection from the pool (formerly test_hub_customer).
2019-09-05 07:49:26,972 (MainThread): Parsing macros/core.sql
2019-09-05 07:49:26,974 (MainThread): Parsing macros/adapters/common.sql
2019-09-05 07:49:26,992 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-09-05 07:49:26,992 (MainThread): Parsing macros/schema_tests/unique.sql
2019-09-05 07:49:26,993 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-09-05 07:49:26,994 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-09-05 07:49:26,995 (MainThread): Parsing macros/materializations/helpers.sql
2019-09-05 07:49:26,999 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-09-05 07:49:27,001 (MainThread): Parsing macros/materializations/view/view.sql
2019-09-05 07:49:27,004 (MainThread): Parsing macros/materializations/table/table.sql
2019-09-05 07:49:27,007 (MainThread): Parsing macros/materializations/common/merge.sql
2019-09-05 07:49:27,011 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2019-09-05 07:49:27,021 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2019-09-05 07:49:27,027 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2019-09-05 07:49:27,028 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-09-05 07:49:27,037 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-09-05 07:49:27,041 (MainThread): Parsing macros/etc/is_incremental.sql
2019-09-05 07:49:27,042 (MainThread): Parsing macros/etc/get_relation_comment.sql
2019-09-05 07:49:27,043 (MainThread): Parsing macros/etc/datetime.sql
2019-09-05 07:49:27,066 (MainThread): Parsing macros/etc/get_custom_alias.sql
2019-09-05 07:49:27,066 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-09-05 07:49:27,068 (MainThread): Parsing macros/etc/query.sql
2019-09-05 07:49:27,068 (MainThread): Parsing macros/adapters.sql
2019-09-05 07:49:27,073 (MainThread): Parsing macros/catalog.sql
2019-09-05 07:49:27,074 (MainThread): Parsing macros/materializations/incremental.sql
2019-09-05 07:49:27,078 (MainThread): Parsing macros/materializations/merge.sql
2019-09-05 07:49:27,079 (MainThread): Parsing macros/materializations/view.sql
2019-09-05 07:49:27,079 (MainThread): Parsing macros/materializations/table.sql
2019-09-05 07:49:27,129 (MainThread): Using snowflake connection "master".
2019-09-05 07:49:27,129 (MainThread): On master: select distinct schema_name
    from DV_PROTOTYPE_DB.information_schema.schemata
    where catalog_name ilike 'DV_PROTOTYPE_DB'
2019-09-05 07:49:27,769 (MainThread): SQL status: SUCCESS 8 in 0.64 seconds
2019-09-05 07:49:27,775 (MainThread): Creating schema "DV_PROTOTYPE_DB"."SRC_test_vlt".
2019-09-05 07:49:27,776 (MainThread): Using snowflake connection "master".
2019-09-05 07:49:27,776 (MainThread): On master: BEGIN
2019-09-05 07:49:27,904 (MainThread): SQL status: SUCCESS 1 in 0.13 seconds
2019-09-05 07:49:27,905 (MainThread): Using snowflake connection "master".
2019-09-05 07:49:27,906 (MainThread): On master: create schema if not exists DV_PROTOTYPE_DB.SRC_test_vlt
2019-09-05 07:49:28,031 (MainThread): SQL status: SUCCESS 1 in 0.13 seconds
2019-09-05 07:49:28,034 (MainThread): On master: COMMIT
2019-09-05 07:49:28,035 (MainThread): Using snowflake connection "master".
2019-09-05 07:49:28,035 (MainThread): On master: COMMIT
2019-09-05 07:49:28,175 (MainThread): SQL status: SUCCESS 1 in 0.14 seconds
2019-09-05 07:49:28,202 (MainThread): Using snowflake connection "master".
2019-09-05 07:49:28,202 (MainThread): On master: BEGIN
2019-09-05 07:49:28,327 (MainThread): SQL status: SUCCESS 1 in 0.12 seconds
2019-09-05 07:49:28,328 (MainThread): Using snowflake connection "master".
2019-09-05 07:49:28,328 (MainThread): On master: select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'externaltable'
           else table_type
      end as table_type
    from DV_PROTOTYPE_DB.information_schema.tables
    where table_schema ilike 'src_stg'
      and table_catalog ilike 'dv_prototype_db'
2019-09-05 07:49:30,780 (MainThread): SQL status: SUCCESS 6 in 2.45 seconds
2019-09-05 07:49:30,787 (MainThread): Using snowflake connection "master".
2019-09-05 07:49:30,787 (MainThread): On master: select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'externaltable'
           else table_type
      end as table_type
    from DV_PROTOTYPE_DB.information_schema.tables
    where table_schema ilike 'src_vlt'
      and table_catalog ilike 'dv_prototype_db'
2019-09-05 07:49:31,518 (MainThread): SQL status: SUCCESS 29 in 0.73 seconds
2019-09-05 07:49:31,533 (MainThread): Using snowflake connection "master".
2019-09-05 07:49:31,533 (MainThread): On master: select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'externaltable'
           else table_type
      end as table_type
    from DV_PROTOTYPE_DB.information_schema.tables
    where table_schema ilike 'src_test_vlt'
      and table_catalog ilike 'dv_prototype_db'
2019-09-05 07:49:33,697 (MainThread): SQL status: SUCCESS 3 in 2.16 seconds
2019-09-05 07:49:33,701 (MainThread): On master: ROLLBACK
2019-09-05 07:49:33,839 (MainThread): Using snowflake connection "master".
2019-09-05 07:49:33,839 (MainThread): On master: BEGIN
2019-09-05 07:49:33,966 (MainThread): SQL status: SUCCESS 1 in 0.13 seconds
2019-09-05 07:49:33,967 (MainThread): On master: COMMIT
2019-09-05 07:49:33,967 (MainThread): Using snowflake connection "master".
2019-09-05 07:49:33,967 (MainThread): On master: COMMIT
2019-09-05 07:49:34,622 (MainThread): SQL status: SUCCESS 1 in 0.65 seconds
2019-09-05 07:49:34,623 (MainThread): 07:49:34 | Concurrency: 1 threads (target='dev')
2019-09-05 07:49:34,623 (MainThread): 07:49:34 | 
2019-09-05 07:49:34,626 (Thread-1): 07:49:34 | 1 of 3 START table model SRC_STG.stg_orders_hashed................... [RUN]
2019-09-05 07:49:34,627 (Thread-1): Acquiring new snowflake connection "stg_orders_hashed".
2019-09-05 07:49:34,628 (Thread-1): Opening a new connection, currently in state init
2019-09-05 07:49:35,477 (Thread-1): Compiling model.dbtTest.stg_orders_hashed
2019-09-05 07:49:35,486 (Thread-1): Writing injected SQL for node "model.dbtTest.stg_orders_hashed"
2019-09-05 07:49:35,498 (Thread-1): Writing runtime SQL for node "model.dbtTest.stg_orders_hashed"
2019-09-05 07:49:35,500 (Thread-1): Using snowflake connection "stg_orders_hashed".
2019-09-05 07:49:35,500 (Thread-1): On stg_orders_hashed: BEGIN
2019-09-05 07:49:35,607 (Thread-1): SQL status: SUCCESS 1 in 0.11 seconds
2019-09-05 07:49:35,608 (Thread-1): Using snowflake connection "stg_orders_hashed".
2019-09-05 07:49:35,609 (Thread-1): On stg_orders_hashed: create or replace transient table DV_PROTOTYPE_DB.SRC_STG.stg_orders_hashed
  as (
    

select
CAST(MD5_BINARY(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR)))) AS BINARY(16)) AS ORDER_PK,
CAST(MD5_BINARY(UPPER(TRIM(CAST(PARTKEY AS VARCHAR)))) AS BINARY(16)) AS PART_PK,
CAST(MD5_BINARY(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR)))) AS BINARY(16)) AS SUPPLIER_PK,
CAST(MD5_BINARY(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR)))) AS BINARY(16)) AS LINEITEM_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS INVENTORY_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS INVENTORY_ALLOCATION_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(COMMITDATE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(DISCOUNT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(EXTENDEDPRICE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(LINESTATUS AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(LINE_COMMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(QUANTITY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(RECEIPTDATE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(RETURNFLAG AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SHIPDATE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SHIPINSTRUCT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SHIPMODE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(TAX AS VARCHAR))), '^^') )) AS BINARY(16)) AS LINEITEM_HASHDIFF,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS LINEITEM_ORDER_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CLERK AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDERDATE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDERPRIORITY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDERSTATUS AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDER_COMMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SHIPPRIORITY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(TOTALPRICE AS VARCHAR))), '^^') )) AS BINARY(16)) AS ORDER_HASHDIFF,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS ORDER_CUSTOMER_PK,
CAST(MD5_BINARY(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR)))) AS BINARY(16)) AS CUSTOMER_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_NATIONKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS LINK_CUSTOMER_NATION_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMER_ACCBAL AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_COMMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_MKTSEGMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_NAME AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_PHONE AS VARCHAR))), '^^') )) AS BINARY(16)) AS CUSTOMER_HASHDIFF,
CAST(MD5_BINARY(UPPER(TRIM(CAST(CUSTOMER_NATIONKEY AS VARCHAR)))) AS BINARY(16)) AS CUSTOMER_NATION_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMER_NATION_COMMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_NATION_NAME AS VARCHAR))), '^^') )) AS BINARY(16)) AS CUSTOMER_NATION_HASHDIFF,
CAST(MD5_BINARY(UPPER(TRIM(CAST(CUSTOMER_REGIONKEY AS VARCHAR)))) AS BINARY(16)) AS CUSTOMER_REGION_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMER_NATIONKEY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_REGIONKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS CUSTOMER_NATION_REGION_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMER_REGION_COMMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_REGION_NAME AS VARCHAR))), '^^') )) AS BINARY(16)) AS CUSTOMER_REGION_HASHDIFF,
 *, TO_DATE('1992-01-08') AS LOADDATE, TO_DATE('1992-01-08') AS EFFECTIVE_FROM, 'TPCH' AS SOURCE FROM DV_PROTOTYPE_DB.SRC_STG.V_SRC_STG_ORDERS
  );
2019-09-05 07:49:38,019 (Thread-1): SQL status: SUCCESS 1 in 2.41 seconds
2019-09-05 07:49:38,022 (Thread-1): On stg_orders_hashed: COMMIT
2019-09-05 07:49:38,023 (Thread-1): Using snowflake connection "stg_orders_hashed".
2019-09-05 07:49:38,023 (Thread-1): On stg_orders_hashed: COMMIT
2019-09-05 07:49:38,115 (Thread-1): SQL status: SUCCESS 1 in 0.09 seconds
2019-09-05 07:49:38,127 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a21cd622-6d09-4806-9dec-8927b34911f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda438fff60>]}
2019-09-05 07:49:38,616 (Thread-1): 07:49:38 | 1 of 3 OK created table model SRC_STG.stg_orders_hashed.............. [SUCCESS 1 in 3.50s]
2019-09-05 07:49:38,616 (Thread-1): 07:49:38 | 2 of 3 START incremental model SRC_test_vlt.test_hub_customer........ [RUN]
2019-09-05 07:49:38,616 (Thread-1): Acquiring new snowflake connection "test_hub_customer".
2019-09-05 07:49:38,617 (Thread-1): Re-using an available connection from the pool (formerly stg_orders_hashed).
2019-09-05 07:49:38,618 (Thread-1): Compiling model.snow_vault.test_hub_customer
2019-09-05 07:49:38,633 (Thread-1): Writing injected SQL for node "model.snow_vault.test_hub_customer"
2019-09-05 07:49:38,644 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-05 07:49:38,645 (Thread-1): On test_hub_customer: BEGIN
2019-09-05 07:49:38,773 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2019-09-05 07:49:38,774 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-05 07:49:38,774 (Thread-1): On test_hub_customer: create or replace temporary table DV_PROTOTYPE_DB.SRC_test_vlt.test_hub_customer__dbt_tmp
  as (
    

SELECT
                CAST(CUSTOMER_PK AS BINARY(16)) AS CUSTOMER_PK,
                CAST(CUSTOMERKEY AS NUMBER(38,0)) AS CUSTOMERKEY,
                CAST(SOURCE AS VARCHAR(4)) AS SOURCE,
                CAST(LOADDATE AS DATE) AS LOADDATE

 FROM (
  SELECT DISTINCT CUSTOMER_PK, CUSTOMERKEY, SOURCE, LOADDATE, FIRST_SOURCE
  FROM
    (SELECT DISTINCT a.CUSTOMER_PK, a.CUSTOMERKEY, a.SOURCE, a.LOADDATE,
                     lag(a.SOURCE, 1) over(partition by a.CUSTOMER_PK order by a.CUSTOMER_PK) as FIRST_SOURCE
    FROM DV_PROTOTYPE_DB.SRC_TEST_STG.STG_CUSTOMER AS a
    LEFT JOIN DV_PROTOTYPE_DB.SRC_test_vlt.test_hub_customer AS c
    ON a.CUSTOMER_PK = c.CUSTOMER_PK
    AND c.CUSTOMER_PK IS NULL) AS b)
AS stg
WHERE stg.CUSTOMER_PK NOT IN (SELECT CUSTOMER_PK FROM DV_PROTOTYPE_DB.SRC_test_vlt.test_hub_customer)
AND FIRST_SOURCE IS NULL
  );
2019-09-05 07:49:39,306 (Thread-1): SQL status: SUCCESS 1 in 0.53 seconds
2019-09-05 07:49:39,311 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-05 07:49:39,312 (Thread-1): On test_hub_customer: select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from
      DV_PROTOTYPE_DB.information_schema.columns

      where table_name ilike 'test_hub_customer__dbt_tmp'
        
        and table_schema ilike 'SRC_test_vlt'
        
        
        and table_catalog ilike 'DV_PROTOTYPE_DB'
        
      order by ordinal_position
2019-09-05 07:49:40,015 (Thread-1): SQL status: SUCCESS 4 in 0.70 seconds
2019-09-05 07:49:40,027 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-05 07:49:40,028 (Thread-1): On test_hub_customer: select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from
      DV_PROTOTYPE_DB.information_schema.columns

      where table_name ilike 'test_hub_customer'
        
        and table_schema ilike 'SRC_test_vlt'
        
        
        and table_catalog ilike 'DV_PROTOTYPE_DB'
        
      order by ordinal_position
2019-09-05 07:49:40,789 (Thread-1): SQL status: SUCCESS 4 in 0.76 seconds
2019-09-05 07:49:40,793 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-05 07:49:40,793 (Thread-1): On test_hub_customer: select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from
      DV_PROTOTYPE_DB.information_schema.columns

      where table_name ilike 'test_hub_customer'
        
        and table_schema ilike 'SRC_test_vlt'
        
        
        and table_catalog ilike 'DV_PROTOTYPE_DB'
        
      order by ordinal_position
2019-09-05 07:49:41,549 (Thread-1): SQL status: SUCCESS 4 in 0.76 seconds
2019-09-05 07:49:41,560 (Thread-1): Writing runtime SQL for node "model.snow_vault.test_hub_customer"
2019-09-05 07:49:41,560 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-05 07:49:41,560 (Thread-1): On test_hub_customer: insert into DV_PROTOTYPE_DB.SRC_test_vlt.test_hub_customer (CUSTOMER_PK, CUSTOMERKEY, SOURCE, LOADDATE)
        (
            select CUSTOMER_PK, CUSTOMERKEY, SOURCE, LOADDATE
            from DV_PROTOTYPE_DB.SRC_test_vlt.test_hub_customer__dbt_tmp
        );
2019-09-05 07:49:41,748 (Thread-1): SQL status: SUCCESS 0 in 0.19 seconds
2019-09-05 07:49:41,751 (Thread-1): On test_hub_customer: COMMIT
2019-09-05 07:49:41,751 (Thread-1): Using snowflake connection "test_hub_customer".
2019-09-05 07:49:41,752 (Thread-1): On test_hub_customer: COMMIT
2019-09-05 07:49:41,887 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2019-09-05 07:49:41,899 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a21cd622-6d09-4806-9dec-8927b34911f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda43740978>]}
2019-09-05 07:49:42,397 (Thread-1): 07:49:42 | 2 of 3 OK created incremental model SRC_test_vlt.test_hub_customer... [SUCCESS 0 in 3.28s]
2019-09-05 07:49:42,397 (Thread-1): 07:49:42 | 3 of 3 START incremental model SRC_VLT.hub_customer.................. [RUN]
2019-09-05 07:49:42,398 (Thread-1): Acquiring new snowflake connection "hub_customer".
2019-09-05 07:49:42,398 (Thread-1): Re-using an available connection from the pool (formerly test_hub_customer).
2019-09-05 07:49:42,399 (Thread-1): Compiling model.dbtTest.hub_customer
2019-09-05 07:49:42,433 (Thread-1): Writing injected SQL for node "model.dbtTest.hub_customer"
2019-09-05 07:49:42,442 (Thread-1): Using snowflake connection "hub_customer".
2019-09-05 07:49:42,442 (Thread-1): On hub_customer: BEGIN
2019-09-05 07:49:42,618 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2019-09-05 07:49:42,619 (Thread-1): Using snowflake connection "hub_customer".
2019-09-05 07:49:42,619 (Thread-1): On hub_customer: create or replace temporary table DV_PROTOTYPE_DB.SRC_VLT.hub_customer__dbt_tmp
  as (
    SELECT 
                CAST(CUSTOMER_PK AS BINARY(16)) AS CUSTOMER_PK,
                CAST(CUSTOMERKEY AS NUMBER(38,0)) AS CUSTOMERKEY,
                CAST(SOURCE AS VARCHAR(4)) AS SOURCE,
                CAST(LOADDATE AS DATE) AS LOADDATE
 FROM (
  SELECT DISTINCT CUSTOMER_PK, CUSTOMERKEY, SOURCE, LOADDATE, FIRST_SOURCE
  FROM
    (SELECT DISTINCT a.CUSTOMER_PK, a.CUSTOMERKEY, a.SOURCE, a.LOADDATE,
           lag(a.SOURCE, 1)
           over(partition by a.CUSTOMER_PK
           order by a.CUSTOMER_PK) as FIRST_SOURCE
    FROM DV_PROTOTYPE_DB.SRC_STG.stg_orders_hashed AS a
    LEFT JOIN DV_PROTOTYPE_DB.SRC_VLT.hub_customer AS c
    ON a.CUSTOMER_PK = c.CUSTOMER_PK
    AND c.CUSTOMER_PK IS NULL
    )
 AS b)
AS stg
WHERE stg.CUSTOMER_PK NOT IN (SELECT CUSTOMER_PK FROM DV_PROTOTYPE_DB.SRC_VLT.hub_customer)
AND FIRST_SOURCE IS NULL
  );
2019-09-05 07:49:43,182 (Thread-1): SQL status: SUCCESS 1 in 0.56 seconds
2019-09-05 07:49:43,187 (Thread-1): Using snowflake connection "hub_customer".
2019-09-05 07:49:43,187 (Thread-1): On hub_customer: select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from
      DV_PROTOTYPE_DB.information_schema.columns

      where table_name ilike 'hub_customer__dbt_tmp'
        
        and table_schema ilike 'SRC_VLT'
        
        
        and table_catalog ilike 'DV_PROTOTYPE_DB'
        
      order by ordinal_position
2019-09-05 07:49:43,955 (Thread-1): SQL status: SUCCESS 4 in 0.77 seconds
2019-09-05 07:49:43,960 (Thread-1): Using snowflake connection "hub_customer".
2019-09-05 07:49:43,960 (Thread-1): On hub_customer: select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from
      DV_PROTOTYPE_DB.information_schema.columns

      where table_name ilike 'hub_customer'
        
        and table_schema ilike 'SRC_VLT'
        
        
        and table_catalog ilike 'DV_PROTOTYPE_DB'
        
      order by ordinal_position
2019-09-05 07:49:44,693 (Thread-1): SQL status: SUCCESS 4 in 0.73 seconds
2019-09-05 07:49:44,706 (Thread-1): Using snowflake connection "hub_customer".
2019-09-05 07:49:44,706 (Thread-1): On hub_customer: select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from
      DV_PROTOTYPE_DB.information_schema.columns

      where table_name ilike 'hub_customer'
        
        and table_schema ilike 'SRC_VLT'
        
        
        and table_catalog ilike 'DV_PROTOTYPE_DB'
        
      order by ordinal_position
2019-09-05 07:49:45,460 (Thread-1): SQL status: SUCCESS 4 in 0.75 seconds
2019-09-05 07:49:45,463 (Thread-1): Writing runtime SQL for node "model.dbtTest.hub_customer"
2019-09-05 07:49:45,463 (Thread-1): Using snowflake connection "hub_customer".
2019-09-05 07:49:45,463 (Thread-1): On hub_customer: insert into DV_PROTOTYPE_DB.SRC_VLT.hub_customer (CUSTOMER_PK, CUSTOMERKEY, SOURCE, LOADDATE)
        (
            select CUSTOMER_PK, CUSTOMERKEY, SOURCE, LOADDATE
            from DV_PROTOTYPE_DB.SRC_VLT.hub_customer__dbt_tmp
        );
2019-09-05 07:49:45,698 (Thread-1): SQL status: SUCCESS 0 in 0.23 seconds
2019-09-05 07:49:45,701 (Thread-1): On hub_customer: COMMIT
2019-09-05 07:49:45,701 (Thread-1): Using snowflake connection "hub_customer".
2019-09-05 07:49:45,702 (Thread-1): On hub_customer: COMMIT
2019-09-05 07:49:45,839 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2019-09-05 07:49:45,852 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a21cd622-6d09-4806-9dec-8927b34911f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda4369dd68>]}
2019-09-05 07:49:46,346 (Thread-1): 07:49:46 | 3 of 3 OK created incremental model SRC_VLT.hub_customer............. [SUCCESS 0 in 3.45s]
2019-09-05 07:49:46,359 (MainThread): Using snowflake connection "master".
2019-09-05 07:49:46,359 (MainThread): On master: BEGIN
2019-09-05 07:49:46,465 (MainThread): SQL status: SUCCESS 1 in 0.11 seconds
2019-09-05 07:49:46,466 (MainThread): On master: COMMIT
2019-09-05 07:49:46,466 (MainThread): Using snowflake connection "master".
2019-09-05 07:49:46,467 (MainThread): On master: COMMIT
2019-09-05 07:49:46,605 (MainThread): SQL status: SUCCESS 1 in 0.14 seconds
2019-09-05 07:49:46,606 (MainThread): 07:49:46 | 
2019-09-05 07:49:46,607 (MainThread): 07:49:46 | Finished running 1 table models, 2 incremental models in 19.64s.
2019-09-05 07:49:46,607 (MainThread): Connection 'master' was left open.
2019-09-05 07:49:46,608 (MainThread): On master: Close
2019-09-05 07:49:46,737 (MainThread): Connection 'hub_customer' was left open.
2019-09-05 07:49:46,737 (MainThread): On hub_customer: Close
2019-09-05 07:49:46,896 (MainThread): 
2019-09-05 07:49:46,896 (MainThread): Completed successfully
2019-09-05 07:49:46,897 (MainThread): 
Done. PASS=3 ERROR=0 SKIP=0 TOTAL=3
2019-09-05 07:49:46,897 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda47a92668>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda437c2cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda437c2048>]}
2019-09-05 07:49:47,400 (MainThread): Flushing usage events
