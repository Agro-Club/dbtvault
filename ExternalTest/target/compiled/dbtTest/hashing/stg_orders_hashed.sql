

select
CAST(MD5_BINARY(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR)))) AS BINARY(16)) AS ORDER_PK,
CAST(MD5_BINARY(UPPER(TRIM(CAST(PARTKEY AS VARCHAR)))) AS BINARY(16)) AS PART_PK,
CAST(MD5_BINARY(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR)))) AS BINARY(16)) AS SUPPLIER_PK,
CAST(MD5_BINARY(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR)))) AS BINARY(16)) AS LINEITEM_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS INVENTORY_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS INVENTORY_ALLOCATION_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(COMMITDATE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(DISCOUNT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(EXTENDEDPRICE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(LINESTATUS AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(LINE_COMMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(QUANTITY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(RECEIPTDATE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(RETURNFLAG AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SHIPDATE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SHIPINSTRUCT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SHIPMODE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(TAX AS VARCHAR))), '^^') )) AS BINARY(16)) AS LINEITEM_HASHDIFF,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS LINEITEM_ORDER_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CLERK AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDERDATE AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDERPRIORITY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDERSTATUS AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDER_COMMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(SHIPPRIORITY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(TOTALPRICE AS VARCHAR))), '^^') )) AS BINARY(16)) AS ORDER_HASHDIFF,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS ORDER_CUSTOMER_PK,
CAST(MD5_BINARY(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR)))) AS BINARY(16)) AS CUSTOMER_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_NATIONKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS LINK_CUSTOMER_NATION_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMER_ACCBAL AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_COMMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_MKTSEGMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_NAME AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_PHONE AS VARCHAR))), '^^') )) AS BINARY(16)) AS CUSTOMER_HASHDIFF,
CAST(MD5_BINARY(UPPER(TRIM(CAST(CUSTOMER_NATIONKEY AS VARCHAR)))) AS BINARY(16)) AS CUSTOMER_NATION_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMER_NATION_COMMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_NATION_NAME AS VARCHAR))), '^^') )) AS BINARY(16)) AS CUSTOMER_NATION_HASHDIFF,
CAST(MD5_BINARY(UPPER(TRIM(CAST(CUSTOMER_REGIONKEY AS VARCHAR)))) AS BINARY(16)) AS CUSTOMER_REGION_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMER_NATIONKEY AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_REGIONKEY AS VARCHAR))), '^^') )) AS BINARY(16)) AS CUSTOMER_NATION_REGION_PK,
CAST(MD5_BINARY(CONCAT(IFNULL(UPPER(TRIM(CAST(CUSTOMER_REGION_COMMENT AS VARCHAR))), '^^'), '||',IFNULL(UPPER(TRIM(CAST(CUSTOMER_REGION_NAME AS VARCHAR))), '^^') )) AS BINARY(16)) AS CUSTOMER_REGION_HASHDIFF,
 *, TO_DATE('1992-01-08') AS LOADDATE, TO_DATE('1992-01-08') AS EFFECTIVE_FROM, 'TPCH' AS SOURCE FROM DV_PROTOTYPE_DB.SRC_STG.V_SRC_STG_ORDERS